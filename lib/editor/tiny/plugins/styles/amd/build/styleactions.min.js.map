{"version":3,"file":"styleactions.min.js","sources":["../src/styleactions.js"],"sourcesContent":["// This file is part of Moodle - https://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <https://www.gnu.org/licenses/>.\n\n/**\n * Apply or remove styles from selected text in the TinyMCE editor.\n *\n * @module     tiny_styles/styleactions\n * @copyright  2025 Oshrat Luski <oshrat.luski@weizmann.ac.il>\n * @license    https://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n/**\n * Applies or toggles a list of classes on a div wrapping the selected text.\n *\n * @param {TinyMCE.Editor} editor - The TinyMCE editor instance\n * @param {string[]} classList - Array of CSS classes to apply\n */\nexport const applyStyle = (editor, classList) => {\n    const selection = editor.selection;\n\n    if (!selection || selection.isCollapsed()) {\n        return;\n    }\n\n    // Normalize classList: handle both array and string\n    const classes = Array.isArray(classList) ? classList : classList.split(' ');\n    const styleName = 'customstyle_' + classes.join('_');\n\n    // Register the style formatter if not already registered\n    editor.formatter.register(styleName, {\n        block: 'div',\n        classes: classes,\n        remove_similar: true,\n    });\n\n    // Check if the style is already applied\n    const selectedNode = selection.getNode();\n    const existingDiv = editor.dom.getParent(selectedNode, (node) =>\n        node.nodeName === 'DIV' &&\n        node.classList &&\n        classes.every(cls => node.classList.contains(cls))\n    );\n\n    if (existingDiv) {\n        // Remove the style\n        editor.formatter.remove(styleName);\n    } else {\n        // Apply the style\n        editor.formatter.apply(styleName);\n    }\n};\n\n"],"names":["editor","classList","selection","isCollapsed","classes","Array","isArray","split","styleName","join","formatter","register","block","remove_similar","selectedNode","getNode","dom","getParent","node","nodeName","every","cls","contains","remove","apply"],"mappings":"yKA6B0B,CAACA,OAAQC,mBACzBC,UAAYF,OAAOE,cAEpBA,WAAaA,UAAUC,2BAKtBC,QAAUC,MAAMC,QAAQL,WAAaA,UAAYA,UAAUM,MAAM,KACjEC,UAAY,eAAiBJ,QAAQK,KAAK,KAGhDT,OAAOU,UAAUC,SAASH,UAAW,CACjCI,MAAO,MACPR,QAASA,QACTS,gBAAgB,UAIdC,aAAeZ,UAAUa,UACXf,OAAOgB,IAAIC,UAAUH,cAAeI,MAClC,QAAlBA,KAAKC,UACLD,KAAKjB,WACLG,QAAQgB,OAAMC,KAAOH,KAAKjB,UAAUqB,SAASD,SAK7CrB,OAAOU,UAAUa,OAAOf,WAGxBR,OAAOU,UAAUc,MAAMhB"}