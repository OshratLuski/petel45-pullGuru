define("tiny_accessibilityfontcolor/coloraccessibility",["exports","./colorstorage","editor_tiny/options","./common"],(function(_exports,_colorstorage,_options,_common){Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.addRemoveColorIfMissing=void 0,_exports.getAccessibleBackgroundColors=function(textColor){let filteredColors=(0,_colorstorage.getOriginalBackgroundColors)().filter((color=>isAccessible(textColor,color.value,"AA")));return addRemoveColorIfMissing(filteredColors)},_exports.getAccessibleTextColors=function(backgroundColor){let filteredColors="#FFFFFF"===backgroundColor?(0,_colorstorage.getOriginalTextColors)():(0,_colorstorage.getOriginalTextColors)().filter((color=>isAccessible(backgroundColor,color.value,"AA")));return addRemoveColorIfMissing(filteredColors)},_exports.resetFilteredColors=void 0,_exports.rgbToHex=rgbToHex;const forecolorMap=(0,_options.getPluginOptionName)(_common.pluginName,"textcolors"),backcolorMap=(0,_options.getPluginOptionName)(_common.pluginName,"backgroundcolors");function rgbToHex(rgb){if("string"!=typeof rgb)return"#000000";let result=rgb.match(/\d+/g);return!result||result.length<3?"#000000":4===result.length&&"0"===result[3]?"#FFFFFF":"#"+result.slice(0,3).map((x=>("0"+parseInt(x).toString(16)).slice(-2))).join("")}function getLuminance(hex){let{r:r,g:g,b:b}=function(hex){var _hex$;if(Array.isArray(hex)&&(hex=(null===(_hex$=hex[0])||void 0===_hex$?void 0:_hex$.value)||"#000000"),"object"==typeof hex&&null!==hex&&(hex=hex.value||"#000000"),"string"!=typeof hex)return{r:0,g:0,b:0};3===(hex=hex.replace(/^#/,"")).length&&(hex=hex.split("").map((c=>c+c)).join(""));let num=parseInt(hex,16);return{r:num>>16&255,g:num>>8&255,b:255&num}}(hex),[RsRGB,GsRGB,BsRGB]=[r,g,b].map((v=>v/255)),[R,G,B]=[RsRGB,GsRGB,BsRGB].map((v=>v<=.03928?v/12.92:Math.pow((v+.055)/1.055,2.4)));return.2126*R+.7152*G+.0722*B}function getContrastRatio(color1,color2){let lum1=getLuminance(color1),lum2=getLuminance(color2),[L1,L2]=lum1>lum2?[lum1,lum2]:[lum2,lum1];return(L1+.05)/(L2+.05)}function isAccessible(textColor,bgColor){let level=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"AA",contrast=getContrastRatio(textColor,bgColor),requiredContrast="AAA"===level?7:4.5;return contrast>=requiredContrast}const addRemoveColorIfMissing=colors=>(colors.some((color=>"remove"===color.value||"Remove color"===color.text))||(colors=colors.filter((color=>"remove"!==color.value))).push({text:"Remove Color",icon:"color-swatch-remove-color",value:"remove",type:"choiceitem"}),colors);_exports.addRemoveColorIfMissing=addRemoveColorIfMissing;const resetFilteredColors=(editor,format)=>{if("forecolor"===format){const originalBackgroundColors=(0,_colorstorage.getOriginalBackgroundColors)();editor.options.register(backcolorMap,{processor:()=>({value:originalBackgroundColors,valid:!0}),default:[]});const selectedBgColor=rgbToHex(window.getComputedStyle(editor.selection.getNode()).backgroundColor);selectedBgColor&&"#FFFFFF"!==selectedBgColor||resetFilteredColors(editor,"backcolor")}else if("backcolor"===format){const originalTextColors=(0,_colorstorage.getOriginalTextColors)();editor.options.register(forecolorMap,{processor:()=>({value:originalTextColors,valid:!0}),default:[]});const selectedTextColor=rgbToHex(window.getComputedStyle(editor.selection.getNode()).color);selectedTextColor&&"#000000"!==selectedTextColor||resetFilteredColors(editor,"forecolor")}};_exports.resetFilteredColors=resetFilteredColors}));

//# sourceMappingURL=coloraccessibility.min.js.map