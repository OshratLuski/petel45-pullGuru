define("tiny_insertforum/commands",["exports","editor_tiny/utils","core/str","./common","core/modal","core/modal_events","core/templates","core/ajax"],(function(_exports,_utils,_str,_common,_modal,_modal_events,_templates,_ajax){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/**
   * Commands helper for the Moodle tiny_insertforum plugin.
   *
   * @module      tiny_insertforum/commands
   * @copyright   2025 Devlion <devlion@devlion.co>
   * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.getSetup=void 0,_modal=_interopRequireDefault(_modal),_modal_events=_interopRequireDefault(_modal_events),_templates=_interopRequireDefault(_templates),_ajax=_interopRequireDefault(_ajax);_exports.getSetup=async()=>{const[buttonImage,buttonTitle]=await Promise.all([(0,_utils.getButtonImage)("icon",_common.component),(0,_str.get_string)("pluginname",_common.component)]);return editor=>{editor.ui.registry.addIcon(_common.icon,buttonImage.html),editor.ui.registry.addButton(_common.buttonName,{icon:_common.icon,tooltip:buttonTitle,onAction:()=>(async editor=>{const data=await _ajax.default.call([{methodname:"tiny_insertforum_get_modal_data",args:{courseid:M.cfg.courseId}}])[0],modal=await _modal.default.create({title:await(0,_str.get_string)("pluginname","tiny_insertforum"),body:await _templates.default.render("tiny_insertforum/modal",{forums:data.forums,groups:data.groups,groupings:data.groupings})});modal.show(),modal.getRoot().on(_modal_events.default.hidden,(function(){var _document$querySelect;null===(_document$querySelect=document.querySelector("#insertforum-modal"))||void 0===_document$querySelect||_document$querySelect.remove()})),document.querySelector("#insertforum_submit").addEventListener("click",(()=>{var _document$querySelect2;const forumid=document.querySelector("#insertforum_forum").value,groupid=document.querySelector("#insertforum_group").value,groupingid=document.querySelector("#insertforum_grouping").value,postcount=document.querySelector("#insertforum_posts").value;editor.insertContent("[[forum(".concat(forumid,",").concat(groupid,",").concat(groupingid,",").concat(postcount,")]]")),modal.destroy(),null===(_document$querySelect2=document.querySelector("#insertforum-modal"))||void 0===_document$querySelect2||_document$querySelect2.remove()}))})(editor)})}}}));

//# sourceMappingURL=commands.min.js.map