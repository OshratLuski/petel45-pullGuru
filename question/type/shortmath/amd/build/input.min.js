define("qtype_shortmath/input",["exports","qtype_shortmath/visual-math-input","./api_helpers","jquery"],(function(_exports,_visualMathInput,_api_helpers,_jquery){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.initialize=void 0,_visualMathInput=_interopRequireDefault(_visualMathInput),_jquery=_interopRequireDefault(_jquery);var fn,_ref,initialize=(fn=regeneratorRuntime.mark((function _callee(inputname,readonly,questionId){var customscale,readOnly,shortanswerInput,parent,input,template,controlsWrapper,controls,scale,inputblock,_args=arguments;return regeneratorRuntime.wrap((function(_context){for(;;)switch(_context.prev=_context.next){case 0:if(customscale=_args.length>3&&void 0!==_args[3]&&_args[3],readOnly=readonly,inputname=inputname.replaceAll(":","\\:"),(shortanswerInput=document.querySelector("#".concat(inputname))).classList.remove("d-inline"),parent=shortanswerInput.parentElement,(input=new _visualMathInput.default.Input(shortanswerInput,parent)).rawInput.style.display="none",readonly?(readOnly=!0,input.disabled=!0,input.disable()):input.onEdit=function($input,field){$input.value=field.latex(),$input.dispatchEvent(new Event("change"))},shortanswerInput.value.length>0&&input.mathInput.write(shortanswerInput.value),readOnly){_context.next=20;break}return _context.next=13,(0,_api_helpers.getShortmathEditorconfig)(parseInt(questionId));case 13:template=_context.sent,controlsWrapper=shortanswerInput.closest(".shortmath").querySelector(".controls_wrapper"),(controls=new _visualMathInput.default.ControlList(controlsWrapper)).bindInput(input),null===template?controls.defineDefault():template.forEach((function(value){var html=value.button,command=value.expression;controls.define(command,html,(function(field){return field.write(command)}))})),controls.enableAll(),customscale&&(scale=(0,_jquery.default)(controls)[0].wrapper,(0,_jquery.default)(scale).hide(),(0,_jquery.default)(scale).addClass("customscale"),(inputblock=(0,_jquery.default)(parent).parent()).after('<span class="open-icon-visual-math mr-2 ml-2"><i class="fas fa-keyboard"></i></span>'),inputblock.parent().find(".open-icon-visual-math").click((function(){var flagopened=!1;(0,_jquery.default)(scale).is(":visible")&&(flagopened=!0),(0,_jquery.default)(".visual-math-input-wrapper").each((function(){(0,_jquery.default)(this).hasClass("customscale")&&(0,_jquery.default)(this).hide()})),flagopened?(0,_jquery.default)(scale).hide():(0,_jquery.default)(scale).show()})));case 20:case"end":return _context.stop()}}),_callee)})),_ref=function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))},function(_x,_x2,_x3){return _ref.apply(this,arguments)});_exports.initialize=initialize}));

//# sourceMappingURL=input.min.js.map