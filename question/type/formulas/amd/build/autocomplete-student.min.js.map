{"version":3,"file":"autocomplete-student.min.js","sources":["../src/autocomplete-student.js"],"sourcesContent":["define([], function() {\n    'use strict';\n\n    function KeySelect() {\n\n        let currentItem = -1;\n\n        let items = '';\n\n        const forms = Array.from(document.querySelectorAll(`form`));\n\n        this.init = function(container) {\n            items = Array.from(container.childNodes);\n\n            forms.forEach((form) => {\n                if (form.contains(container)) {\n                    form.onkeydown = (event) => {\n                        if (event.keyCode === 13) {\n                            event.preventDefault();\n                        }\n                    };\n                }\n            });\n\n            container.onmouseover = (e) => {\n                items.forEach((item, index) => {\n                    item.classList.remove(`aut-hover`);\n                    if (e.target === item) {\n                        currentItem = index;\n                    }\n                });\n\n                e.target.classList.add(`aut-hover`);\n            };\n\n        };\n\n        const makeHover = () => {\n            items.forEach((item) => {\n                item.classList.remove(`aut-hover`);\n            });\n            items[currentItem].classList.add(`aut-hover`);\n        };\n\n        const goUp = () => {\n            if (currentItem <= 0) {\n                return;\n            }\n            currentItem--;\n            makeHover();\n        };\n\n        const goDown = () => {\n            if (currentItem >= items.length - 1) {\n                return;\n            }\n            currentItem++;\n            makeHover();\n        };\n\n        const selectItem = () => {\n            let event = new Event('click', {bubbles: true});\n            if (items[currentItem]) {\n                items[currentItem].dispatchEvent(event);\n                currentItem = -1;\n            }\n            currentItem = -1;\n        };\n\n        const hideAll = () => {\n            container.innerHTML = '';\n            container.style.display = 'none';\n            currentItem = -1;\n        };\n\n        this.checkKeyCode = function(event) {\n            switch (event.keyCode) {\n                case 38:\n                    goUp();\n                    break;\n                case 40:\n                    goDown();\n                    break;\n                case 13:\n                    selectItem();\n                    break;\n                case 27:\n                    hideAll();\n                    break;\n            }\n        };\n\n    }\n\n    const addStyleToPage = () => {\n\n        const style = document.createElement(`style`);\n        style.classList.add('autocomplete_style');\n        style.innerHTML = `\n            .compl__outer {\n              top: 34px;\n              left: 0;\n              width: 60%;\n              background-color: #fff;\n              box-sizing: content-box;\n              border-radius: 5px;\n              overflow: hidden;\n              display: none;\n              border: 1px solid #ddd;\n              padding: 0;\n              position: absolute;\n              list-style-type: none;\n              z-index: 1000;\n            }\n            .compl__outer > li {\n              padding: 10px;\n              cursor: pointer;\n              border-bottom: 1px solid #ddd;\n            }\n            .compl__outer > li.aut-hover {\n        \n              background-color: #bbb;\n            }\n            .compl__outer-placeholder {\n              color: #9e9e9e;\n            }\n            .formulaspart .compl__outer {\n                right: 0;\n                width: 20%;\n            }\n        `;\n        if (!document.querySelector('.autocomplete_style')) {\n            document.querySelector('body').appendChild(style);\n        }\n    };\n\n    const makeOutputBlock = (inputSelector) => {\n\n        const outputBlock = document.createElement(`ul`);\n        outputBlock.classList.add('compl__outer');\n        inputSelector.parentNode.style.position = 'relative';\n        inputSelector.parentNode.appendChild(outputBlock);\n\n        return outputBlock;\n    };\n\n    const setStyleError = (input) => {\n        input.style.borderColor = `red`;\n        input.style.outlineColor = `red`;\n        input.style.color = `red`;\n    };\n    const setStyleInherit = (input) => {\n        input.style.borderColor = ``;\n        input.style.outlineColor = ``;\n        input.style.color = ``;\n    };\n\n    const autocomplete = {\n\n        init: (inputSelectorsJson, searchWordsJson) => {\n\n            let targetArray = JSON.parse(searchWordsJson);\n            let inputSelectorsName = JSON.parse(inputSelectorsJson);\n            if (!Array.isArray(targetArray) || !Array.isArray(inputSelectorsName)) {\n             return;\n            }\n\n            const keySelect = new KeySelect();\n            document.addEventListener('keydown', keySelect.checkKeyCode);\n\n            let allSelectors = inputSelectorsName.join(', ');\n            const inputSelectors = Array.from(document.querySelectorAll(allSelectors));\n\n            inputSelectors.forEach(function(inputSelector) {\n                if (!inputSelector) {\n                    return;\n                }\n\n                inputSelector.autocomplete = `off`;\n                let outputBlockPrevStep;\n\n                let outputBlock = makeOutputBlock(inputSelector);\n                const outerItem = document.createElement(`li`);\n                outerItem.classList.add('compl__outer-item');\n\n                inputSelector.addEventListener(`input`, function(e) {\n                    setStyleInherit(inputSelector);\n                    outputBlock.innerHTML = '';\n                    outputBlock.style.display = 'none';\n\n                    // Get value and unit.\n                    let string = this.value;\n                    string = string.replaceAll(' ', '');\n                    string = string.replaceAll('E+', 'E');\n                    string = string.replaceAll('e+', 'e');\n\n                    string = string.replaceAll('\\\\', '');\n\n                    let flagerrordigit = false;\n                    let flag = true;\n                    let digitInputValue = '';\n                    let notDigitInputValue = '';\n\n                    const degree = ['E', 'e', '^'];\n                    const specific = ['.', '-', '+'];\n                    const operand = ['-', '+'];\n                    const numbers = ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9'];\n\n                    let numberchars = [];\n                    numberchars = numberchars.concat(numbers, degree, specific);\n\n                    for (let i = 0; i <= string.length - 1; i++) {\n                        let char = string.charAt(i);\n\n                        if (numberchars.includes(char)) {\n\n                            // Check degree.\n                            if (flag && degree.includes(char)) {\n                                if (!numbers.includes(string.charAt(i + 1)) && !operand.includes(string.charAt(i + 1))) {\n                                    flag = false;\n                                }\n                            }\n\n                            if (flag) {\n                                digitInputValue += char;\n                            } else {\n                                notDigitInputValue += char;\n                            }\n                        } else {\n                            flag = false;\n                            notDigitInputValue += char;\n                        }\n                    }\n\n                    // Check errors specific chars.\n                    let ch, count;\n                    let counts = {};\n\n                    for (let i = 0, len = digitInputValue.length; i < len; ++i) {\n\n                        // Disable first \"-\".\n                        if (i === 0 && digitInputValue.charAt(0) === '-') {\n                            continue;\n                        }\n\n                        ch = digitInputValue.charAt(i);\n                        count = counts[ch];\n                        counts[ch] = count ? count + 1 : 1;\n                    }\n\n                    specific.forEach(function(char, index) {\n                        if (counts[char] > 1) {\n                            flagerrordigit = true;\n                        }\n                    });\n\n                    let inputValue = this.value.replaceAll('\\\\', '');\n\n                    if (digitInputValue.length && notDigitInputValue.length && !flagerrordigit) {\n\n                        // Const digitInputValue = inputValue.match(/\\d|[.]|[+-]|[\\s]|[E|/\\^|*]/g);\n                        // const notDigitInputValue = inputValue.replace(/\\d|[.]|[+-]|[\\s]|[E|/\\^|*]/g, '');\n                        // const withoutnumber = inputValue.replace(digitInputValue, '').replace(/\\s+/, \"\");\n                        // const value = new RegExp(`${withoutnumber}`, `i`);\n\n                        // Change '*' for find operation;\n                        notDigitInputValue = notDigitInputValue.replaceAll('*', '\\\\*');\n\n                        // Change '^' for find operation;\n                        notDigitInputValue = notDigitInputValue.replaceAll('^', '\\\\^');\n\n                        const unit = new RegExp(`${notDigitInputValue}`, `i`);\n                        const unitcelcius = new RegExp('Â°' + `${notDigitInputValue}`, `i`);\n\n                        outputBlock.style.display = 'block';\n\n                        targetArray.sort().forEach(function(item) {\n                            let itemParts = item.toString().split(`(`);\n\n                            if (itemParts[0].search(unit) === 0 || itemParts[0].search(unitcelcius) === 0) {\n                                let el = outerItem.cloneNode();\n                                el.innerHTML = `<span class = \"compl__outer-data\">${itemParts[0]}</span>\n                                    <span class = \"compl__outer-placeholder\">${itemParts[1] ? '(' + itemParts[1] : ''}</span>`;\n                                outputBlock.appendChild(el);\n                            }\n                        });\n\n                        if (outputBlock.innerHTML) {\n                            outputBlockPrevStep = outputBlock.innerHTML;\n                            outputBlock.style.display = 'block';\n                            keySelect.init(outputBlock);\n                        } else {\n                            setStyleError(inputSelector);\n                            outputBlock.innerHTML = '';\n                            outputBlock.style.display = 'none';\n                        }\n\n                        outputBlock.addEventListener('click', function(e) {\n                            let targetEl = e.target;\n                            while (targetEl.tagName !== `UL`) {\n                                if (targetEl.tagName === `LI`) {\n\n                                    // Let result = inputSelector.value.search(/[a-z]/gimu);\n\n                                    // $.each(digitInputValue, function(index, value) {\n                                    //     if (value === '/') {\n                                    //         delete digitInputValue[index];\n                                    //     }\n                                    // });\n\n                                    inputSelector.value = (digitInputValue + targetEl.firstChild.innerHTML).trim();\n                                    outputBlock.style.display = 'none';\n                                    return;\n                                }\n                                targetEl = targetEl.parentNode;\n                            }\n\n                        });\n\n                        // Remove wrong digit input.\n                    } else if (inputValue.search(/[+-\\d]+/) !== 0 || flagerrordigit) {\n                        setTimeout(function() {\n                            inputSelector.value = inputSelector.value.substr(0, inputSelector.value.length - 1);\n                        }, 300);\n                    }\n\n                });\n\n                inputSelector.addEventListener('blur', function(e) {\n                    setTimeout(function(e) {\n                        outputBlock.style.display = 'none';\n                        outputBlock.innerHTML = '';\n                    }, 500);\n                });\n\n            });\n\n            addStyleToPage();\n        }\n    };\n\n    return autocomplete;\n});\n"],"names":["define","KeySelect","currentItem","items","forms","Array","from","document","querySelectorAll","init","container","childNodes","forEach","form","contains","onkeydown","event","keyCode","preventDefault","onmouseover","e","item","index","classList","remove","target","add","makeHover","checkKeyCode","length","Event","bubbles","dispatchEvent","selectItem","innerHTML","style","display","inputSelectorsJson","searchWordsJson","targetArray","JSON","parse","inputSelectorsName","isArray","keySelect","addEventListener","allSelectors","join","inputSelector","autocomplete","outputBlock","createElement","parentNode","position","appendChild","makeOutputBlock","outerItem","input","borderColor","outlineColor","color","string","this","value","replaceAll","ch","count","flagerrordigit","flag","digitInputValue","notDigitInputValue","degree","specific","operand","numbers","numberchars","concat","i","char","charAt","includes","counts","len","inputValue","unit","RegExp","unitcelcius","sort","itemParts","toString","split","search","el","cloneNode","setStyleError","targetEl","tagName","firstChild","trim","setTimeout","substr","querySelector"],"mappings":"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"}