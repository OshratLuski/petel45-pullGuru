{"version":3,"file":"autocomplete-teachers.min.js","sources":["../src/autocomplete-teachers.js"],"sourcesContent":["define([''], function () {\n    'use strict';\n\n    let btnToggle;\n\n    // document.addEventListener('change',function(event){\n    //   let target = event.target;\n    //   let fieldset;\n    //   while (!target.classList.contains('panel-body')) {\n    //     if ((target.tagName == 'SELECT')) {\n    //       if ((target.name.search(/answertype/i)) >= 0) {\n    //         fieldset = target;\n    //         while (fieldset.tagName != 'FIELDSET') {\n    //           fieldset = fieldset.parentNode;\n    //         }\n    //\n    //         btnToggle = fieldset.querySelectorAll(`input[name^=\"autocomplete\"]`);\n    //         if (target.value != 0) {\n    //           btnToggle.forEach((item)=>{\n    //             item.disabled = true;\n    //           });\n    //           btnToggle[1].checked = true;\n    //         }else {\n    //           btnToggle.forEach((item)=>{\n    //             item.disabled = false;\n    //           });\n    //           btnToggle[0].checked = true;\n    //         }\n    //\n    //         return\n    //       }\n    //     }\n    //     target = target.parentNode;\n    //   }\n    // });\n\n    const checkSwitch = () => {\n\n        if (!btnToggle.length) {\n            return false;\n        }\n\n        if (btnToggle[0].checked) {\n            return false;\n        } else {\n            return true;\n        }\n    }\n\n    function KeySelect() {\n\n        let currentItem = -1;\n\n        let items = '';\n\n        const forms = Array.from(document.querySelectorAll(`form`));\n\n        this.init = function (container) {\n            items = Array.from(container.childNodes);\n\n            forms.forEach((form) => {\n                if (form.contains(container)) {\n                    form.onkeydown = (event) => {\n                        if (event.keyCode === 13) {\n                            event.preventDefault();\n                        }\n                    }\n                }\n            });\n\n            container.onmouseover = (e) => {\n                items.forEach((item, index) => {\n                    item.classList.remove(`aut-hover`);\n                    if (e.target === item) {\n                        currentItem = index;\n                    }\n                });\n\n                e.target.classList.add(`aut-hover`);\n            }\n\n        }\n\n        const makeHover = () => {\n            items.forEach((item) => {\n                item.classList.remove(`aut-hover`);\n            });\n            items[currentItem].classList.add(`aut-hover`);\n        }\n\n        const goUp = () => {\n            if (currentItem <= 0) {\n                return;\n            }\n            currentItem--;\n            makeHover();\n        }\n\n        const goDown = () => {\n            if (currentItem >= items.length - 1) {\n                return;\n            }\n            currentItem++;\n            makeHover();\n        }\n\n        const selectItem = () => {\n            let event = new Event('click', {bubbles: true});\n            if (items[currentItem]) {\n                items[currentItem].dispatchEvent(event);\n                currentItem = -1;\n            }\n            currentItem = -1;\n        }\n\n        const hideAll = () => {\n            container.innerHTML = '';\n            container.style.display = 'none';\n            currentItem = -1;\n        }\n\n        this.checkKeyCode = function (event) {\n            switch (event.keyCode) {\n                case 38:\n                    goUp();\n                    break;\n                case 40:\n                    goDown();\n                    break;\n                case 13:\n                    selectItem();\n                    break;\n                case 27:\n                    hideAll();\n                    break;\n            }\n        }\n\n    }\n\n    const addStyleToPage = () => {\n\n        const style = document.createElement(`style`);\n        style.innerHTML = `\n          .compl__outer {\n            min-width: 150px;\n            background-color: #fff;\n            box-sizing: content-box;\n            border-radius: 5px;\n            overflow: hidden;\n            display: none;\n            margin: 2px 0 0 0;\n            border: 1px solid #ddd;\n            padding: 0;\n            position: absolute;\n            left: 0;\n            list-style-type: none;\n            z-index: 1000;\n          }\n          .compl__outer > li {\n            padding: 10px;\n            cursor: pointer;\n            border-bottom: 1px solid #ddd;\n          }\n          .compl__outer > li.aut-hover {\n            background-color: #bbb;\n          }\n        `;\n        document.querySelector('body').appendChild(style);\n    }\n\n    const autocomplete = {\n\n        init: (inputSelectorsJson, searchWordsJson) => {\n            const keySelect = new KeySelect();\n            document.addEventListener('keydown', keySelect.checkKeyCode);\n\n\n            let searchWords = JSON.parse(searchWordsJson);\n            let inputSelectorsName = JSON.parse(inputSelectorsJson);\n            if (!Array.isArray(searchWords) || !Array.isArray(inputSelectorsName)) return;\n\n            inputSelectorsName.forEach((item) => {\n\n                let inputSelectors = Array.from(document.querySelectorAll(item));\n\n                inputSelectors.forEach((inputSelector) => {\n                    if (!inputSelectors) return;\n\n                    const outerBlock = document.createElement(`ul`);\n                    outerBlock.classList.add('compl__outer');\n                    const outerItem = document.createElement(`li`);\n                    outerItem.classList.add('compl__outer-item');\n                    let outerBlockPrevStep;\n\n                    inputSelector.autocomplete = `off`;\n                    inputSelector.parentNode.appendChild(outerBlock);\n\n                    inputSelector.addEventListener(`input`, function (e) {\n                        let fieldset = inputSelector;\n                        while (fieldset.tagName !== 'FIELDSET') {\n                            fieldset = fieldset.parentNode;\n                        }\n                        btnToggle = fieldset.querySelectorAll(`input[name^=\"autocomplete\"]`);\n\n                        if (checkSwitch()) return;\n                        outerBlock.style.top = inputSelector.offsetTop + inputSelector.offsetHeight + 10 + 'px';\n                        outerBlock.style.left = inputSelector.offsetLeft + 'px';\n                        // outerBlock.style.right = inputSelector.offsetRight  + 'px';\n                        outerBlock.style.width = inputSelector.clientWidth + 'px';\n                        outerBlock.innerHTML = '';\n\n                        let tempval = this.value.replaceAll('\\\\', '');\n                        const value = new RegExp(`${tempval}`, `i`);\n                        const valuecelcius = new RegExp('Â°' + `${tempval}`, `i`);\n\n                        searchWords.sort().forEach(function (item) {\n                            if (tempval && (item.search(value) === 0 || item.search(valuecelcius) === 0)) {\n                                let el = outerItem.cloneNode()\n                                el.innerHTML = item;\n                                outerBlock.appendChild(el);\n                            }\n                        });\n\n                        if (outerBlock.innerHTML) {\n\n                            outerBlockPrevStep = outerBlock.innerHTML;\n                            outerBlock.style.display = 'block';\n                            keySelect.init(outerBlock);\n\n                            outerBlock.addEventListener('click', function (e) {\n                                let targetEl = e.target;\n                                while (targetEl.tagName !== `UL`) {\n                                    if (targetEl.tagName === `LI`) {\n                                        inputSelector.value = targetEl.innerHTML;\n                                        outerBlock.style.display = 'none';\n                                    }\n                                    targetEl = targetEl.parentNode;\n                                }\n                            });\n\n                        } else {\n                            setTimeout(function () {\n                                inputSelector.value = inputSelector.value.substr(0, inputSelector.value.length - 1)\n                            }, 500);\n                            if (outerBlockPrevStep && inputSelector.value) {\n                                outerBlock.innerHTML = outerBlockPrevStep;\n                                keySelect.init(outerBlock);\n                            } else {\n                                outerBlock.innerHTML = '';\n                                outerBlock.style.display = 'none';\n                            }\n                        }\n\n                    });\n\n                    inputSelector.addEventListener('blur', function (e) {\n                        setTimeout(() => {\n                            outerBlock.style.display = 'none';\n                            outerBlock.innerHTML = '';\n                        }, 300);\n                    });\n\n                });\n\n            });\n\n            addStyleToPage();\n        }\n    }\n\n    return autocomplete\n\n});\n"],"names":["define","btnToggle","KeySelect","currentItem","items","forms","Array","from","document","querySelectorAll","init","container","childNodes","forEach","form","contains","onkeydown","event","keyCode","preventDefault","onmouseover","e","item","index","classList","remove","target","add","makeHover","checkKeyCode","length","Event","bubbles","dispatchEvent","selectItem","innerHTML","style","display","inputSelectorsJson","searchWordsJson","keySelect","addEventListener","searchWords","JSON","parse","inputSelectorsName","isArray","inputSelectors","inputSelector","outerBlock","createElement","outerBlockPrevStep","outerItem","autocomplete","parentNode","appendChild","fieldset","tagName","checked","top","offsetTop","offsetHeight","left","offsetLeft","width","clientWidth","tempval","this","value","replaceAll","RegExp","valuecelcius","sort","search","el","cloneNode","targetEl","setTimeout","substr","querySelector"],"mappings":"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"}