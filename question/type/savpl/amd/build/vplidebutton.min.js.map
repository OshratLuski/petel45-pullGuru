{"version":3,"file":"vplidebutton.min.js","sources":["../src/vplidebutton.js"],"sourcesContent":["// This file is part of VPL for Moodle - http://vpl.dis.ulpgc.es/\r\n//\r\n// VPL for Moodle is free software: you can redistribute it and/or modify\r\n// it under the terms of the GNU General Public License as published by\r\n// the Free Software Foundation, either version 3 of the License, or\r\n// (at your option) any later version.\r\n//\r\n// VPL for Moodle is distributed in the hope that it will be useful,\r\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n// GNU General Public License for more details.\r\n//\r\n// You should have received a copy of the GNU General Public License\r\n// along with VPL for Moodle.  If not, see <http://www.gnu.org/licenses/>.\r\n\r\n/**\r\n * IDE Buttons\r\n *\r\n * @copyright 2016 Juan Carlos Rodríguez-del-Pino\r\n * @license http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\r\n * @author Juan Carlos Rodríguez-del-Pino <jcrodriguez@dis.ulpgc.es>\r\n */\r\n\r\ndefine(\r\n    [\r\n        'jquery',\r\n        'jqueryui',\r\n        'qtype_savpl/vplutil',\r\n        'qtype_savpl/vplui'\r\n    ],\r\n    function($, jqui, VPLUtil, VPLUI) {\r\n        if (typeof VPLIDEButtons !== 'undefined') {\r\n            return VPLIDEButtons;\r\n        }\r\n        var VPLIDEButtons = function(menuElement, isOptionAllowed) {\r\n            var self = this;\r\n            var buttons = {};\r\n\r\n            this.notAdded = function(buttonName) {\r\n                return !buttons[buttonName];\r\n            };\r\n            this.setText = function(buttonName, icon, title) {\r\n                if (self.notAdded(buttonName)) {\r\n                    return;\r\n                }\r\n                if (!icon) {\r\n                    icon = buttons[buttonName].icon;\r\n                }\r\n                if (!title) {\r\n                    title = buttons[buttonName].title;\r\n                }\r\n                if (!title) {\r\n                    title = VPLUtil.str(icon);\r\n                }\r\n                buttons[buttonName].icon = icon;\r\n                buttons[buttonName].title = title;\r\n                if (buttons[buttonName].hasOwnProperty('key')) {\r\n                    title += ' (' + buttons[buttonName].key + ')';\r\n                }\r\n                $('#vpl_ide_' + buttonName).attr('title', title);\r\n                $('#vpl_ide_' + buttonName + ' i').replaceWith(VPLUI.genIcon(icon));\r\n            };\r\n            this.setExtracontent = function(buttonName, html) {\r\n                if (self.notAdded(buttonName)) {\r\n                    return;\r\n                }\r\n                var cl = 'vpl_bt_extrahtml';\r\n                var btag = $('#vpl_ide_' + buttonName);\r\n                if (btag.find('.' + cl).length == 0) {\r\n                    btag.append(' <span class=\"' + cl + '\"><span>');\r\n                }\r\n                btag.find('.' + cl).html(html);\r\n            };\r\n            this.add = function(button) {\r\n                if (typeof button === 'string') {\r\n                    var name = button;\r\n                    button = {\r\n                        'name': name\r\n                    };\r\n                }\r\n                if (!isOptionAllowed(button.name)) {\r\n                    return;\r\n                }\r\n                if (!button.hasOwnProperty('icon')) {\r\n                    button.icon = button.name;\r\n                }\r\n                if (!button.hasOwnProperty('title')) {\r\n                    button.title = VPLUtil.str(button.name);\r\n                }\r\n                if (!button.hasOwnProperty('active')) {\r\n                    button.active = true;\r\n                }\r\n                if (!button.hasOwnProperty('editorName')) {\r\n                    button.editorName = button.name;\r\n                }\r\n                if (!button.hasOwnProperty('originalAction')) {\r\n                    button.originalAction = VPLUtil.doNothing;\r\n                }\r\n                if (self.notAdded(button.name)) {\r\n                    buttons[button.name] = button;\r\n                } else {\r\n                    throw new Error(\"Button already set \" + button.name);\r\n                }\r\n                self.setAction(button.name, button.originalAction);\r\n                if (button.hasOwnProperty('bindKey')) {\r\n                    button.command = {\r\n                        name: button.editorName,\r\n                        bindKey: button.bindKey,\r\n                        exec: button.action\r\n                    };\r\n                    var platformStr = '';\r\n                    if (navigator.userAgentData) {\r\n                        platformStr = navigator.userAgentData.platform;\r\n                    } else if (navigator.platform) {\r\n                        platformStr = navigator.platform;\r\n                    }\r\n                    var platform = platformStr.startsWith(\"Mac\") ? \"mac\" : \"win\";\r\n                    button.key = button.bindKey[platform];\r\n                }\r\n            };\r\n            this.getHTML = function(buttonName) {\r\n                if (self.notAdded(buttonName)) {\r\n                    return '';\r\n                } else {\r\n                    var title = buttons[buttonName].title;\r\n                    if (buttons[buttonName].hasOwnProperty('key')) {\r\n                        title += ' (' + buttons[buttonName].key + ')';\r\n                    }\r\n\r\n                    var html = \"<a id='vpl_ide_\" + buttonName + \"' href='#' title='\" + title + \"'>\";\r\n                    html += VPLUI.genIcon(buttons[buttonName].icon) + \"</a>\";\r\n                    return html;\r\n                }\r\n            };\r\n\r\n            this.enable = function(buttonName, active) {\r\n                if (self.notAdded(buttonName)) {\r\n                    return;\r\n                }\r\n                var bw = $('#vpl_ide_' + buttonName);\r\n                buttons[buttonName].active = active;\r\n                bw.data(\"vpl-active\", active);\r\n                if (!active) {\r\n                    bw.addClass('ui-button-disabled ui-state-disabled');\r\n                } else {\r\n                    bw.removeClass('ui-button-disabled ui-state-disabled');\r\n                }\r\n            };\r\n            this.setAction = function(buttonName, action) {\r\n                if (self.notAdded(buttonName)) {\r\n                    return;\r\n                }\r\n                buttons[buttonName].originalAction = action;\r\n                buttons[buttonName].action = function() {\r\n                    if (buttons[buttonName].active) {\r\n                        action();\r\n                    }\r\n                };\r\n            };\r\n            this.getAction = function(buttonName) {\r\n                if (self.notAdded(buttonName)) {\r\n                    return VPLUtil.doNothing;\r\n                }\r\n                return buttons[buttonName].action;\r\n            };\r\n            this.launchAction = function(buttonName) {\r\n                if (self.notAdded(buttonName)) {\r\n                    return;\r\n                }\r\n                buttons[buttonName].originalAction();\r\n            };\r\n            this.setGetkeys = function(editor) {\r\n                if (!editor) {\r\n                    return;\r\n                }\r\n                var commands = editor.commands.commands;\r\n                var platform = editor.commands.platform;\r\n                for (var buttonName in buttons) {\r\n                    if (buttons.hasOwnProperty(buttonName)) {\r\n                        var editorName = buttons[buttonName].editorName;\r\n                        if (commands[editorName] && commands[editorName].bindKey && !buttons[buttonName].Key) {\r\n                            buttons[buttonName].key = commands[editorName].bindKey[platform];\r\n                            self.setText(buttonName);\r\n                        } else {\r\n                            if (buttons[buttonName].bindKey &&\r\n                                !buttons[buttonName].hasOwnProperty('key')) {\r\n                                buttons[buttonName].key = buttons[buttonName].bindKey[platform];\r\n                                self.setText(buttonName);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            };\r\n            this.getShortcuts = function(editor) {\r\n                var html = '<ul>';\r\n                for (var buttonName in buttons) {\r\n                    if (buttons[buttonName].hasOwnProperty('key')) {\r\n                        html += '<li>';\r\n                        html += buttons[buttonName].title + ' (' + buttons[buttonName].key + ')';\r\n                        html += '</li>';\r\n                    }\r\n                }\r\n                html += '</ul>';\r\n                if (editor) {\r\n                    html += '<h5>' + VPLUtil.str('edit') + '</h5>';\r\n                    var commands = editor.commands.commands;\r\n                    var platform = editor.commands.platform;\r\n                    html += '<ul>';\r\n                    for (var editorName in commands) {\r\n                        if (commands[editorName].hasOwnProperty('bindKey') && commands[editorName].bindKey[platform] > '') {\r\n                            html += '<li>';\r\n                            html += editorName + ' (' + commands[editorName].bindKey[platform] + ')';\r\n                            html += '</li>';\r\n                        }\r\n                    }\r\n                    html += '</ul>';\r\n                }\r\n                if (html == '<ul></ul>') {\r\n                    return '';\r\n                }\r\n                return html;\r\n            };\r\n            $(menuElement).on(\"click\", \"a\", function(event) {\r\n                if ($(this).data(\"vpl-active\")) {\r\n                    var actionid = $(this).attr('id');\r\n                    if (typeof actionid === 'string' && actionid.startsWith('vpl_ide_')) {\r\n                        actionid = actionid.replace('vpl_ide_', '');\r\n                    } else {\r\n                        return true;\r\n                    }\r\n                    if (self.notAdded(actionid)) {\r\n                        return true;\r\n                    }\r\n                    if (buttons[actionid] && !buttons[actionid].active) {\r\n                        return true;\r\n                    }\r\n                    var action = self.getAction(actionid);\r\n                    if (actionid != 'import') {\r\n                        setTimeout(action, 10);\r\n                    } else {\r\n                        action();\r\n                    }\r\n                }\r\n                event.stopImmediatePropagation();\r\n                return false;\r\n            });\r\n\r\n            $('body').on('keydown', function(event) {\r\n                var check = false;\r\n                var strkey = '';\r\n                if (event.shiftKey) {\r\n                    strkey += 'shift-';\r\n                }\r\n                if (event.altKey) {\r\n                    strkey += 'alt-';\r\n                    check = true;\r\n                }\r\n                if (event.ctrlKey) {\r\n                    strkey += 'ctrl-';\r\n                    check = true;\r\n                }\r\n                if (event.metaKey) {\r\n                    strkey += 'meta-';\r\n                    check = true;\r\n                }\r\n                if (event.which >= 112 && event.which <= 123) {\r\n                    strkey += 'f' + (event.which - 111);\r\n                    check = true;\r\n                } else {\r\n                    var char = String.fromCharCode(event.which).toLowerCase();\r\n                    if (char < 'a' || char > 'z') {\r\n                        check = false;\r\n                    } else {\r\n                        strkey += char;\r\n                    }\r\n                }\r\n                if (check) {\r\n                    for (var buttonName in buttons) {\r\n                        if (buttons[buttonName].hasOwnProperty('key')) {\r\n                            if (strkey == buttons[buttonName].key.toLowerCase()) {\r\n                                event.preventDefault();\r\n                                event.stopImmediatePropagation();\r\n                                buttons[buttonName].action();\r\n                                return false;\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                return true;\r\n            });\r\n            this.multiple = function(v, m) {\r\n                return v - (v % m);\r\n            };\r\n\r\n            (function() {\r\n                var start = 0;\r\n                var lastLap = 0;\r\n                var interval = false;\r\n                var hour = 60 * 60;\r\n                var day = hour * 24;\r\n                var cssclasses = 'vpl_buttonleft_orange vpl_buttonleft_red vpl_buttonleft_black';\r\n                var show = false;\r\n                var element = null;\r\n                var precision = 5;\r\n                var checkt = 1000;\r\n                var timeLeft = 0;\r\n                var updatePrecision = function(timeLeft) {\r\n                    precision = 5;\r\n                    checkt = 1000;\r\n                    if (timeLeft > hour) {\r\n                        precision = 60;\r\n                        checkt = 5000;\r\n                    } else if (timeLeft > day) {\r\n                        precision = 5 * 60;\r\n                        checkt = 5 * 5000;\r\n                    }\r\n                };\r\n                var updateTimeLeft = function() {\r\n                    var now = self.multiple(VPLUtil.getCurrentTime(), precision);\r\n                    if (now === lastLap || element === null) {\r\n                        return;\r\n                    }\r\n                    lastLap = now;\r\n                    var tl = timeLeft - (lastLap - start);\r\n                    var cssclass = '';\r\n                    if (tl <= 0) {\r\n                        cssclass = 'vpl_buttonleft_black';\r\n                    } else if (tl <= 5 * 60) {\r\n                        show = true;\r\n                        cssclass = 'vpl_buttonleft_red';\r\n                    } else if (tl <= 15 * 60) {\r\n                        cssclass = 'vpl_buttonleft_orange';\r\n                    } else {\r\n                        updatePrecision(tl);\r\n                    }\r\n                    var thtml = '<span class=\"' + cssclass + '\">' + VPLUI.genIcon('timeleft');\r\n                    if (show) {\r\n                        thtml += ' ' + VPLUtil.getTimeLeft(tl);\r\n                    }\r\n                    thtml += '</span>';\r\n                    element.html(thtml);\r\n                    element.removeClass(cssclasses);\r\n                    element.addClass(cssclass);\r\n                };\r\n                self.toggleTimeLeft = function() {\r\n                    show = !show;\r\n                    lastLap = 0;\r\n                    updateTimeLeft();\r\n                };\r\n                self.setTimeLeft = function(options) {\r\n                    element = $('#vpl_ide_timeleft');\r\n                    if (interval !== false) {\r\n                        clearInterval(interval);\r\n                        interval = false;\r\n                    }\r\n                    if (options.hasOwnProperty('timeLeft')) {\r\n                        timeLeft = options.timeLeft;\r\n                        updatePrecision(timeLeft);\r\n                        var sync = timeLeft % precision;\r\n                        timeLeft = self.multiple(timeLeft, precision);\r\n                        start = self.multiple(VPLUtil.getCurrentTime(), precision);\r\n                        lastLap = start - precision;\r\n                        setTimeout(function() {\r\n                            interval = setInterval(updateTimeLeft, checkt);\r\n                        }, sync * 1000);\r\n                        $('#vpl_ide_timeleft').show();\r\n                        updateTimeLeft();\r\n\r\n                    } else {\r\n                        $('#vpl_ide_timeleft').hide();\r\n                    }\r\n                };\r\n            })();\r\n        };\r\n        window.VPLIDEButtons = VPLIDEButtons;\r\n        return VPLIDEButtons;\r\n    }\r\n);\r\n"],"names":["define","$","jqui","VPLUtil","VPLUI","VPLIDEButtons","menuElement","isOptionAllowed","start","lastLap","interval","show","element","precision","checkt","timeLeft","updatePrecision","updateTimeLeft","self","this","buttons","notAdded","buttonName","setText","icon","title","str","hasOwnProperty","key","attr","replaceWith","genIcon","setExtracontent","html","cl","btag","find","length","append","add","button","name","active","editorName","originalAction","doNothing","Error","setAction","command","bindKey","exec","action","platformStr","navigator","userAgentData","platform","startsWith","getHTML","enable","bw","data","removeClass","addClass","getAction","launchAction","setGetkeys","editor","commands","Key","getShortcuts","on","event","actionid","replace","setTimeout","stopImmediatePropagation","check","strkey","shiftKey","altKey","ctrlKey","metaKey","which","char","String","fromCharCode","toLowerCase","preventDefault","multiple","v","m","hour","now","getCurrentTime","tl","cssclass","thtml","getTimeLeft","toggleTimeLeft","setTimeLeft","options","clearInterval","sync","setInterval","hide","window"],"mappings":"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"}