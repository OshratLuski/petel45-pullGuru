{"version":3,"file":"vplidebinaryfile.min.js","sources":["../src/vplidebinaryfile.js"],"sourcesContent":["// This file is part of VPL for Moodle - http://vpl.dis.ulpgc.es/\r\n//\r\n// VPL for Moodle is free software: you can redistribute it and/or modify\r\n// it under the terms of the GNU General Public License as published by\r\n// the Free Software Foundation, either version 3 of the License, or\r\n// (at your option) any later version.\r\n//\r\n// VPL for Moodle is distributed in the hope that it will be useful,\r\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n// GNU General Public License for more details.\r\n//\r\n// You should have received a copy of the GNU General Public License\r\n// along with VPL for Moodle.  If not, see <http://www.gnu.org/licenses/>.\r\n\r\n/**\r\n * Binary files extension methods. Add to VPLFile object.\r\n *\r\n * @copyright 2013 Juan Carlos Rodríguez-del-Pino\r\n * @license http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\r\n * @author Juan Carlos Rodríguez-del-Pino <jcrodriguez@dis.ulpgc.es>\r\n */\r\n\r\ndefine(\r\n    [\r\n        'jquery',\r\n        'qtype_savpl/vplutil',\r\n    ],\r\n    function($, VPLUtil) {\r\n        return function() {\r\n            this.isBinary = function() {\r\n                return true;\r\n            };\r\n            var setOldContent = this.setContent;\r\n            this.setContent = function(c) {\r\n                setOldContent.call(this, c);\r\n                this.setModified();\r\n                this.updateDataURL();\r\n            };\r\n            this.updateDataURL = function() {\r\n                var fileName = this.getFileName();\r\n                var value = this.getContent();\r\n                var tid = this.getTId();\r\n                if (VPLUtil.isImage(fileName)) {\r\n                    var prevalue = 'data:' + VPLUtil.getMIME(fileName) + ';base64,';\r\n                    $(tid).find('img').attr('src', prevalue + value);\r\n                } else {\r\n                    $(tid).find('img').attr('src', '');\r\n                }\r\n            };\r\n            this.adjustSize = function() {\r\n                if (!this.isOpen()) {\r\n                    return false;\r\n                }\r\n                var editTag = $(this.getTId());\r\n                if (editTag.length === 0) {\r\n                    return false;\r\n                }\r\n                var tabs = editTag.parent();\r\n                var newHeight = tabs.height();\r\n                newHeight -= editTag.position().top;\r\n                if (newHeight != editTag.height()) {\r\n                    editTag.height(newHeight);\r\n                    return true;\r\n                }\r\n                return false;\r\n            };\r\n            this.open = function() {\r\n                this.showFileName();\r\n                var fileName = this.getFileName();\r\n                var tid = this.getTId();\r\n                this.setOpen(true);\r\n                if (VPLUtil.isImage(fileName)) {\r\n                    $(tid).addClass('vpl_ide_img').append('<img />');\r\n                    this.updateDataURL();\r\n                } else {\r\n                    $(tid).addClass('vpl_ide_binary').text(VPLUtil.str('binaryfile'));\r\n                }\r\n            };\r\n            this.close = function() {\r\n                this.setOpen(false);\r\n            };\r\n            this.langSelection = function() {\r\n                this.setLang('Binary');\r\n            };\r\n        };\r\n    }\r\n);\r\n"],"names":["define","$","VPLUtil","this","isBinary","setOldContent","setContent","c","call","setModified","updateDataURL","fileName","getFileName","value","getContent","tid","getTId","isImage","prevalue","getMIME","find","attr","adjustSize","isOpen","editTag","length","newHeight","parent","height","position","top","open","showFileName","setOpen","addClass","append","text","str","close","langSelection","setLang"],"mappings":";;;;;;;AAuBAA,sCACI,CACI,SACA,wBAEJ,SAASC,EAAGC,SACR,OAAO,WACHC,KAAKC,SAAW,WACZ,OAAO,GAEX,IAAIC,cAAgBF,KAAKG,WACzBH,KAAKG,WAAa,SAASC,GACvBF,cAAcG,KAAKL,KAAMI,GACzBJ,KAAKM,cACLN,KAAKO,iBAETP,KAAKO,cAAgB,WACjB,IAAIC,SAAWR,KAAKS,cAChBC,MAAQV,KAAKW,aACbC,IAAMZ,KAAKa,SACf,GAAId,QAAQe,QAAQN,UAAW,CAC3B,IAAIO,SAAW,QAAUhB,QAAQiB,QAAQR,UAAY,WACrDV,EAAEc,KAAKK,KAAK,OAAOC,KAAK,MAAOH,SAAWL,YAE1CZ,EAAEc,KAAKK,KAAK,OAAOC,KAAK,MAAO,KAGvClB,KAAKmB,WAAa,WACd,IAAKnB,KAAKoB,SACN,OAAO,EAEX,IAAIC,QAAUvB,EAAEE,KAAKa,UACrB,GAAuB,IAAnBQ,QAAQC,OACR,OAAO,EAEX,IACIC,UADOF,QAAQG,SACEC,SAErB,OADAF,WAAaF,QAAQK,WAAWC,MACfN,QAAQI,WACrBJ,QAAQI,OAAOF,YACR,IAIfvB,KAAK4B,KAAO,WACR5B,KAAK6B,eACL,IAAIrB,SAAWR,KAAKS,cAChBG,IAAMZ,KAAKa,SACfb,KAAK8B,SAAQ,GACT/B,QAAQe,QAAQN,WAChBV,EAAEc,KAAKmB,SAAS,eAAeC,OAAO,WACtChC,KAAKO,iBAELT,EAAEc,KAAKmB,SAAS,kBAAkBE,KAAKlC,QAAQmC,IAAI,gBAG3DlC,KAAKmC,MAAQ,WACTnC,KAAK8B,SAAQ,IAEjB9B,KAAKoC,cAAgB,WACjBpC,KAAKqC,QAAQ,WAGzB"}