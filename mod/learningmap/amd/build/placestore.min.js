define("mod_learningmap/placestore",["exports"],(function(_exports){Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.default=void 0;let placestore={version:2024072201,id:0,places:[],paths:[],startingplaces:[],targetplaces:[],placecolor:"#c01c28",strokecolor:"#000000",strokeopacity:1,textcolor:"#ffffff",visitedcolor:"#26a269",height:100,width:800,hidepaths:!1,mapid:"",usecheckmark:!1,editmode:!0,pulse:!1,hover:!1,showall:!1,showtext:!1,slicemode:!1,showwaygone:!1,loadJSON:function(json){try{let fromjson=JSON.parse(json);null===fromjson.textcolor&&(fromjson.textcolor=fromjson.strokecolor),Object.assign(this,fromjson)}catch{}this.version=2024072201},buildJSON:function(){return JSON.stringify(this.getPlacestore())},addPlace:function(id,linkId,linkTargetType,linkTargetSize,opacityValue){let linkedActivity=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,externalLink=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,selectedLinkType=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.places.push({id:id,linkId:linkId,linkTargetType:linkTargetType,opacityValue:+opacityValue,linkTargetSize:+linkTargetSize,linkedActivity:linkedActivity,externalLink:externalLink,selectedLinkType:selectedLinkType,placecolor:null,visitedcolor:null}),1==this.places.length&&this.addStartingPlace(id),this.id++},removePlace:function(id){this.removeStartingPlace(id),this.removeTargetPlace(id),this.places=this.places.filter((function(p){return p.id!=id}))},addStartingPlace:function(id){this.startingplaces.push(id)},removeStartingPlace:function(id){this.startingplaces=this.startingplaces.filter((function(e){return e!=id}))},isStartingPlace:function(id){return this.startingplaces.includes(id)},addTargetPlace:function(id){this.targetplaces.push(id)},removeTargetPlace:function(id){this.targetplaces=this.targetplaces.filter((function(e){return e!=id}))},changeLinkTargetType:function(id,linkTargetType){this.places.forEach((el=>{el.id===id&&(el.linkTargetType=linkTargetType)}))},isLinkTargetTypeBlank:function(id){let state;return this.places.forEach((el=>{el.id===id&&(state="_blank"===el.linkTargetType&&"checked")})),state},changeLinkTargetOpacity:function(id,opacityValue){this.places.forEach((el=>{el.id===id&&(el.opacityValue=opacityValue)}))},isLinkTargetOpacity:function(id){let value;return this.places.forEach((el=>{el.id===id&&(value=0===el.opacityValue&&"checked")})),value},changeLinkTargetSize:function(id,size){this.places.forEach((el=>{el.id===id&&(el.linkTargetSize=size)}))},isTargetPlace:function(id){return this.targetplaces.includes(id)},addPath:function(pid,fid,sid){this.paths.push({id:pid,fid:fid,sid:sid,strokecolor:null,strokedasharray:null,hidepath:null})},removePath:function(id){this.paths=this.paths.filter((function(p){return p.id!=id}))},getTouchingPaths:function(id){return this.paths.filter((function(p){return p.fid==id||p.sid==id}))},getActivityId:function(id){let place=this.places.filter((function(e){return id==e.id}));return place.length>0?place[0].linkedActivity:null},setActivityId:function(id,linkedActivity){let place=this.places.filter((function(e){return id==e.id}));place.length>0&&(place[0].linkedActivity=linkedActivity)},isValidURL:function(url){const errorElement=document.getElementById("external-link-error"),inputElement=document.getElementById("learningmap-external-link");if(""===url.trim())return errorElement.style.display="none",inputElement.classList.remove("is-invalid"),!0;try{/^https?:\/\//i.test(url)||(url="https://"+url);const parsedURL=new URL(url);return!(!parsedURL.hostname||-1===parsedURL.hostname.indexOf("."))&&(!!["http:","https:"].includes(parsedURL.protocol)&&(!/[<>]/.test(url)&&(!/javascript:/i.test(url)&&!/<script>/i.test(url))))}catch(e){return!1}},setExternalLink:function(id,externalLink){const errorElement=document.getElementById("external-link-error"),inputElement=document.getElementById("learningmap-external-link");if(!externalLink||""===externalLink.trim())return errorElement.style.display="none",inputElement.classList.remove("is-invalid"),!0;if(errorElement.style.display="none",inputElement.classList.remove("is-invalid"),!this.isValidURL(externalLink))return errorElement.style.display="block",inputElement.classList.add("is-invalid"),!1;let place=this.places.find((e=>e.id===id));return place&&(place.externalLink=externalLink),!0},getExternalLink:function(id){let place=this.places.find((e=>e.id===id));return place?place.externalLink:null},setSelectedLinkType:function(id,selectedLinkType){let place=this.places.find((e=>e.id===id));place&&(place.selectedLinkType=selectedLinkType)},setColor:function(type,color){switch(type){case"stroke":this.strokecolor=color;break;case"place":this.placecolor=color;break;case"visited":this.visitedcolor=color;break;case"text":this.textcolor=color}},getColor:function(type){switch(type){case"stroke":return this.strokecolor;case"place":return this.placecolor;case"visited":return this.visitedcolor;case"text":return this.textcolor}return null},getId:function(){return this.id},setBackgroundDimensions:function(width,height){this.width=width,this.height=height},getPathsWithFid:function(id){return this.paths.filter((function(p){return p.fid==id}))},getPathsWithSid:function(id){return this.paths.filter((function(p){return p.sid==id}))},getPlacestore:function(){return{id:this.id,places:this.places,paths:this.paths,startingplaces:this.startingplaces,targetplaces:this.targetplaces,placecolor:this.placecolor,strokecolor:this.strokecolor,strokeopacity:this.strokeopacity,textcolor:this.textcolor,visitedcolor:this.visitedcolor,height:this.height,width:this.width,hidepaths:this.hidepaths,mapid:this.mapid,usecheckmark:this.usecheckmark,editmode:this.editmode,version:this.version,pulse:this.pulse,hover:this.hover,showall:this.showall,showtext:this.showtext,slicemode:this.slicemode,showwaygone:this.showwaygone}},setHidePaths:function(value){this.hidepaths=value},getHidePaths:function(){return this.hidepaths},setPulse:function(value){this.pulse=value},getPulse:function(){return this.pulse},setHover:function(value){this.hover=value},getHover:function(){return this.hover},setShowall:function(value){this.showall=value},getShowall:function(){return this.showall},getMapid:function(){return this.mapid},getUseCheckmark:function(){return this.usecheckmark},setUseCheckmark:function(value){this.usecheckmark=value},getAllActivities:function(){let activities=[];return this.places.forEach((function(p){p.linkedActivity&&activities.push(p.linkedActivity)})),activities},setStrokeOpacity:function(value){this.strokeopacity=value},getStrokeOpacity:function(){return this.strokeopacity},setHideStroke:function(value){this.strokeopacity=value?0:1},getHideStroke:function(){return this.strokeopacity<1},getShowText:function(){return this.showtext},setShowText:function(value){this.showtext=value},getPlaces:function(){return this.places},getSliceMode:function(){return this.slicemode},setSliceMode:function(value){this.slicemode=value},getShowWayGone:function(){return this.showwaygone},setShowWayGone:function(value){this.showwaygone=value}};var _default=placestore;return _exports.default=_default,_exports.default}));

//# sourceMappingURL=placestore.min.js.map