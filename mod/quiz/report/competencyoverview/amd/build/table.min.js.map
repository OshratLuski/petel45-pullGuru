{"version":3,"file":"table.min.js","sources":["../src/table.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Some UI stuff for table.\n *\n * @package\n * @copyright  2020 Devlion <info@devlion.co>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n * @author     Devlion Moodle Development <service@devlion.co>\n */\n\ndefine([\n    \"jquery\",\n    \"jqueryui\",\n    \"core/modal_factory\",\n    \"core/modal_events\",\n    \"core/ajax\",\n    \"core/str\",\n    \"community_social/loadingSpinner\",\n], function($, jqui, ModalFactory, ModalEvents, Ajax, Str, loading) {\n\n    let actualusers = '';\n\n    return {\n        load: function (quizid, cmid, courseid, lastaccess, _actualusers) {\n            actualusers = _actualusers;\n            Ajax.call([\n                {\n                    methodname: \"quiz_competencyoverview_get_init_params\",\n                    args: {\n                        'quizid': quizid,\n                        'cmid': cmid,\n                        'courseid': courseid,\n                        'lastaccess': lastaccess,\n                    },\n                    done: params => {\n\n                        params = JSON.parse(params.params);\n\n                        let hlfilterranges = params.hlfilterranges;\n                        let hlfilterrangescolor = params.hlfilterrangescolor;\n                        let assign = params.assign;\n                        let users = params.users;\n                        let currentcourseid = params.courseid;\n                        let topskills = params.topskills;\n                        let _quizid = params.quizid;\n                        let _cmid = params.cmid;\n                        let complist = params.complist;\n                        let _lastaccess = params.lastaccess;\n\n                        this.init(\n                            hlfilterranges, hlfilterrangescolor, assign, users, currentcourseid,\n                            topskills, _quizid, _cmid, complist, _lastaccess\n                        );\n                    },\n                    fail: {}\n                }\n            ]);\n        },\n\n        init: function(\n            hlfilterranges, hlfilterrangescolor, assign, users, currentcourseid,\n            topskills, quizid, cmid, complist, lastaccess\n        ) {\n\n            let langStrings = [];\n            let strings = [\n                {\n                    key: 'task_from_course',\n                    component: 'quiz_competencyoverview'\n                },\n                {\n                    key: 'recommended_task_from_shared_repository',\n                    component: 'quiz_competencyoverview'\n                },\n                {\n                    key: 'message_to_students_place',\n                    component: 'quiz_competencyoverview'\n                },\n                {\n                    key: 'only_to_stud',\n                    component: 'quiz_competencyoverview'\n                },\n                {\n                    key: 'more',\n                    component: 'quiz_competencyoverview'\n                },\n                {\n                    key: 'sending',\n                    component: 'quiz_competencyoverview'\n                },\n                {\n                    key: 'title_aa',\n                    component: 'quiz_competencyoverview'\n                },\n                {\n                    key: 'selection',\n                    component: 'quiz_competencyoverview'\n                },\n                {\n                    key: 'course_name',\n                    component: 'quiz_competencyoverview'\n                },\n                {\n                    key: 'activity',\n                    component: 'quiz_competencyoverview'\n                },\n                {\n                    key: 'recommend_activity_list',\n                    component: 'quiz_competencyoverview'\n                },\n                {\n                    key: 'recommend_activity_view',\n                    component: 'quiz_competencyoverview'\n                },\n                {\n                    key: 'target_section',\n                    component: 'quiz_competencyoverview'\n                },\n                {\n                    key: 'message_to_students_place_edit',\n                    component: 'quiz_competencyoverview'\n                },\n                {\n                    key: 'message_to_students_place_view',\n                    component: 'quiz_competencyoverview'\n                },\n                {\n                    key: 'ok',\n                    component: 'quiz_competencyoverview'\n                },\n                {\n                    key: 'finish',\n                    component: 'quiz_competencyoverview'\n                },\n                {\n                    key: 'submit',\n                    component: 'quiz_competencyoverview'\n                },\n                {\n                    key: 'back',\n                    component: 'quiz_competencyoverview'\n                },\n                {\n                    key: 'stud_list',\n                    component: 'quiz_competencyoverview'\n                },\n                {\n                    key: 'default_section_name',\n                    component: 'quiz_competencyoverview'\n                },\n                {\n                    key: 'selectall',\n                    component: 'core'\n                },\n                {\n                    key: 'deselectall',\n                    component: 'core'\n                },\n                {\n                    key: 'competency_list_title',\n                    component: 'quiz_competencyoverview'\n                }\n            ];\n\n            $('#user-action').prop('disabled', true);\n\n            Str.get_strings(strings).then(function(results) {\n                langStrings = results;\n            });\n\n            // HL coloring.\n            $(\".skill-grade-cell\").each(function() {\n                let skillgrade = $(this).data(\"skill-grade\");\n                let cell = $(this);\n                $.each(hlfilterrangescolor, function(index, value) {\n                    if (skillgrade >= value[0] && skillgrade <= value[1]) {\n                        cell.closest(\"td\").addClass(value[3], 200);\n                    }\n                });\n            });\n\n            // Selected users. Assign activities (AA).\n\n            $(document).on(\"click\", \".selected-users\", function() {\n                actionStatus();\n                setskills();\n            });\n\n            $(document).on(\"click\", \"#user-action\", function(e) {\n                e.preventDefault();\n                useraction();\n            });\n\n            let selectedusers = [];\n            let currentstate;\n            let selectedsource;\n            let selectedcourse;\n            let selectedactivity;\n            let selecteditem;\n            let selectedtargetsection;\n            let messagetostudents;\n            let modalbody;\n            let aastates;\n            let flow = [];\n\n            let submitted = false;\n            let sentusers = [];\n\n            let selectedskills = [];\n\n            let skillname = '';\n\n            let selectall = true;\n            let rows = [];\n            let ranges = [];\n\n            /**\n             *\n             */\n            function redrawMain() {\n                let mainbody = \"\";\n                switch (currentstate) {\n                    case \"selection\":\n                        $('.progress-bar-item').removeClass('active');\n                        $('.progress-bar-item').eq(0).addClass('active');\n                        mainbody = `\n                            <div class='d-flex mt-100'>\n                            <button id='aa_source_course' type=\"button\" class='aa_h select_source btn-lg btn-block mr-20'>\n                            ` + langStrings[0] + `</button>\n                            <button id='aa_source_repository' type=\"button\" class='aa_h select_source btn-lg btn-block'>\n                            ` + langStrings[1] + `</button>\n                            </div>\n                            `;\n                        break;\n                    case \"course\":\n                        $('.progress-bar-item').removeClass('active');\n                        $('.progress-bar-item').eq(1).addClass('active');\n                        mainbody = \"\";\n                        getCourses();\n                        break;\n                    case \"activity\":\n                        $('.progress-bar-item').removeClass('active');\n                        $('.progress-bar-item').eq(2).addClass('active');\n                        mainbody = \"\";\n                        getActivities(selectedcourse);\n                        break;\n                    case \"repository\":\n                        $('.progress-bar-item').removeClass('active');\n                        $('.progress-bar-item').eq(1).addClass('active');\n                        mainbody = \"\";\n                        getItems();\n                        break;\n                    case \"item\":\n                        $('.progress-bar-item').removeClass('active');\n                        $('.progress-bar-item').eq(1).addClass('active');\n                        mainbody = \"\";\n                        getItem();\n                        break;\n                    case \"targetsection\":\n                        $('.progress-bar-item').removeClass('active');\n                        $('.progress-bar-item').eq(2).addClass('active');\n                        mainbody = \"\";\n                        getTargetsections();\n                        break;\n                    case \"message\":\n                        $('.progress-bar-item').removeClass('active');\n                        $('.progress-bar-item').eq(3).addClass('active');\n                        mainbody = `\n                            <div class=\"input-group\">\n                            <textarea id=\"messagetostudents\" class=\"form-control\" rows=\"5\" aria-label=\"\"\n                            placeholder=\"` + langStrings[2] + `\"></textarea>\n                            </div>\n                            `;\n                        break;\n                    case \"finish\":\n                        $('.progress-bar-item').removeClass('active');\n                        $('.progress-bar-item').eq(3).addClass('active');\n                        $('#aa_st_list').css(\"visibility\", \"visible\");\n                        mainbody =\n                            `\n                            <div id=\"aa_finish\" class=\"\">\n                            <div class=\"alert alert-info\" role=\"alert\">\n                            <p>` + langStrings[3] + `</p>\n                            </div>\n                            <div class=\"\">\n                            <div class=\"text-muted muted\">` +\n                            messagetostudents +\n                            `</div>\n                            </div>\n                            </div>\n                            `;\n                        break;\n                    default:\n                        break;\n                }\n                $(\"#aa_main\").html(mainbody);\n                $(\"#aa_main\").css(\"visibility\", \"visible\");\n\n                $(\"#backbtn\").off(\"click\");\n                $(\"#backbtn\").on(\"click\", () => {\n                    switchState(flow.pop(), true);\n                });\n\n                if (aastates[currentstate].nextButton) {\n                    $(\"#nextbtn\").addClass(\"d-none\");\n                    if (aastates[currentstate].nextButtonEnabled) {\n                        $(\"#nextbtn\").removeClass(\"d-none\");\n                    }\n                    $(\"#nextbtn\").text(aastates[currentstate].nextButtonText);\n                } else {\n                    $(\"#nextbtn\").addClass(\"d-none\");\n                }\n\n                $(\"#nextbtn\").off(\"click\");\n                $(\"#nextbtn\").on(\"click\", () => {\n                    if (!submitted) {\n                        switchState(aastates[currentstate].nextAction);\n                    }\n                    if ($(\"#nextbtn\").data('finished') == 'true') {\n                        submitted = false;\n                        mainmodal.hide();\n                    }\n\n                });\n\n                $(\".select_source\").off(\"click\");\n                $(\".select_source\").on(\"click\", e => {\n                    switch (e.target.id) {\n                        case \"aa_source_course\":\n                            selectedsource = \"course\";\n                            switchState(\"course\");\n                            break;\n                        case \"aa_source_repository\":\n                            selectedsource = \"repository\";\n                            switchState(\"repository\");\n                            break;\n                        default:\n                            break;\n                    }\n                });\n\n                $(\"#aa_bk\").html(aastates[currentstate].title);\n                if (aastates[currentstate].nextButton) {\n                    $(\"#nextbtn\").value = aastates[currentstate].nextButtonText;\n                }\n                if (aastates[currentstate].backButton) {\n                    $(\"#backbtn\").css(\"visibility\", \"visible\");\n                } else {\n                    $(\"#backbtn\").css(\"visibility\", \"hidden\");\n                }\n                $(\"#aa_main_col\").fadeIn(\"slow\");\n\n                // Hlsentdusers();\n\n            }\n\n            /**\n             * @param state\n             * @param back\n             */\n            function switchState(state, back = false) {\n                if (state == \"submit\") {\n                    aaSubmit();\n                    return;\n                }\n                if (!back) {\n                    flow.push(currentstate);\n                }\n                if (currentstate == \"message\") {\n                    messagetostudents = $(\"#messagetostudents\").val();\n                }\n                $(\"#aa_main_col\").hide();\n                currentstate = state;\n                redrawMain();\n            }\n\n            /**\n             *\n             */\n            function hlsentdusers() {\n                $(\"#mod-quiz-report-competencyoverview-report-table tbody tr\")\n                    .not(\".emptyrow\")\n                    .not(\".gradedattempt\")\n                    .each(function() {\n                        if ($.inArray($(this)[0].cells[0].children[0].dataset.selectedUserid, sentusers) != -1) {\n                            this.firstElementChild.classList.add('sent');\n                        }\n                    });\n            }\n\n            /**\n             *\n             */\n            function aaSubmit() {\n\n                submitted = true;\n\n                $(\"#backbtn\").css(\"visibility\", \"hidden\");\n\n                $('.progress-bar-item').removeClass('active');\n                $('.progress-bar-item').eq(4).addClass('active');\n                $('#aa_st_list').css(\"visibility\", \"hidden\");\n                $(\"#aa_main\").html(`\n                <div class = \"bravo-img-wrapper mr-auto\">\n                  <h2>` + langStrings[5] + `</h2>\n                  <div class=\"img-background\"\n                    style=\"background-image: url('${M.cfg.wwwroot}/mod/quiz/report/competencyoverview/pix/bravo.png')\"\n                  </div>\n                </div>\n                `);\n\n                let selectedusersjoin = selectedusers.join();\n\n                Ajax.call([\n                    {\n                        methodname: \"quiz_competencyoverview_submit_assignment\",\n                        args: {\n                            'selectedusersjoin': selectedusersjoin,\n                            'selectedsource': selectedsource,\n                            'selectedcourse': selectedcourse ? selectedcourse : 0,\n                            'selectedactivity': selectedactivity ? selectedactivity : 0,\n                            'selecteditem': selecteditem ? selecteditem : 0,\n                            'selectedtargetsection': selectedtargetsection,\n                            'messagetostudents': messagetostudents,\n                            'currentcourseid': currentcourseid,\n                        },\n                        done: () => {\n                            selectedusers.forEach(element => {\n                                sentusers.push(element.toString());\n                            });\n                            hlsentdusers();\n                            $(\"#nextbtn\").data('finished', 'true');\n                            return;\n                        },\n                        fail: {}\n                    }\n                ]);\n            }\n\n            /**\n             *\n             */\n            function getCourses() {\n                Ajax.call([\n                    {\n                        methodname: \"quiz_competencyoverview_get_courses\",\n                        args: {},\n                        done: courses => {\n                            let courseslist = JSON.parse(courses.courses);\n                            let list =\n                                '<div class=\"aa_scroll\"><div id=\"aa_course_list\" class=\"list-group list-group-flush\">';\n                            for (let key in courseslist) {\n                                list +=\n                                    `<a href=\"#\" class=\"aa_course list-group-item\"\n                                    data-selectedcourseid=` + courseslist[key].id +\n                                    \">\" +\n                                    courseslist[key].shortname;\n                                list +=\n                                    '&nbsp<span class=\"text-muted aa_modname\">' +\n                                    courseslist[key].fullname +\n                                    \"</span>\";\n                                list += \"</a>\";\n                            }\n                            list += \"</div></div>\";\n                            $(\"#aa_main\").html(list);\n\n                            // TODO Refactor.\n                            $(\"#aa_course_list a\").on(\"click\", function(e) {\n                                e.preventDefault();\n                                Array.prototype.forEach.call($(\"#aa_course_list a\"), a => {\n                                    $(a).removeClass(\"active\");\n                                });\n                                selectedcourse = $(this).data(\"selectedcourseid\");\n                                $(\"#nextbtn\").removeClass(\"d-none\");\n                                $(\"#nextbtn\").css(\"visibility\", \"visible\");\n                                $(this).toggleClass(\"active\");\n                            });\n\n                            $(\"#aa_course_list a\").on(\"dblclick\", function(e) {\n                                e.preventDefault();\n                                Array.prototype.forEach.call($(\"#aa_course_list a\"), a => {\n                                    $(a).removeClass(\"active\");\n                                });\n                                selectedcourse = $(this).data(\"selectedcourseid\");\n                                $(\"#nextbtn\").removeClass(\"d-none\");\n                                $(\"#nextbtn\").css(\"visibility\", \"visible\");\n                                $(this).toggleClass(\"active\");\n\n                                switchState(aastates[currentstate].nextAction);\n                            });\n                        },\n                        fail: {}\n                    }\n                ]);\n            }\n\n            /**\n             * @param courseid\n             */\n            function getActivities(courseid) {\n                Ajax.call([\n                    {\n                        methodname: \"quiz_competencyoverview_get_activities\",\n                        args: {courseid: courseid},\n                        done: activities => {\n                            let activitieslist = JSON.parse(activities.activities);\n                            let list =\n                                '<div class=\"aa_scroll\"><div id=\"aa_activity_list\" class=\"list-group list-group-flush\">';\n                            for (let key in activitieslist) {\n                                list +=\n                                    `<a href=\"#\" class=\"aa_activity list-group-item list-group-item-secondary\"\n                                    data-selectedactivityid=` + activitieslist[key].id +\n                                    \">\" +\n                                    activitieslist[key].shortname;\n                                list +=\n                                    '&nbsp<span class=\"text-muted aa_modname\">' +\n                                    activitieslist[key].modname +\n                                    \"</span>\";\n                                list += \"</a>\";\n                            }\n                            list += \"</div></div>\";\n                            $(\"#aa_main\").html(list);\n\n                            // TODO Refactor.\n                            $(\"#aa_activity_list a\").on(\"click\", function(e) {\n                                e.preventDefault();\n                                Array.prototype.forEach.call($(\"#aa_activity_list a\"), a => {\n                                    $(a).removeClass(\"active\");\n                                });\n                                selectedactivity = $(this).data(\"selectedactivityid\");\n                                $(\"#nextbtn\").removeClass(\"d-none\");\n                                $(\"#nextbtn\").css(\"visibility\", \"visible\");\n                                $(this).toggleClass(\"active\");\n                            });\n                            $(\"#aa_activity_list a\").on(\"dblclick\", function(e) {\n                                e.preventDefault();\n                                Array.prototype.forEach.call($(\"#aa_activity_list a\"), a => {\n                                    $(a).removeClass(\"active\");\n                                });\n                                selectedactivity = $(this).data(\"selectedactivityid\");\n                                $(\"#nextbtn\").removeClass(\"d-none\");\n                                $(\"#nextbtn\").css(\"visibility\", \"visible\");\n                                $(this).toggleClass(\"active\");\n\n                                switchState(aastates[currentstate].nextAction);\n                            });\n                        },\n                        fail: {}\n                    }\n                ]);\n            }\n\n            /**\n             *\n             */\n            function getItems() {\n                loading.show();\n                Ajax.call([\n                    {\n                        methodname: \"quiz_competencyoverview_get_items\",\n                        args: {\n                            'skills': selectedskills.join(),\n                        },\n                        done: items => {\n                            loading.remove();\n                            let itemslist = JSON.parse(items.items);\n                            let list =\n                                `<div class=\"aa_scroll\">\n                                    <div id=\"aa_item_list\" class=\"list-group list-group-flush px-2\">`;\n                            for (let key in itemslist) {\n\n                                list += '<div class=\"js--cardgroup_title cardgroup_title\"><span class=\"carret-down\"></span>'\n                                    + itemslist[key][0] + '</div><div class=\"card_wrapper\">';\n                                for (let key2 in itemslist[key][1]) {\n                                    list += itemslist[key][1][key2].item;\n                                }\n                                list = list.replaceAll('mx-3', '');\n                                list = list.replaceAll('flex-xl-nowrap', '');\n                                list += \"</div>\";\n                            }\n                            list += \"</div></div>\";\n                            $(\"#aa_main\").html(list);\n                            $('.js--cardgroup_title').click(function() {\n                                $(this).toggleClass('active');\n                                $(this).next().slideToggle();\n                            });\n                            $('.quiz_competencyoverview-select-button').off('click');\n                            $('.quiz_competencyoverview-select-button').on('click', e => {\n                                selecteditem = $(e.target).data('activity_id');\n                                selectedcourse = $(e.target).data('course_id');\n                                switchState(aastates[currentstate].nextAction);\n                            });\n                        },\n                        fail: {}\n                    }\n                ]);\n            }\n\n            /**\n             *\n             */\n            function getItem() {\n                Ajax.call([\n                    {\n                        methodname: \"quiz_competencyoverview_get_item\",\n                        args: {'itemid': selecteditem},\n                        done: item => {\n                            let itemone = JSON.parse(item.item);\n                            let list =\n                                '<div class=\"aa_scroll\"><div id=\"aa_item_list\" class=\"list-group list-group-flush\">';\n                            list += itemone;\n                            list += \"</div></div>\";\n                            $(\"#aa_main\").html(list);\n                            $('#nextbtn').removeClass('d-none');\n                            $(\"#nextbtn\").css(\"visibility\", \"visible\");\n                        },\n                        fail: {}\n                    }\n                ]);\n            }\n\n            /**\n             *\n             */\n            function getTargetsections() {\n                Ajax.call([\n                    {\n                        methodname: \"quiz_competencyoverview_get_targetsections\",\n                        args: {currentcourseid},\n                        done: targetsections => {\n                            let targetsectionslist = JSON.parse(targetsections.sections);\n                            let imgurl = targetsections.imgurl;\n                            let coursename = targetsections.coursename;\n                            let list =\n                                `<div class=\"coursename-wrapper\">\n                                <div class=\"coursename-image\">\n                                <img src=\"${imgurl}\" width=\"auto\" height=\"auto\"/>\n                                </div>\n                                <h3 class=\"coursename\">${coursename}</h3>\n                                </div>\n                                <div class=\"aa_scroll\"><div id=\"aa_targetsection_list\"\n                                class=\"list-group list-group-flush\">`;\n                            for (let key in targetsectionslist) {\n                                let sectionline =\n                                    targetsectionslist[key].name ? targetsectionslist[key].name :\n                                        langStrings[20] + ' ' + targetsectionslist[key].section;\n                                list +=\n                                    `<a href=\"#\" class=\"aa_targetsection list-group-item list-group-item-secondary\"\n                                    data-selectedtargetsectionid=` +\n                                    targetsectionslist[key].id +\n                                    \">\" +\n                                    sectionline;\n                                list += \"</a>\";\n                            }\n                            list += \"</div></div>\";\n                            $(\"#aa_main\").html(list);\n                            if (imgurl === null) {\n                                $('.coursename-image').remove();\n                            }\n\n                            // TODO Refactor.\n                            $(\"#aa_targetsection_list a\").on(\"click\", function(e) {\n                                e.preventDefault();\n                                Array.prototype.forEach.call($(\"#aa_targetsection_list a\"), a => {\n                                    $(a).removeClass(\"active\");\n                                });\n                                selectedtargetsection = $(this).data(\"selectedtargetsectionid\");\n                                $(\"#nextbtn\").removeClass(\"d-none\");\n                                $(\"#nextbtn\").css(\"visibility\", \"visible\");\n                                $(this).toggleClass(\"active\");\n                            });\n\n                            $(\"#aa_targetsection_list a\").on(\"dblclick\", function(e) {\n                                e.preventDefault();\n                                Array.prototype.forEach.call($(\"#aa_targetsection_list a\"), a => {\n                                    $(a).removeClass(\"active\");\n                                });\n                                selectedtargetsection = $(this).data(\"selectedtargetsectionid\");\n                                $(\"#nextbtn\").removeClass(\"d-none\");\n                                $(\"#nextbtn\").css(\"visibility\", \"visible\");\n                                $(this).toggleClass(\"active\");\n\n                                switchState(aastates[currentstate].nextAction);\n                            });\n\n                        },\n                        fail: {}\n                    }\n                ]);\n            }\n\n            let mainmodal;\n\n            /**\n             *\n             */\n            function useraction() {\n                // Popup (AA) states.\n                initAa();\n                ModalFactory.create({\n                    title:\n                        langStrings[6],\n                    body: modalbody,\n                    large: true\n                }).then(function(aamodal) {\n                    mainmodal = aamodal;\n                    let aaroot = aamodal.getRoot();\n                    aaroot.on(ModalEvents.hidden, function() {\n                        aamodal.destroy();\n                        return;\n                    });\n                    aamodal.getRoot().addClass('competencies_wizard');\n                    aamodal.show();\n                    redrawMain();\n                        return;\n                    }).catch();\n            }\n\n            /**\n             *\n             */\n            function initAa() {\n                aastates = {\n                    selection: {\n                        backButton: false,\n                        nextButton: false,\n                        nextButtonEnabled: false,\n                        nextButtonText: false,\n                        scroll: false,\n                        parent: false,\n                        nextAction: false,\n                        title: langStrings[7]\n                    },\n                    course: {\n                        backButton: true,\n                        nextButton: true,\n                        nextButtonEnabled: false,\n                        nextButtonText: langStrings[15],\n                        scroll: true,\n                        parent: \"selection\",\n                        nextAction: \"activity\",\n                        title: langStrings[8]\n                    },\n                    activity: {\n                        backButton: true,\n                        nextButton: true,\n                        nextButtonEnabled: false,\n                        nextButtonText: langStrings[15],\n                        scroll: true,\n                        parent: \"course\",\n                        nextAction: \"targetsection\",\n                        title: langStrings[9]\n                    },\n                    repository: {\n                        backButton: true,\n                        nextButton: false,\n                        nextButtonEnabled: false,\n                        nextButtonText: false,\n                        scroll: true,\n                        parent: \"selection\",\n                        nextAction: \"item\",\n                        title: langStrings[10]\n                    },\n                    item: {\n                        backButton: true,\n                        nextButton: true,\n                        nextButtonEnabled: true,\n                        nextButtonText: langStrings[15],\n                        scroll: false,\n                        parent: \"repository\",\n                        nextAction: \"targetsection\",\n                        title: langStrings[11]\n                    },\n                    targetsection: {\n                        backButton: true,\n                        nextButton: true,\n                        nextButtonEnabled: false,\n                        nextButtonText: langStrings[15],\n                        scroll: true,\n                        parent: \"selection\",\n                        nextAction: \"message\",\n                        title: langStrings[12]\n                    },\n                    message: {\n                        backButton: true,\n                        nextButton: true,\n                        nextButtonEnabled: true,\n                        nextButtonText: langStrings[15],\n                        scroll: false,\n                        parent: \"selection\",\n                        nextAction: \"finish\",\n                        title: langStrings[13]\n                    },\n                    finish: {\n                        backButton: true,\n                        nextButton: true,\n                        nextButtonEnabled: true,\n                        nextButtonText: langStrings[16],\n                        scroll: false,\n                        parent: \"selection\",\n                        nextAction: \"submit\",\n                        title: langStrings[14]\n                    }\n                };\n                currentstate = \"selection\";\n                messagetostudents = \"\";\n                let userslist = \"\";\n                selectedusers.forEach(element => {\n                    userslist += \"<li class='p-2'>\" + users[element].firstname\n                        + ' ' + users[element].lastname + '</li>';\n                });\n\n                setskills();\n\n                let selcomplist = [];\n                selectedskills.forEach(element => {\n                    selcomplist.push(complist[element]);\n                });\n\n                modalbody =\n                    `\n                    <div class='custom_container container'>\n                    <div id='assign_activity_body' class='row'>\n\n                    <div id='aa_main_col' class='col-8 d-flex flex-column justify-content-start'>\n\n                    <div class=\"progress-bar-wrapper\">\n                    <div class=\"progress-bar\">\n                    </div>\n                    <div class=\"progress-bar-item active\">1</div>\n                    <div class=\"progress-bar-item\">2</div>\n                    <div class=\"progress-bar-item\">3</div>\n                    <div class=\"progress-bar-item\">4</div>\n                    <div class=\"progress-bar-item\">5</div>\n\n                    </div>\n\n                    <div id='aa_bk' class=''>\n\n                    </div>\n                    <div id='aa_main' class='d-flex justify-content-center flex-grow-1 overflow-hidden\n                        flex-wrap' style='visibility: hidden;'>\n\n                    </div>\n                    <div id='aa_actions' style='visibility: hidden;' class='d-flex mt-5'>\n                    <button id='backbtn' class=\"btn btn-secondary competencies_wizard-button \n                    competencies_wizard-button-outline mr-20\">`\n                        + langStrings[18] + `</button>\n                    <button id='nextbtn' class=\"btn btn-primary competencies_wizard-button d-none\">` + langStrings[16] + `</button>\n                    </div>\n                    </div>\n\n                    <div id='aa_st_list' class='col-4'>\n                    <div class=\"competency-popup-subtitle\">\n                    <h3>` + langStrings[23] + `</h3>\n                    <p class=\"competency-list\">` + selcomplist.join(' | ') + `</p>\n                    </div>\n                    <h3 class=''>` + langStrings[19] + `</h3>\n                    <ul class=\"aa_scroll_students m-l-0 list-group list-group-flush\">\n                    ` +\n                    userslist +\n                    `\n                    </ul>\n                    </div>\n\n                    </div>\n                    </div>\n                    `;\n            }\n\n            /**\n             *\n             */\n            function actionStatus() {\n                selectedusers = [];\n                $(\".selected-users\").each(function() {\n                    if ($(this).closest(\"input\")[0].checked) {\n                        selectedusers.push(\n                            $(this)\n                                .closest(\"input\")\n                                .data(\"selected-userid\")\n                        );\n                    }\n                });\n                if (selectedusers.length != 0 && selectedskills.length != 0) {\n                    $(\"#user-action\").html(\n                        assign + \" | \" + selectedusers.length\n                    );\n                    $('#user-action').prop('disabled', false);\n                } else {\n                    $(\"#user-action\").html(\n                        assign\n                    );\n                    $('#user-action').prop('disabled', true);\n                }\n            }\n\n            // Select all.\n            $(\"#selectallstudents\").on(\"click\", (e) => {\n                e.preventDefault();\n                resetfilters();\n                setskills();\n                selectallstudents();\n                actionStatus();\n            });\n\n            // Select skills.\n            $(\".selected-comp\").on(\"click\", () => {\n                setskills();\n                actionStatus();\n            });\n\n            /**\n             *\n             */\n            function selectallstudents() {\n                $(\".selected-users\").each(function() {\n                    $(this).closest(\"input\")[0].checked = selectall;\n                });\n                let selecttitle = selectall ? langStrings[22] : langStrings[21];\n                $('#selectallstudents').html(selecttitle);\n                selectall = !selectall;\n            }\n\n            /**\n             *\n             */\n            function setskills() {\n                selectedskills = [];\n                $(\".selected-comp\").each(function() {\n                    if ($(this)[0].checked) {\n                        if ($(this)[0].dataset.compid !== undefined) {\n                            selectedskills.push($(this)[0].dataset.compid);\n                        }\n                    }\n                });\n            }\n\n            // Filters.\n            /**\n             * @param all\n             */\n            function resetfilters(all = true) {\n\n                rows = [];\n                ranges = [];\n\n                $(\"#mod-quiz-report-competencyoverview-report-table tbody tr\")\n                    .not(\".emptyrow\")\n                    .not(\".gradedattempt\")\n                    .each(function() {\n                        $(this).show(200); // Reset table view - show all rows.\n                    });\n            }\n\n            $(document).on(\"click\", \"#resetfilters\", function(e) {\n                e.preventDefault();\n                resetfilters(true);\n                selectall = false;\n                selectallstudents();\n                actionStatus();\n            });\n\n            ranges = [];\n            rows = [];\n\n            $(document).on(\"click\", \".selected-ranges\", function(e) {\n                e.preventDefault();\n\n                resetfilters(true);\n\n                let r = $(this).data('range');\n                skillname = $(this).closest(\"div\")[0].dataset.skill;\n                ranges.push({\n                    skillname: skillname,\n                    range: r,\n                });\n\n                if (ranges.length != 0) {\n                    $(\"#resetfilters\").fadeIn(\"slow\");\n                    ranges.forEach(range => {\n                        $(\"#mod-quiz-report-competencyoverview-report-table tbody tr\")\n                            .not(\".emptyrow\")\n                            .not(\".gradedattempt\")\n                            .each(function() {\n                                let description = $(this)\n                                    .find(`[data-skill-name='${range.skillname}']`)\n                                    .data(\"description\");\n                                let skillgrade = $(this)\n                                    .find(`[data-skill-name='${range.skillname}']`)\n                                    .data(\"skill-grade\");\n                                if (\n                                    skillgrade >= hlfilterranges[range.range][0] &&\n                                    skillgrade <= hlfilterranges[range.range][1]\n                                ) {\n\n                                    if (rows[description] === undefined) {\n                                        rows[description] = skillgrade;\n                                    }\n                                }\n                            });\n                    });\n                    selectall = false;\n                    selectallstudents();\n                    setskills();\n\n                    $(\".selected-users\").each(function() {\n\n                        $(\"#mod-quiz-report-competencyoverview-report-table tbody tr\")\n                            .not(\".emptyrow\")\n                            .not(\".gradedattempt\")\n                            .each(function() {\n                                let _name = $(this).find(`[data-skill-name='${skillname}']`).data(\"description\");\n                                if (\n                                    rows.hasOwnProperty(\n                                        _name\n                                    )\n                                ) {\n                                    $(this)[0].cells[0].firstChild.checked = true;\n                                }\n                            });\n\n                    });\n                    actionStatus();\n\n                } else {\n                    skillname = '';\n                    resetfilters(true);\n                    selectall = false;\n                    selectallstudents();\n                    setskills();\n                    actionStatus();\n                }\n\n            });\n\n            $(document).on(\"click\", \".questionsbycompetency\", function(e) {\n                e.preventDefault();\n\n                let compid = $(this).data(\"compid\");\n                let qset = $(this).data(\"qset\");\n                let comptitle = $(this).data(\"comptitle\");\n\n                loading.show();\n\n                getQuestionsByCompetencyTable(compid, cmid, quizid, currentcourseid, qset, comptitle);\n\n            });\n\n            /**\n             * @param compid\n             * @param cmid\n             * @param quizid\n             * @param courseid\n             * @param qset\n             * @param comptitle\n             */\n            function getQuestionsByCompetencyTable(compid, cmid, quizid, courseid, qset, comptitle) {\n\n                Ajax.call([\n                    {\n                        methodname: \"quiz_competencyoverview_get_questions_by_competency_table\",\n                        args: {\n                            'compid': compid,\n                            'cmid': cmid,\n                            'quizid': quizid,\n                            'courseid': courseid,\n                            'qset': qset,\n                            'lastaccess': lastaccess,\n                            'actualusers': actualusers,\n                        },\n                        done: items => {\n                            loading.remove();\n                            items = JSON.parse(items.questionstable);\n\n                            $('#modalquestions').html(items);\n                            $('#questionsbycompetencymodalTitle').html(comptitle);\n                            $('#questionsbycompetencymodal').modal();\n\n                        },\n                        fail: {}\n                    }\n                ]);\n            }\n\n            let order = false;\n\n            $(document).on(\"click\", \"a.sortcol\", function(e) {\n                e.preventDefault();\n                let colid = $(this).data(\"colid\");\n\n                sortTable(colid, order);\n                order = !order;\n            });\n\n            /**\n             * @param colid\n             * @param order\n             */\n            function sortTable(colid, order) {\n                let rows = $(\"#mod-quiz-report-competencyoverview-report-table tbody tr\")\n                    .not(\".emptyrow\")\n                    .not(\".gradedattempt\")\n                    .get();\n                let A, B;\n                rows.sort(function(a, b) {\n                    if (colid == 0) {\n                        if (order) {\n                            A = $(a)\n                                .children(\"td\")\n                                .eq(colid)\n                                .text()\n                                .toUpperCase();\n                            B = $(b)\n                                .children(\"td\")\n                                .eq(colid)\n                                .text()\n                                .toUpperCase();\n                        } else {\n                            A = $(b)\n                                .children(\"td\")\n                                .eq(colid)\n                                .text()\n                                .toUpperCase();\n                            B = $(a)\n                                .children(\"td\")\n                                .eq(colid)\n                                .text()\n                                .toUpperCase();\n                        }\n                    } else {\n                        if (order) {\n                            A = $(a)\n                                .children(\"td\")\n                                .eq(colid)\n                                .children(\"div\")\n                                .data(\"skill-grade\");\n                            B = $(b)\n                                .children(\"td\")\n                                .eq(colid)\n                                .children(\"div\")\n                                .data(\"skill-grade\");\n                        } else {\n                            A = $(b)\n                                .children(\"td\")\n                                .eq(colid)\n                                .children(\"div\")\n                                .data(\"skill-grade\");\n                            B = $(a)\n                                .children(\"td\")\n                                .eq(colid)\n                                .children(\"div\")\n                                .data(\"skill-grade\");\n                        }\n                    }\n\n                    if (A < B) {\n                        return -1;\n                    }\n                    if (A > B) {\n                        return 1;\n                    }\n                    return 0;\n                });\n\n                $.each(rows, function(index, row) {\n                    $(\"#mod-quiz-report-competencyoverview-report-table\")\n                        .children(\"tbody\")\n                        .append(row);\n                });\n            }\n            $('label.title').on('click', function() {\n                $(this).closest('.header-inner').toggleClass('checked');\n            });\n\n            $('[data-toggle=\"tooltip\"]').tooltip({\n                placement: 'top',\n                selector: 'div.skill-grade-cell',\n                trigger: 'focus',\n                offset: '20',\n                delay: {\"show\": 500, \"hide\": 100}\n            });\n        }\n    };\n});\n"],"names":["define","$","jqui","ModalFactory","ModalEvents","Ajax","Str","loading","actualusers","load","quizid","cmid","courseid","lastaccess","_actualusers","call","methodname","args","done","params","hlfilterranges","JSON","parse","hlfilterrangescolor","assign","users","currentcourseid","topskills","_quizid","_cmid","complist","_lastaccess","init","fail","langStrings","prop","get_strings","key","component","then","results","each","skillgrade","this","data","cell","index","value","closest","addClass","document","on","actionStatus","setskills","e","preventDefault","aastates","selection","backButton","nextButton","nextButtonEnabled","nextButtonText","scroll","parent","nextAction","title","course","activity","repository","item","targetsection","message","finish","currentstate","messagetostudents","userslist","selectedusers","forEach","element","firstname","lastname","selcomplist","selectedskills","push","modalbody","join","initAa","create","body","large","aamodal","mainmodal","getRoot","hidden","destroy","show","redrawMain","catch","selectedsource","selectedcourse","selectedactivity","selecteditem","selectedtargetsection","flow","submitted","sentusers","skillname","selectall","rows","ranges","mainbody","removeClass","eq","courses","courseslist","list","id","shortname","fullname","html","Array","prototype","a","css","toggleClass","switchState","activities","activitieslist","modname","items","remove","itemslist","key2","replaceAll","click","next","slideToggle","off","target","targetsections","targetsectionslist","sections","imgurl","coursename","sectionline","name","section","pop","text","hide","fadeIn","state","back","val","aaSubmit","M","cfg","wwwroot","selectedusersjoin","toString","not","inArray","cells","children","dataset","selectedUserid","firstElementChild","classList","add","checked","length","selectallstudents","selecttitle","undefined","compid","resetfilters","r","skill","range","description","find","_name","hasOwnProperty","firstChild","qset","comptitle","questionstable","modal","getQuestionsByCompetencyTable","order","colid","A","B","get","sort","b","toUpperCase","row","append","sortTable","tooltip","placement","selector","trigger","offset","delay"],"mappings":"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"}