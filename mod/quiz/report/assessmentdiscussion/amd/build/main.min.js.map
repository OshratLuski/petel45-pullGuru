{"version":3,"file":"main.min.js","sources":["../src/main.js"],"sourcesContent":["/* eslint-disable no-loop-func */\r\n/* eslint-disable no-unused-vars */\r\ndefine([\r\n        'jquery',\r\n        'core/ajax',\r\n        'core/notification',\r\n        'core/str',\r\n        'quiz_assessmentdiscussion/preset',\r\n        'quiz_assessmentdiscussion/render',\r\n        'quiz_assessmentdiscussion/loading',\r\n    ],\r\n    function($, Ajax, Notification, Str, Preset, Render, Loading) {\r\n\r\n        const mainBlock = document.querySelector(`#region-main .block_assessmentdiscussion_report`);\r\n        const dashboardSort = document.querySelector(`#region-main .block_assessmentdiscussion_report #questionSortingDropdown`);\r\n        const dashboardGroup = document.querySelector(`#region-main .block_assessmentdiscussion_report #questionGroupDropdown`);\r\n        const answerSort = document.querySelector(`#region-main .block_assessmentdiscussion_report #answersSortingDropdown`);\r\n\r\n        const changeQuestionListIcon = (qid, state) => {\r\n            $('.question-block-item').each(function() {\r\n                let currentqid = $(this).data('qid');\r\n\r\n                if (Number(currentqid) === Number(qid)) {\r\n                    if (state === true) {\r\n                        $(this).find('.question-block-title-icon').removeClass('d-none');\r\n                    } else {\r\n                        $(this).find('.question-block-title-icon').addClass('d-none');\r\n                    }\r\n                }\r\n            });\r\n        };\r\n\r\n        const changeQuestionInfoIcon = (qid, state) => {\r\n\r\n            let obj = $('.question-head').find('.discussion-state-btn');\r\n            let currentqid = obj.data('qid');\r\n\r\n            if (state === true) {\r\n                obj.addClass('active');\r\n            } else {\r\n                obj.removeClass('active');\r\n            }\r\n        };\r\n\r\n        const createBootstrapAlert = (message, dismissText) => {\r\n            const alert = document.createElement('div');\r\n            alert.className = 'grade-area-block-alert alert alert-warning alert-block fade in show d-flex alert-dismissible border-0 position-absolute';\r\n            alert.setAttribute('role', 'alert');\r\n            alert.setAttribute('data-aria-autofocus', 'true');\r\n\r\n            alert.innerHTML = `\r\n                <div class=\"alert-color-stripe bg-orange\"></div>\r\n                <div class=\"alert-inner d-flex align-items-center p-2\">\r\n                    <i class=\"alert-icon text-body fa-light fa-triangle-exclamation\"></i>\r\n                    <div class=\"alert-text text-body p-1\">\r\n                        ${message}\r\n                    </div>\r\n                    <button type=\"button\" class=\"close\" data-dismiss=\"alert\">\r\n                        <i class=\"fa-light fa-circle-xmark text-body\"></i>\r\n                        <span class=\"sr-only\">${dismissText}</span>\r\n                    </button>\r\n                </div>\r\n            `;\r\n\r\n            $(\".grade-area-block\").after(alert);\r\n        };\r\n\r\n        const changeUrl = () => {\r\n            let preset = Preset.get();\r\n\r\n            let url = '?id=' + preset.cmid + '&mode=assessmentdiscussion&qid=' + preset.qid;\r\n            window.history.pushState(\"\", \"\", url);\r\n        };\r\n\r\n        return {\r\n\r\n            'init': function(def) {\r\n\r\n                // Set default preset.\r\n                def = JSON.parse(def);\r\n                Preset.setDefault(def);\r\n\r\n                // First start.\r\n                changeUrl();\r\n\r\n                Loading.show();\r\n                Render.answers_area(true, function(data) {\r\n                    Loading.remove();\r\n                });\r\n\r\n                mainBlock.addEventListener(`click`, function(event) {\r\n                    let target = event.target;\r\n                    while (target !== mainBlock) {\r\n\r\n                        // Handle dashboard tab.\r\n                        if (target.dataset.handler === `dashboard_tab`) {\r\n                            Loading.show();\r\n\r\n                            Preset.set('dashboard_tab', target.dataset.id);\r\n                            Render.dashboard(function(data) {\r\n                                Preset.set('qid', data.activeqid);\r\n\r\n                                changeUrl();\r\n\r\n                                Render.answers_area(true, function(data) {\r\n                                    Loading.remove();\r\n                                });\r\n                            });\r\n                            return;\r\n                        }\r\n\r\n                        // Handle dashboard group.\r\n                        if (target.dataset.handler === `dashboard_group`) {\r\n                            let value = target.dataset.value;\r\n                            let name = target.dataset.name;\r\n\r\n                            $(dashboardGroup).data('value', value);\r\n                            $(dashboardGroup).data('name', name);\r\n                            $('#questionGroupDropdown').find('span').html(name);\r\n                            $(dashboardGroup).addClass('selected');\r\n\r\n                            Loading.show();\r\n\r\n                            Preset.set('groupid', value);\r\n                            Render.dashboard(function(data) {\r\n                                Preset.set('qid', data.activeqid);\r\n\r\n                                changeUrl();\r\n\r\n                                Render.answers_area(true, function(data) {\r\n                                    Loading.remove();\r\n                                });\r\n                            });\r\n                            return;\r\n                        }\r\n\r\n                        // Handle dashboard sorting.\r\n                        if (target.dataset.handler === `dashboard_sort`) {\r\n                            let value = target.dataset.value;\r\n                            let name = target.dataset.name;\r\n\r\n                            $(dashboardSort).data('value', value);\r\n                            $(dashboardSort).data('name', name);\r\n                            $('#questionSortingDropdown').find('span').html(name);\r\n                            $(dashboardSort).addClass('selected');\r\n\r\n                            Loading.show();\r\n\r\n                            Preset.set('sort_question', value);\r\n                            Render.aside_questions(function(data) {\r\n                                Preset.set('qid', data.activeqid);\r\n\r\n                                changeUrl();\r\n\r\n                                Render.answers_area(true, function(data) {\r\n                                    Loading.remove();\r\n                                });\r\n                            });\r\n                            return;\r\n                        }\r\n\r\n                        // Handle change anonymous.\r\n                        if (target.dataset.handler === `dashboard_anonymous`) {\r\n                            Loading.show();\r\n\r\n                            let checked = 0;\r\n                            if ($(target).is(':checked')) {\r\n                                checked = 1;\r\n                            }\r\n\r\n                            Preset.set('anonymous_mode', checked);\r\n                            Render.attempts_area(function(data) {\r\n                                Loading.remove();\r\n                            });\r\n                        }\r\n\r\n                        // Handle change grades.\r\n                        if (target.dataset.handler === `dashboard_change_grades`) {\r\n\r\n                            let targetgrades = target;\r\n\r\n                            Str.get_strings([\r\n                                {key: 'buttonenablegrades', component: 'quiz_assessmentdiscussion'},\r\n                                {key: 'buttondisablegrades', component: 'quiz_assessmentdiscussion'},\r\n                            ]).done(function (strings) {\r\n\r\n                                Loading.show();\r\n\r\n                                let state = targetgrades.dataset.action;\r\n\r\n                                if (targetgrades.dataset.action === 'enable') {\r\n                                    targetgrades.dataset.action = 'disable';\r\n                                    $(targetgrades).html(strings[1]);\r\n                                    $(targetgrades).removeClass('btn-primary').addClass('btn-secondary');\r\n                                } else {\r\n                                    targetgrades.dataset.action = 'enable';\r\n                                    $(targetgrades).html(strings[0]);\r\n                                    $(targetgrades).removeClass('btn-secondary').addClass('btn-primary');\r\n                                }\r\n\r\n                                let preset = Preset.get();\r\n\r\n                                Ajax.call([{\r\n                                    methodname: 'quiz_assessmentdiscussion_change_grades',\r\n                                    args: {\r\n                                        'cmid': preset.cmid,\r\n                                        'state': state,\r\n\r\n                                    },\r\n                                    done: function(response) {\r\n\r\n                                        let res = JSON.parse(response.data);\r\n\r\n                                        Loading.remove();\r\n                                    },\r\n                                    fail: function(response) {\r\n                                        Loading.remove();\r\n                                        Notification.exception(response);\r\n                                    },\r\n                                }]);\r\n                            })\r\n                        }\r\n\r\n                        // Handle select question.\r\n                        if (target.dataset.handler === `select_question`) {\r\n                            Loading.show();\r\n\r\n                            // Add \"active\".\r\n                            $('.question-block-wrapper .question-block-item').each(function() {\r\n                                $(this).removeClass('active');\r\n                                $(this).attr('data-handler', 'select_question');\r\n                            });\r\n                            $(target).addClass('active');\r\n                            $(target).attr('data-handler', 'disable');\r\n\r\n                            Preset.set('qid', target.dataset.qid);\r\n\r\n                            changeUrl();\r\n\r\n                            Render.answers_area(true, function(data) {\r\n                                Loading.remove();\r\n                            });\r\n                            return;\r\n                        }\r\n\r\n                        // Handle answers tab.\r\n                        if (target.dataset.handler === `answers_tab`) {\r\n                            Loading.show();\r\n\r\n                            let preset = Preset.get();\r\n                            Preset.set('sort_answers', preset.sort_answers_default);\r\n                            Preset.set('answers_tab', target.dataset.id);\r\n\r\n                            Render.attempts_area(function(data) {\r\n                                Loading.remove();\r\n                            });\r\n                            return;\r\n                        }\r\n\r\n                        // Handle answers sorting.\r\n                        if (target.dataset.handler === `answers_sort`) {\r\n                            let value = target.dataset.value;\r\n                            let name = target.dataset.name;\r\n\r\n                            $(answerSort).data('value', value);\r\n                            $(answerSort).data('name', name);\r\n                            $('#answersSortingDropdown').find('span').html(name);\r\n                            $(answerSort).addClass('selected');\r\n\r\n                            Loading.show();\r\n\r\n                            Preset.set('sort_answers', value);\r\n                            Render.attempts_area(function(data) {\r\n                                Loading.remove();\r\n                            });\r\n                            return;\r\n                        }\r\n\r\n                        // Handle change discussion for question.\r\n                        if (target.dataset.handler === `change_question_discussion`) {\r\n\r\n                            Loading.show();\r\n\r\n                            if ($(target).hasClass('active')) {\r\n                                $(target).removeClass('active');\r\n                            } else {\r\n                                $(target).addClass('active');\r\n                            }\r\n\r\n                            let preset = Preset.get();\r\n\r\n                            Ajax.call([{\r\n                                methodname: 'quiz_assessmentdiscussion_change_discussion',\r\n                                args: {\r\n                                    'cmid': preset.cmid,\r\n                                    'groupid': preset.groupid,\r\n                                    'qid': target.dataset.qid\r\n                                },\r\n                                done: function(response) {\r\n\r\n                                    let res = JSON.parse(response.data);\r\n\r\n                                    // If dashboard tab is tab discussion.\r\n                                    if (preset.dashboard_tab_discussion_value === preset.dashboard_tab) {\r\n                                        Render.dashboard(function(data) {\r\n                                            Preset.set('qid', data.activeqid);\r\n\r\n                                            changeUrl();\r\n\r\n                                            Render.answers_area(true, function(data) {\r\n                                                Loading.remove();\r\n                                            });\r\n                                        });\r\n                                    } else {\r\n                                        Render.dashboard_tabs(function(data) {\r\n                                            Render.answers_tabs(function(data) {\r\n                                                changeQuestionListIcon(target.dataset.qid, res.question_enable);\r\n\r\n                                                // Remove class 'active'.\r\n                                                if (res.question_enable === false) {\r\n                                                    $(document.querySelectorAll('[data-handler=\"change_answer_discussion\"]')).each(function(index, item) {\r\n                                                        $(item).removeClass('active');\r\n                                                    });\r\n\r\n                                                    $(document.querySelectorAll('[data-handler=\"change_attempt_discussion\"]')).each(function(index, item) {\r\n                                                        $(item).removeClass('active');\r\n                                                    });\r\n                                                }\r\n\r\n                                                Loading.remove();\r\n                                            });\r\n                                        });\r\n                                    }\r\n                                },\r\n                                fail: function(response) {\r\n                                    Loading.remove();\r\n                                    Notification.exception(response);\r\n                                },\r\n                            }]);\r\n                            return;\r\n                        }\r\n\r\n                        // Handle change discussion for answers.\r\n                        if (target.dataset.handler === `change_answer_discussion`) {\r\n\r\n                            Loading.show();\r\n\r\n                            let preset = Preset.get();\r\n                            let button = $(target);\r\n\r\n                            Ajax.call([{\r\n                                methodname: 'quiz_assessmentdiscussion_change_discussion',\r\n                                args: {\r\n                                    'cmid': preset.cmid,\r\n                                    'groupid': preset.groupid,\r\n                                    'qid': preset.qid,\r\n                                    'userid': target.dataset.userid\r\n                                },\r\n                                done: function(response) {\r\n\r\n                                    let res = JSON.parse(response.data);\r\n\r\n                                    // If answers tab is tab discussion.\r\n                                    if (preset.answer_tab_discussion_value === preset.answers_tab) {\r\n                                        Render.dashboard_tabs(function(data) {\r\n                                            Render.answers_tabs(function(data) {\r\n                                                Render.answers_area(false, function(data) {\r\n                                                    changeQuestionListIcon(preset.qid, res.question_enable);\r\n                                                    changeQuestionInfoIcon(preset.qid, res.question_enable);\r\n                                                    Loading.remove();\r\n                                                });\r\n                                            });\r\n                                        });\r\n                                    } else {\r\n                                        Render.dashboard_tabs(function(data) {\r\n                                            Render.answers_tabs(function(data) {\r\n                                                changeQuestionListIcon(preset.qid, res.question_enable);\r\n                                                changeQuestionInfoIcon(preset.qid, res.question_enable);\r\n\r\n                                                // Remove class 'active'.\r\n                                                if (res.answer_enable === false) {\r\n                                                    let objs = button.parent().parent().find('[data-handler=\"change_attempt_discussion\"]');\r\n                                                    $(objs).each(function(index, item) {\r\n                                                        $(item).removeClass('active');\r\n                                                    });\r\n                                                }\r\n\r\n                                                if (button.hasClass('active')) {\r\n                                                    button.removeClass('active');\r\n                                                } else {\r\n                                                    button.addClass('active');\r\n                                                }\r\n\r\n                                                Loading.remove();\r\n                                            });\r\n                                        });\r\n                                    }\r\n                                },\r\n                                fail: function(response) {\r\n                                    Loading.remove();\r\n                                    Notification.exception(response);\r\n                                },\r\n                            }]);\r\n\r\n                        }\r\n\r\n                        if (target.dataset.handler === `change_attempt_discussion`) {\r\n\r\n                            Loading.show();\r\n\r\n                            let preset = Preset.get();\r\n                            let button = $(target);\r\n\r\n                            Ajax.call([{\r\n                                methodname: 'quiz_assessmentdiscussion_change_discussion',\r\n                                args: {\r\n                                    'cmid': preset.cmid,\r\n                                    'groupid': preset.groupid,\r\n                                    'qid': preset.qid,\r\n                                    'userid': target.dataset.userid,\r\n                                    'attemptid': target.dataset.attemptid\r\n                                },\r\n                                done: function(response) {\r\n\r\n                                    let res = JSON.parse(response.data);\r\n\r\n                                    // If answers tab is tab discussion.\r\n                                    if (preset.answer_tab_discussion_value === preset.answers_tab) {\r\n                                        Render.dashboard_tabs(function(data) {\r\n                                            Render.answers_tabs(function(data) {\r\n                                                Render.answers_area(false, function(data) {\r\n                                                    changeQuestionListIcon(preset.qid, res.question_enable);\r\n                                                    changeQuestionInfoIcon(preset.qid, res.question_enable);\r\n                                                    Loading.remove();\r\n                                                });\r\n                                            });\r\n                                        });\r\n                                    } else {\r\n                                        Render.dashboard_tabs(function(data) {\r\n                                            Render.answers_tabs(function(data) {\r\n                                                changeQuestionListIcon(preset.qid, res.question_enable);\r\n                                                changeQuestionInfoIcon(preset.qid, res.question_enable);\r\n\r\n                                                if (button.hasClass('active')) {\r\n                                                    button.removeClass('active');\r\n                                                } else {\r\n                                                    button.addClass('active');\r\n                                                }\r\n\r\n                                                let answerbutton = button.parent().parent().parent().find('.discussion-state-btn');\r\n\r\n                                                answerbutton.removeClass('active');\r\n                                                if (res.question_enable === true) {\r\n                                                    answerbutton.addClass('active');\r\n                                                }\r\n\r\n                                                Loading.remove();\r\n                                            });\r\n                                        });\r\n                                    }\r\n                                },\r\n                                fail: function(response) {\r\n                                    Loading.remove();\r\n                                    Notification.exception(response);\r\n                                },\r\n                            }]);\r\n\r\n                        }\r\n\r\n                        // Handle submit grade.\r\n                        if (target.dataset.handler === `submit_grade`) {\r\n\r\n                            let form = $(target).parent().parent();\r\n                            let formdata = form.serializeArray();\r\n                            let alertinfo = form.find('.alert');\r\n\r\n                            let tmp = {};\r\n                            $(formdata).each(function(index, item) {\r\n                                tmp[item.name] = item.value;\r\n                            });\r\n\r\n                            // Prepare data for Tiny.\r\n                            tmp.comment = window.tinyMCE.get(tmp.uniqueid).getContent();\r\n                            delete tmp.uniqueid;\r\n\r\n                            let grade = tmp.grade.trim();\r\n                            if (grade.length === 0 || grade > tmp.maxmark || grade < 0) {\r\n\r\n                                const reqStrings = [\r\n                                    {key: 'notpossibletoenterascore', component: 'quiz_assessmentdiscussion'},\r\n                                    {key: 'dismissnotification', component: 'core'},\r\n                                ];\r\n\r\n                                const stringsPromise = Str.get_strings(reqStrings);\r\n\r\n                                $.when(stringsPromise).then(function (strings) {\r\n                                   createBootstrapAlert(strings[0], strings[1]);\r\n                                   return setTimeout(() => {\r\n                                    $('.grade-area-block .alert-warning').alert('close');\r\n                                   }, 1000);\r\n                                }).fail(Notification.exception);\r\n\r\n                                return;\r\n                            }\r\n\r\n                            Loading.show();\r\n\r\n                            let data = [];\r\n                            data.push(tmp);\r\n\r\n                            let preset = Preset.get();\r\n\r\n                            Ajax.call([{\r\n                                methodname: 'quiz_assessmentdiscussion_save_grades',\r\n                                args: {\r\n                                    'cmid': preset.cmid,\r\n                                    'qid': preset.qid,\r\n                                    'grades': data\r\n                                },\r\n                                done: function(response) {\r\n                                    Render.dashboard_tabs(function(data) {\r\n                                        Render.answers_tabs(function(data) {\r\n                                            Render.attempts_area(function(data) {\r\n                                                Loading.remove();\r\n                                            });\r\n                                        });\r\n                                    });\r\n                                },\r\n                                fail: function(response) {\r\n                                    Loading.remove();\r\n                                    Notification.exception(response);\r\n                                },\r\n                            }]);\r\n                        }\r\n\r\n                        // Handle submit all grades.\r\n                        if (target.dataset.handler === `submit_all_grades`) {\r\n\r\n                            let data = [];\r\n                            $('.grade-area-block').each(function(index, item) {\r\n\r\n                                let formdata = $(this).serializeArray();\r\n\r\n                                let tmp = {};\r\n                                $(formdata).each(function(index, item) {\r\n                                    tmp[item.name] = item.value;\r\n                                });\r\n\r\n                                // Prepare data for Tiny.\r\n                                tmp.comment = window.tinyMCE.get(tmp.uniqueid).getContent();\r\n                                delete tmp.uniqueid;\r\n\r\n                                data.push(tmp);\r\n                            });\r\n\r\n                            Loading.show();\r\n\r\n                            let preset = Preset.get();\r\n\r\n                            Ajax.call([{\r\n                                methodname: 'quiz_assessmentdiscussion_save_grades',\r\n                                args: {\r\n                                    'cmid': preset.cmid,\r\n                                    'qid': preset.qid,\r\n                                    'grades': data\r\n                                },\r\n                                done: function(response) {\r\n                                    Render.dashboard_tabs(function(data) {\r\n                                        Render.answers_tabs(function(data) {\r\n                                            Render.attempts_area(function(data) {\r\n                                                Loading.remove();\r\n                                            });\r\n                                        });\r\n                                    });\r\n                                },\r\n                                fail: function(response) {\r\n                                    Loading.remove();\r\n                                    Notification.exception(response);\r\n                                },\r\n                            }]);\r\n\r\n                        }\r\n\r\n                        target = target.parentNode;\r\n                    }\r\n                });\r\n\r\n                return true;\r\n            },\r\n\r\n            'createAlert': function() {\r\n                const reqStrings = [\r\n                    {key: 'notpossibletoenterascore', component: 'quiz_assessmentdiscussion'},\r\n                    {key: 'dismissnotification', component: 'core'},\r\n                ];\r\n\r\n                const stringsPromise = Str.get_strings(reqStrings);\r\n\r\n                $.when(stringsPromise).then(function (strings) {\r\n                    createBootstrapAlert(strings[0], strings[1]);\r\n                    return setTimeout(() => {\r\n                        $('.grade-area-block-alert').remove();\r\n                    }, 8000);\r\n                }).fail(Notification.exception);\r\n            }\r\n        };\r\n    });\r\n"],"names":["define","$","Ajax","Notification","Str","Preset","Render","Loading","mainBlock","document","querySelector","dashboardSort","dashboardGroup","answerSort","changeQuestionListIcon","qid","state","each","currentqid","this","data","Number","find","removeClass","addClass","changeQuestionInfoIcon","obj","createBootstrapAlert","message","dismissText","alert","createElement","className","setAttribute","innerHTML","after","changeUrl","preset","get","url","cmid","window","history","pushState","init","def","JSON","parse","setDefault","show","answers_area","remove","addEventListener","event","target","dataset","handler","set","id","dashboard","activeqid","value","name","html","aside_questions","checked","is","attempts_area","targetgrades","get_strings","key","component","done","strings","action","call","methodname","args","response","fail","exception","attr","sort_answers_default","hasClass","groupid","res","dashboard_tab_discussion_value","dashboard_tab","dashboard_tabs","answers_tabs","question_enable","querySelectorAll","index","item","button","userid","answer_tab_discussion_value","answers_tab","answer_enable","objs","parent","attemptid","answerbutton","form","formdata","serializeArray","tmp","comment","tinyMCE","uniqueid","getContent","grade","trim","length","maxmark","reqStrings","stringsPromise","when","then","setTimeout","push","grades","parentNode","createAlert"],"mappings":"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"}