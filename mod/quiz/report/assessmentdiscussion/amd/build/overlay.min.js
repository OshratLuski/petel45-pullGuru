define("quiz_assessmentdiscussion/overlay",["jquery","core/ajax","core/notification","core/modal_factory","core/modal_events","core/str","quiz_assessmentdiscussion/preset","quiz_assessmentdiscussion/render","quiz_assessmentdiscussion/loading"],(function($,Ajax,Notification,ModalFactory,ModalEvents,Str,Preset,Render,Loading){const mainBlock=document.querySelector("body");return{scriptsForPage:function(){$(".answerOverlayBackBtn").on("click",(e=>{const anonymousState=$(e.target).closest(".answeroverlay").find(".assessmentdiscussion_report-toggle input")[0].checked;$(".answeroverlay").remove(),$("#anonymousmodeToggler")[0].checked=anonymousState,Loading.show(),Render.attempts_area((function(data){Loading.remove()}))}))},init:function(def){return def=JSON.parse(def),Preset.setDefault(def),mainBlock.addEventListener("click",(function(event){let target=event.target;for(;target!==mainBlock&&null!==target;){if("open_overlay"===target.dataset.handler)return Loading.show(),Preset.set("overlay_qid",target.dataset.qid),Preset.set("overlay_show_answers",def.overlay_show_answers),Preset.set("overlay_tab",def.overlay_tab),Preset.set("overlay_view_list",def.overlay_view_list),Preset.set("anonymous_mode",1),void Render.overlay_dashboard((function(data){Loading.remove()}));if("overlay_change_question"===target.dataset.handler)return Loading.show(),Preset.set("overlay_qid",target.dataset.qid),Preset.set("overlay_tab",def.overlay_tab),Preset.set("overlay_view_list",def.overlay_view_list),void Render.overlay_dashboard((function(data){Loading.remove()}));if("overlay_anonymous"===target.dataset.handler){let checked=0;if($(target).is(":checked")&&(checked=1),checked){Loading.show();let checked=0;$(target).is(":checked")&&(checked=1),Preset.set("anonymous_mode",checked),Render.overlay_dashboard((function(data){Loading.remove()}))}else{var stringsPromise=Str.get_strings([{key:"changedisplaymodemodaltitle",component:"quiz_assessmentdiscussion"},{key:"changedisplaymodemodaltext",component:"quiz_assessmentdiscussion"},{key:"ok",component:"quiz_assessmentdiscussion"}]),modalPromise=ModalFactory.create({type:ModalFactory.types.SAVE_CANCEL});$.when(stringsPromise,modalPromise).then((function(strings,modal){return modal.setTitle(strings[0]),modal.setBody(strings[1]),modal.setSaveButtonText(strings[2]),modal.getRoot().on(ModalEvents.shown,(function(){modal.getRoot()[0].setAttribute("style","z-index: 99999999;")})),modal.getRoot().on(ModalEvents.save,(function(){Loading.show();let checked=0;$(target).is(":checked")&&(checked=1),Preset.set("anonymous_mode",checked),Render.overlay_dashboard((function(data){Loading.remove()}))})),modal.show(),modal})).fail(Notification.exception)}}if("overlay_tab"===target.dataset.handler)return Loading.show(),Preset.set("overlay_tab",target.dataset.id),void Render.overlay_dashboard((function(data){Loading.remove()}));if("overlay_button_list_view"===target.dataset.handler)return Loading.show(),Preset.set("overlay_view_list",target.dataset.id),void Render.overlay_dashboard((function(data){Loading.remove()}));"overlay_hide_state"===target.dataset.handler&&($(target).toggleClass("active"),$(".answeroverlay-content").toggleClass("blured"),$(target).hasClass("active")?Preset.set("overlay_show_answers",1):Preset.set("overlay_show_answers",0)),target=target.parentNode}})),!0}}}));

//# sourceMappingURL=overlay.min.js.map