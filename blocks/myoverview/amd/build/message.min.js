/**
 * Javascript to initialise the selectors for the myoverview block.
 *
 * @package    block_myoverview
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("block_myoverview/message",["jquery","core/str","core/modal_factory","core/modal_events","core/templates","core/notification","core/ajax"],(function($,Str,ModalFactory,ModalEvents,Templates,Notification,Ajax){var Message=function(){};return Message.prototype.modal=null,Message.prototype.submitSendMessage=function(courseId,target){var messageText=this.modal.getRoot().find("form textarea").val();return Ajax.call([{methodname:"block_myoverview_send_course_messages",args:{message:messageText,courseid:courseId,target:target}}])[0].then((function(messageIds){return 1==messageIds.length?Str.get_string("sendbulkmessagesentsingle","core_message"):Str.get_string("sendbulkmessagesent","core_message",messageIds.length)})).then((function(msg){return Notification.addNotification({message:msg,type:"success"}),!0})).catch(Notification.exception)},Message.prototype.openForm=function(courseId,target){if("class"===target)var titlePromise=Str.get_string("send_message_to_course_users","block_myoverview");else titlePromise=Str.get_string("send_message_to_teacher","block_myoverview");return $.when(ModalFactory.create({type:ModalFactory.types.SAVE_CANCEL,body:Templates.render("block_myoverview/petel/send_course_message",{})}),titlePromise).then(function(modal,title){return this.modal=modal,this.modal.setTitle(title),this.modal.setSaveButtonText(title),this.modal.getRoot().on(ModalEvents.hidden,function(){this.modal.getRoot().remove()}.bind(this)),this.modal.getRoot().on(ModalEvents.save,this.submitSendMessage.bind(this,courseId,target)),this.modal.show(),this.modal}.bind(this))},{init:function(options){return new Message(options)}}}));

//# sourceMappingURL=message.min.js.map