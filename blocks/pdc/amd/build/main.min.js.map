{"version":3,"file":"main.min.js","sources":["../src/main.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Javascript to initialise the myoverview block.\n *\n * @package    block_pdc\n * @copyright  2018 Bas Brands <bas@moodle.com>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine([\n        'jquery',\n        'core/ajax',\n        'core/notification',\n        'local_petel/inview'\n    ],\n    function ($, Ajax, Notification, inView) {\n\n        return {\n            selector: {\n                wrapper: '#block-pdc-selectSort',\n                mainBlock: '.block-pdc-content-courses',\n                selectItems: '#block-pdc-selectSort .dropdown-item',\n                spinner: '#block-pdc-selectSort .spinner-border',\n            },\n\n            /**\n             * Initialise all of the modules for the overview block.\n             *\n             * @param {object} courseids The root element for the overview block.\n             */\n            init: function () {\n\n                var root = $(this.selector.wrapper),\n                    self = this;\n\n                // First run.\n                inView('.block-pdc-inview')\n                    .on('enter', function (e) {\n                        if (!$(e).hasClass('inview-done')) {\n                            $(e).addClass('inview-done');\n\n                            var sort = $('#block-pdc-selectSort .dropdown-menu .active').data('value');\n                            self.renderBlock(sort);\n                        }\n                    })\n                    .on('exit', el => {\n                    });\n\n                root.on('click', function (e) {\n                    var target = $(e.target);\n                    while ($.contains(root[0], target[0])) {\n                        if (target.data('handler') === 'setSorting') {\n\n                            $(self.selector.selectItems).removeClass('active');\n                            $(target).addClass('active');\n\n                            self.renderBlock(target.data('value'));\n                            return;\n                        }\n\n                        target = target.parent();\n                    }\n\n                });\n            },\n\n            renderBlock: function (sort) {\n\n                var self = this;\n                this.toggleSpinner(true);\n\n                Ajax.call([{\n                    methodname: 'block_pdc_render_courses_block',\n                    args: {\n                        sort: sort\n                    },\n                    done: function (response) {\n                        self.toggleSpinner(false);\n                        if (response.status) {\n                            $(self.selector.mainBlock).html(response.content);\n                        }\n                    },\n                    fail: Notification.exception\n                }]);\n            },\n\n            toggleSpinner: function (status) {\n                var spinner = $(this.selector.spinner);\n                var borderColor = status ? '' : 'transparent';\n                spinner.css('border-color', borderColor);\n            }\n        };\n    });\n"],"names":["define","$","Ajax","Notification","inView","selector","wrapper","mainBlock","selectItems","spinner","init","root","this","self","on","e","hasClass","addClass","sort","data","renderBlock","el","target","contains","removeClass","parent","toggleSpinner","call","methodname","args","done","response","status","html","content","fail","exception","borderColor","css"],"mappings":";;;;;;;AAuBAA,wBAAO,CACC,SACA,YACA,oBACA,uBAEJ,SAAUC,EAAGC,KAAMC,aAAcC,cAEtB,CACHC,SAAU,CACNC,QAAS,wBACTC,UAAW,6BACXC,YAAa,uCACbC,QAAS,yCAQbC,KAAM,eAEEC,KAAOV,EAAEW,KAAKP,SAASC,SACvBO,KAAOD,KAGXR,OAAO,qBACFU,GAAG,SAAS,SAAUC,OACdd,EAAEc,GAAGC,SAAS,eAAgB,CAC/Bf,EAAEc,GAAGE,SAAS,mBAEVC,KAAOjB,EAAE,gDAAgDkB,KAAK,SAClEN,KAAKO,YAAYF,UAGxBJ,GAAG,QAAQ,SAAAO,QAGhBV,KAAKG,GAAG,SAAS,SAAUC,WACnBO,OAASrB,EAAEc,EAAEO,QACVrB,EAAEsB,SAASZ,KAAK,GAAIW,OAAO,KAAK,IACJ,eAA3BA,OAAOH,KAAK,kBAEZlB,EAAEY,KAAKR,SAASG,aAAagB,YAAY,UACzCvB,EAAEqB,QAAQL,SAAS,eAEnBJ,KAAKO,YAAYE,OAAOH,KAAK,UAIjCG,OAASA,OAAOG,cAM5BL,YAAa,SAAUF,UAEfL,KAAOD,UACNc,eAAc,GAEnBxB,KAAKyB,KAAK,CAAC,CACPC,WAAY,iCACZC,KAAM,CACFX,KAAMA,MAEVY,KAAM,SAAUC,UACZlB,KAAKa,eAAc,GACfK,SAASC,QACT/B,EAAEY,KAAKR,SAASE,WAAW0B,KAAKF,SAASG,UAGjDC,KAAMhC,aAAaiC,cAI3BV,cAAe,SAAUM,YAEjBK,YAAcL,OAAS,GAAK,cADlB/B,EAAEW,KAAKP,SAASI,SAEtB6B,IAAI,eAAgBD,cAGvC"}