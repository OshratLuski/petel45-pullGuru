/**
 * Javascript to initialise the myoverview block.
 *
 * @package    block_oer_items
 * @copyright  2018 Bas Brands <bas@moodle.com>
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("block_oer_items/main",["jquery","core/ajax","core/notification","local_petel/inview","core/templates"],(function($,Ajax,Notification,inView,Templates){return{selector:{wrapper:"#selectCourse",language:"#selectLanguage",blocks:".block_oer_items",mainBlock:".content-oer-activities",selectedCourse:"#selectedCourse",exampleCourse:"button.example",selectItems:"#selectCourse .dropdown-item",spinner:"#selectCourse .spinner-border"},init:function(){var root=$(this.selector.wrapper),self=this;inView(".block-oer-items-inview").on("enter",(function(e){$(e).hasClass("inview-done")||($(e).addClass("inview-done"),self.renderBlock())})).on("exit",(function(el){})),root.on("click",(function(e){for(var target=$(e.target);$.contains(root[0],target[0]);){if("setCourse"===target.data("handler"))return void self.setCourse(target);if("removeCourse"===target.data("handler"))return void self.removeCourse(target);target=target.parent()}})),$(this.selector.language).change((function(){self.renderBlock()}))},setCourse:function(target){var courseid=target.attr("data-courseid");if(target.hasClass("active"))return target.removeClass("active"),this.removeCourse(target),void this.renderBlock();"0"===courseid?($(this.selector.selectItems).removeClass("active"),$(this.selector.selectedCourse+" button").each((function(){$(this).hasClass("example")||$(this).remove()}))):($(this.selector.selectItems).parent().find("[data-courseid=0]").removeClass("active"),$(this.selector.selectedCourse).find("[data-courseid=0]").remove());var btnCourse=$(this.selector.exampleCourse).clone(),wrapper=$(this.selector.selectedCourse),name=target.attr("data-name");btnCourse.attr("data-courseid",courseid),btnCourse.find("span").text(name),btnCourse.removeClass("d-none example"),wrapper.append(btnCourse),target.toggleClass("active"),this.renderBlock()},removeCourse:function(target){var courseid=target.attr("data-courseid");$(this.selector.selectItems).parent().find("[data-courseid="+courseid+"]").removeClass("active"),$(this.selector.selectedCourse).find("[data-courseid="+courseid+"]").remove(),this.renderBlock()},renderBlock:function(){var allCourses=$(this.selector.selectItems),self=this,selectedCoures=[];this.toggleSpinner(!0),allCourses.each((function(){$(this).hasClass("active")&&selectedCoures.push($(this).attr("data-courseid"))})),Ajax.call([{methodname:"block_oer_items_render_activity_block",args:{courseids:JSON.stringify(selectedCoures),language:$(this.selector.language).val()},done:function(response){self.toggleSpinner(!1),Templates.render("block_oer_items/content-activities",JSON.parse(response)).done((function(html,js){Templates.replaceNodeContents(self.selector.mainBlock,html,js)})).fail(Notification.exception)},fail:Notification.exception}])},toggleSpinner:function(status){var borderColor=status?"currentColor":"transparent";$(this.selector.spinner).css("border-color",borderColor)}}}));

//# sourceMappingURL=main.min.js.map