/**
 * Javascript to initialise the myoverview block.
 *
 * @package    block_social_newcourses
 * @copyright  2018 Bas Brands <bas@moodle.com>
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("block_social_newcourses/main",["jquery","core/ajax","core/notification","local_petel/inview"],(function($,Ajax,Notification,inView){var selector_wrapper="#block-social_newcourses-selectSort",selector_mainBlock=".block-social_newcourses-content-courses",selector_selectItems="#block-social_newcourses-selectSort .dropdown-item",selector_spinner="#block-social_newcourses-selectSort .spinner-border",selector_button=".social_newcourses-btn",selector_page="#block-social_newcourses-page",toggleSpinner=function(status){var borderColor=status?"":"transparent";$(selector_spinner).css("border-color",borderColor)},renderBlock=function(perpage){$(selector_page).val(perpage),toggleSpinner(!0),Ajax.call([{methodname:"block_social_newcourses_render_courses_block",args:{perpage:perpage},done:function(response){toggleSpinner(!1),response.status&&($(selector_mainBlock).html(response.content),$(selector_button).on("click",btnClassClick))},fail:Notification.exception}])},btnClassClick=function(event){if("send_followed_single_course"===event.target.dataset.handler){var ids=[],courseid=event.target.dataset.courseid;ids.push(courseid);var page_userid=event.target.dataset.page_userid,current_userid=event.target.dataset.current_userid;return toggleSpinner(!0),void send_followed_courses(page_userid,current_userid,ids,(function(){var page=$(selector_page).val();renderBlock(page),toggleSpinner(!1)}))}},send_followed_courses=function(page_userid,current_userid,ids,callback){Ajax.call([{methodname:"community_social_send_followed_courses",args:{page_userid:Number(page_userid),current_userid:Number(current_userid),ids:JSON.stringify(ids)},done:function(){callback()},fail:Notification.exception}])};return{init:function(){var root=$(selector_wrapper);inView(".block-social-newcourses-inview").on("enter",(function(e){if(!$(e).hasClass("inview-done")){$(e).addClass("inview-done");var perpage=$("#block-social_newcourses-selectSort .dropdown-menu .active").data("value");renderBlock(perpage)}})).on("exit",(function(el){})),root.on("click",(function(e){for(var target=$(e.target);$.contains(root[0],target[0]);){if("setPerpage"===target.data("handler"))return $(selector_selectItems).removeClass("active"),$(target).addClass("active"),void renderBlock(target.data("value"));target=target.parent()}})),$(selector_button).on("click",btnClassClick)}}}));

//# sourceMappingURL=main.min.js.map