{"version":3,"file":"main.min.js","sources":["../src/main.js"],"sourcesContent":["/**\n * Javascript to initialise the myoverview block.\n *\n * @package    block_sharedwithme\n * @copyright  2018 Bas Brands <bas@moodle.com>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine([\n        'jquery',\n        'core/ajax',\n        'core/notification',\n        'local_petel/inview'\n    ],\n    function ($, Ajax, Notification, inView) {\n        `use strict`;\n\n        var selector = {\n            wrapper: '#block-sharedwithme-selectSort',\n            mainBlock: '.block-sharedwithme-content-courses',\n            selectItems: '#block-sharedwithme-selectSort .dropdown-item',\n            spinner: '#block-sharedwithme-selectSort .spinner-border',\n            button: '.sharedwithme-btn',\n            page: '#block-sharedwithme-page',\n        };\n\n        const toggleSpinner = (status) => {\n            var spinner = $(selector.spinner);\n            var borderColor = status ? '' : 'transparent';\n            spinner.css('border-color', borderColor);\n        };\n\n        const renderBlock = (perpage) => {\n\n            $(selector.page).val(perpage);\n            toggleSpinner(true);\n\n            Ajax.call([{\n                methodname: 'block_sharedwithme_render_courses_block',\n                args: {\n                    perpage: perpage\n                },\n                done: function (response) {\n                    toggleSpinner(false);\n                    if (response.status) {\n                        $(selector.mainBlock).html(response.content);\n                    }\n                },\n                fail: Notification.exception\n            }]);\n        };\n\n        return {\n\n            init: function () {\n\n                var root = $(selector.wrapper);\n\n                // First run.\n                inView('.block-social-newcourses-inview')\n                    .on('enter', function (e){\n                        if(!$(e).hasClass('inview-done')){\n                            $(e).addClass('inview-done');\n\n                            var perpage = $('#block-sharedwithme-selectSort .dropdown-menu .active').data('value');\n                            renderBlock(perpage);\n                        }\n                    })\n                    .on('exit', el => {\n                    });\n\n                root.on('click', function (e) {\n                    var target = $(e.target);\n                    while ($.contains(root[0], target[0])) {\n                        if (target.data('handler') === 'setPerpage') {\n\n                            $(selector.selectItems).removeClass('active');\n                            $(target).addClass('active');\n\n                            renderBlock(target.data('value'));\n                            return;\n                        }\n\n                        target = target.parent();\n                    }\n                });\n            }\n        };\n    });\n"],"names":["define","$","Ajax","Notification","inView","selector","toggleSpinner","status","borderColor","css","renderBlock","perpage","val","call","methodname","args","done","response","html","content","fail","exception","init","root","on","e","hasClass","addClass","data","el","target","contains","removeClass","parent"],"mappings":";;;;;;;AAQAA,iCAAO,CACC,SACA,YACA,oBACA,uBAEJ,SAAUC,EAAGC,KAAMC,aAAcC,YAGzBC,iBACS,iCADTA,mBAEW,sCAFXA,qBAGa,gDAHbA,iBAIS,iDAJTA,cAMM,2BAGJC,cAAgB,SAACC,YAEfC,YAAcD,OAAS,GAAK,cADlBN,EAAEI,kBAERI,IAAI,eAAgBD,cAG1BE,YAAc,SAACC,SAEjBV,EAAEI,eAAeO,IAAID,SACrBL,eAAc,GAEdJ,KAAKW,KAAK,CAAC,CACPC,WAAY,0CACZC,KAAM,CACFJ,QAASA,SAEbK,KAAM,SAAUC,UACZX,eAAc,GACVW,SAASV,QACTN,EAAEI,oBAAoBa,KAAKD,SAASE,UAG5CC,KAAMjB,aAAakB,oBAIpB,CAEHC,KAAM,eAEEC,KAAOtB,EAAEI,kBAGbD,OAAO,mCACFoB,GAAG,SAAS,SAAUC,OACfxB,EAAEwB,GAAGC,SAAS,eAAe,CAC7BzB,EAAEwB,GAAGE,SAAS,mBAEVhB,QAAUV,EAAE,yDAAyD2B,KAAK,SAC9ElB,YAAYC,aAGnBa,GAAG,QAAQ,SAAAK,QAGhBN,KAAKC,GAAG,SAAS,SAAUC,WACnBK,OAAS7B,EAAEwB,EAAEK,QACV7B,EAAE8B,SAASR,KAAK,GAAIO,OAAO,KAAK,IACJ,eAA3BA,OAAOF,KAAK,kBAEZ3B,EAAEI,sBAAsB2B,YAAY,UACpC/B,EAAE6B,QAAQH,SAAS,eAEnBjB,YAAYoB,OAAOF,KAAK,UAI5BE,OAASA,OAAOG,cAKnC"}