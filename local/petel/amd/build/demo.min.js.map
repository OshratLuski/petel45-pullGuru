{"version":3,"file":"demo.min.js","sources":["../src/demo.js"],"sourcesContent":["/**\n * Javascript main event handler.\n *\n * @module     local_petel/init\n * @package    local_petel\n * @copyright  2022 Weizmann institute of science, Israel.\n * @author  2022 Devlion Ltd. <info@devlion.co>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n * @since      3.6\n */\n\ndefine([\n    'jquery',\n    'core/str',\n    'core/url',\n    'core/notification',\n    'core/ajax',\n    'core/modal_events',\n    'core/modal_factory',\n    'core/templates',\n], function ($, Str, Url, Notification, Ajax, ModalEvents, ModalFactory, Templates) {\n\n    var unique_id;\n\n    return {\n        init: function () {\n            let self = this;\n\n            $(document).on('click', '.demo_popup', function () {\n                self.openPopup($(this).data('key'), $(this).data('cmid'), $(this).data('lang'));\n            });\n\n            $(document).on('click', '.demo-popup-course', function () {\n                let classes = $(this).attr('class');\n                let keyClass = classes.match(/(^|\\s)(key\\-[^\\s]*)/)[0];\n                let langClass = classes.match(/(^|\\s)(lang\\-[^\\s]*)/)[0];\n                if (keyClass !== undefined) {\n                    let key = keyClass.replace(/^key-/, '');\n                    let lang = langClass.replace('lang-', '');\n                    self.openPopup(key, null, lang.trim());\n                }\n            });\n\n            $(document).on('click', '.demo_copytoclipboard', function () {\n                let _this = $(this);\n                Str.get_strings([\n                    { key: 'demo_copied', component: 'local_petel' }\n                ]).done(function (strings) {\n                    var copytext = _this.data('copytext');\n                    navigator.clipboard.writeText(copytext);\n                    _this.next('.tooltip').tooltip('show').attr('title', strings[0] + \": \" + copytext);\n                });\n            });\n        },\n\n        openPopup: function (password, cmid, lang) {\n            var self = this;\n\n            var keys = [\n                {\n                    key: 'demomodalhdr',\n                    component: 'local_petel'\n                },\n            ];\n\n            var params = {\n                key: password,\n            };\n\n            if (cmid !== undefined && cmid!=null) {\n                params.cmid = cmid;\n            }\n\n            if (lang !== undefined) {\n                params.lang = lang;\n            }\n\n            var queryparams = $.param(params);\n            let url = Url.relativeUrl('/local/petel/demo.php?' + queryparams);\n\n            Str.get_strings(keys).then(function(langStrings) {\n                var modalTitle = langStrings[0];\n\n                var context = {\n                    'url': url\n                };\n                return ModalFactory.create({\n                    title: modalTitle,\n                    body: Templates.render('local_petel/demo_popup', context),\n                    type: ModalFactory.types.CANCEL,\n                    large: false\n                });\n            }).then(function(modal) {\n\n                // Show the modal!\n                modal.show();\n\n                // Handle hidden event.\n                modal.getRoot().on(ModalEvents.hidden, function() {\n                    // Destroy when hidden.\n                    modal.destroy();\n                });\n\n                return;\n            }).catch(Notification.exception);\n        },\n    };\n});"],"names":["define","$","Str","Url","Notification","Ajax","ModalEvents","ModalFactory","Templates","init","self","this","document","on","openPopup","data","classes","attr","keyClass","match","langClass","undefined","key","replace","lang","trim","_this","get_strings","component","done","strings","copytext","navigator","clipboard","writeText","next","tooltip","password","cmid","params","queryparams","param","url","relativeUrl","then","langStrings","modalTitle","context","create","title","body","render","type","types","CANCEL","large","modal","show","getRoot","hidden","destroy","catch","exception"],"mappings":";;;;;;;;;;AAWAA,0BAAO,CACH,SACA,WACA,WACA,oBACA,YACA,oBACA,qBACA,mBACD,SAAUC,EAAGC,IAAKC,IAAKC,aAAcC,KAAMC,YAAaC,aAAcC,iBAI9D,CACHC,KAAM,eACEC,KAAOC,KAEXV,EAAEW,UAAUC,GAAG,QAAS,eAAe,WACnCH,KAAKI,UAAUb,EAAEU,MAAMI,KAAK,OAAQd,EAAEU,MAAMI,KAAK,QAASd,EAAEU,MAAMI,KAAK,YAG3Ed,EAAEW,UAAUC,GAAG,QAAS,sBAAsB,eACtCG,QAAUf,EAAEU,MAAMM,KAAK,SACvBC,SAAWF,QAAQG,MAAM,uBAAuB,GAChDC,UAAYJ,QAAQG,MAAM,wBAAwB,WACrCE,IAAbH,SAAwB,KACpBI,IAAMJ,SAASK,QAAQ,QAAS,IAChCC,KAAOJ,UAAUG,QAAQ,QAAS,IACtCb,KAAKI,UAAUQ,IAAK,KAAME,KAAKC,YAIvCxB,EAAEW,UAAUC,GAAG,QAAS,yBAAyB,eACzCa,MAAQzB,EAAEU,MACdT,IAAIyB,YAAY,CACZ,CAAEL,IAAK,cAAeM,UAAW,iBAClCC,MAAK,SAAUC,aACVC,SAAWL,MAAMX,KAAK,YAC1BiB,UAAUC,UAAUC,UAAUH,UAC9BL,MAAMS,KAAK,YAAYC,QAAQ,QAAQnB,KAAK,QAASa,QAAQ,GAAK,KAAOC,iBAKrFjB,UAAW,SAAUuB,SAAUC,KAAMd,UAU7Be,OAAS,CACTjB,IAAKe,eAGIhB,IAATiB,MAA4B,MAANA,OACtBC,OAAOD,KAAOA,WAGLjB,IAATG,OACAe,OAAOf,KAAOA,UAGdgB,YAAcvC,EAAEwC,MAAMF,QACtBG,IAAMvC,IAAIwC,YAAY,yBAA2BH,aAErDtC,IAAIyB,YAtBO,CACP,CACIL,IAAK,eACLM,UAAW,iBAmBGgB,MAAK,SAASC,iBAC5BC,WAAaD,YAAY,GAEzBE,QAAU,KACHL,YAEJnC,aAAayC,OAAO,CACvBC,MAAOH,WACPI,KAAM1C,UAAU2C,OAAO,yBAA0BJ,SACjDK,KAAM7C,aAAa8C,MAAMC,OACzBC,OAAO,OAEZX,MAAK,SAASY,OAGbA,MAAMC,OAGND,MAAME,UAAU7C,GAAGP,YAAYqD,QAAQ,WAEnCH,MAAMI,gBAIXC,MAAMzD,aAAa0D,YAGjC"}