/**
 * Javascript main event handler.
 *
 * @module     local_petel/init
 * @package    local_petel
 * @copyright  2019 Devlionco <info@devlion.co>
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 * @since      3.6
 */
define("local_petel/createcourse",["jquery","core/str","core/ajax","core/notification","core/modal_events","core/modal_factory","core/templates","core/toast"],(function($,Str,Ajax,Notification,ModalEvents,ModalFactory,Templates,toast){var unique_id;return{init:function(currentuserid){var self=this;$(document).on("click",".create_course_template",(function(){self.checkUserIdNumber(currentuserid,(function(res){res?self.openPopup(currentuserid):self.openMessagePopup()}))}))},checkUserIdNumber:function(currentuserid,callback){var data={currentuserid:currentuserid};Ajax.call([{methodname:"local_petel_check_user_idnumber",args:data,done:function(response){response.result?callback(!0):callback(!1)},fail:Notification.exception}])},openMessagePopup:function(){unique_id=Date.now();var titlePromise=Str.get_string("error");Str.get_strings([{key:"createcourseerror",component:"local_petel"}]).done((function(strings){return ModalFactory.create({type:ModalFactory.types.CANCEL,body:strings[0],title:titlePromise,buttons:{},removeOnClose:!0}).then((function(modal){return modal.show(),modal}))}))},openPopup:function(currentuserid){var self=this;unique_id=Date.now();var titlePromise=Str.get_string("createcourseteacher","local_petel"),name="course_name_"+unique_id;Str.get_strings([{key:"coursename",component:"local_petel"},{key:"error"}]).done((function(strings){var template='<input id="'+name+'" name="'+name+'"  class="w-100" type="text" placeholder="'+strings[0]+'">';return template+='<span style="display: none;" class="label text-danger error-block">'+strings[1]+"</span>",ModalFactory.create({type:ModalFactory.types.SAVE_CANCEL,body:template,title:titlePromise,buttons:{save:titlePromise},removeOnClose:!0}).then((function(modal){return modal.getRoot().on(ModalEvents.save,(function(){return self.submitPopup(currentuserid,name)})),modal.show(),modal}))}))},submitPopup:function(currentuserid,name){var coursename=$('input[name*="'+name+'"]').val();if(0==coursename.length)return $('input[name*="'+name+'"]').parent().find(".error-block").show(),!1;var data={coursename:coursename,currentuserid:currentuserid};Ajax.call([{methodname:"local_petel_create_course_for_teacher",args:data,done:function(response){response.result&&Str.get_strings([{key:"waitcoursecreate",component:"local_petel"}]).done((function(strings){var template=strings[0],titlePromise=Str.get_string("createcourseteacher","local_petel");return ModalFactory.create({type:ModalFactory.types.ALERT,body:template,title:titlePromise,buttons:{cancel:Str.get_string("createcoursesubmit","local_petel")},removeOnClose:!0}).then((function(modal){return modal.show(),modal}))}))},fail:Notification.exception}])}}}));

//# sourceMappingURL=createcourse.min.js.map