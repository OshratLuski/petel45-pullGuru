define("local_diagnostic/question-list",["jquery","core/templates","core/ajax"],(function($,Templates,Ajax){class QuestionList{constructor(data,popupElement,adParams){this.data={...data},this.data.table=data.table,this.popupElement=popupElement,this.adParams=adParams}dataChange(){let objectLast=[];for(const[mid,clustertablebymid]of Object.entries(this.data.table)){let objectTable={rows:[],clusters:[],name:clustertablebymid.name,repocmid:clustertablebymid.repocmid,midurl:this.data.midurl,midfilename:this.data.midfilename,mid:this.data.mid,hasimportant:clustertablebymid.hasimportant},questionsIds=[];for(const[clusterkey,clustertable]of Object.entries(clustertablebymid.data)){for(const[partOfKey,value]of Object.entries(clustertable.table)){questionsIds.find((el=>el===partOfKey))||questionsIds.push(partOfKey);let findEl=objectTable.rows.find((obj=>obj.question===partOfKey));findEl?findEl.value.push({clasterId:clusterkey,clustername:clustertable.clustername,color:value.color,prc:value.prc}):objectTable.rows.push({question:partOfKey,qname:value.qname,repocmid:this.data.repocmid,slot:value.slot,number:value.number,important:value.important,qid:value.qid,value:[{clasterId:clusterkey,clustername:clustertable.clustername,color:value.color,prc:value.prc}]})}objectTable.clusters.push({name:clustertable.clustername,prc:clustertable.avg})}objectLast.push(objectTable)}return console.log(objectLast),{tabledata:objectLast}}addAction(bubbleObject){let self=this;$(`${self.popupElement} .question-list`).css("display","none"),$(`${self.popupElement} .q-lright-icon i`).removeClass("rotate-0"),$(document).ready((function(){$("html").off("click",`${self.popupElement} .question-list-button`),$("html").on("click",`${self.popupElement} .question-list-button`,(function(){let popiEl=$(`${self.popupElement} .q-lright-icon i`),questionListEl=$(`${self.popupElement} .question-list`);$(`${self.popupElement} .question-scroll-table`);if("block"!=questionListEl.css("display")){Ajax.call([{methodname:"local_diagnostic_user_table",args:{cmid:self.data.cmid,mid:self.data.mid}}])}questionListEl.toggle("slow",(function(){!function(){popiEl.toggleClass("rotate-0");let topBlockYPosition,topBlockXPosition=bubbleObject.documentWith-bubbleObject.topBlockWith-bubbleObject.topBlockRightSpace-$(`${self.popupElement} .question-list-block`).width()-7,windowWidth=$(window).width();topBlockYPosition=windowWidth>=1200&&windowWidth<1400?54:0;windowWidth>=1200&&(popiEl.hasClass("rotate-0")?(bubbleObject.changePositionCirclesZero(!0),bubbleObject.changePositionAllCircles(),bubbleObject.topBlockObj.changePosition(topBlockXPosition,topBlockYPosition),bubbleObject.bottomBlockItem.changePosition(topBlockXPosition)):(bubbleObject.changePositionCirclesZero(!1),bubbleObject.changePositionAllCircles(),bubbleObject.topBlockObj.changePosition(),bubbleObject.bottomBlockItem.changePosition()))}(),questionListEl.stop(!0),$(".list-table-p-tooltip").tooltip()}))})),$("html").on("click",`${self.popupElement} div.important-shifter-obj:not(.selected)`,(function(){if($(this).hasClass("allquestions")){let allhdrs=$(`${self.popupElement} td.list-table-p-tooltip`),allvals=$(`${self.popupElement} td.list-table-p-val`);allhdrs.removeClass("bold"),allhdrs.css("opacity",1),allvals.css("color",""),allvals.css("background-color","")}else{let otherhdrs=$(`${self.popupElement} td.list-table-p-tooltip:not(.importanthdr)`),othervals=$(`${self.popupElement} td.list-table-p-val:not(.importantval)`);$(`${self.popupElement} .importanthdr`).addClass("bold"),otherhdrs.css("opacity",.3),othervals.css("color","#fff"),othervals.css("background-color","#fff")}let selected=$(`${self.popupElement} div.important-shifter-obj.selected`);selected.removeClass("selected"),$(this).addClass("selected");let backgroundcolor=selected.css("background-color");$(this).css("background-color",backgroundcolor),selected.css("background-color","")}))}))}}return function(data,popupElement,adParams){let questionListItem=new QuestionList(data,popupElement,adParams),listData=questionListItem.dataChange();return listData.secondarylight=adParams[1].secondarylight,listData.light=adParams[1].light,listData.secondary=adParams[1].secondary,listData.primary=adParams[1].primary,listData.averagePercent={mediumlevel:data.yellow,hightlevel:data.green},Templates.render("local_diagnostic/list",listData).done((function(html){let listEl=$(`${popupElement} .question-list-block`);"hidden"==listEl.css("visibility")&&listEl.css("visibility","visible"),$(`${popupElement} .question-list`).html(html)})),questionListItem}}));

//# sourceMappingURL=question-list.min.js.map