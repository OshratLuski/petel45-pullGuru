function _typeof(a){"@babel/helpers - typeof";if("function"==typeof Symbol&&"symbol"==typeof Symbol.iterator){_typeof=function(a){return typeof a}}else{_typeof=function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a}}return _typeof(a)}(function(a){"use strict";if("function"==typeof define&&define.amd){define ("local_datatables/dataTables.scroller",["jquery","local_datatables/jquery.dataTables"],function(b){return a(b,window,document)})}else if("object"===("undefined"==typeof exports?"undefined":_typeof(exports))){module.exports=function(b,c){if(!b){b=window}if(!c||!c.fn.dataTable){c=require("local_datatables/jquery.dataTables")(b,c).$}return a(c,b,b.document)}}else{a(jQuery,window,document)}})(function(a,b,c){'use strict';var d=a.fn.dataTable,e=function(b,d){if(!(this instanceof e)){alert("Scroller warning: Scroller must be initialised with the 'new' keyword.");return}if(d===void 0){d={}}var f=a.fn.dataTable.Api(b);this.s={dt:f.settings()[0],dtApi:f,tableTop:0,tableBottom:0,redrawTop:0,redrawBottom:0,autoHeight:!0,viewportRows:0,stateTO:null,stateSaveThrottle:function stateSaveThrottle(){},drawTO:null,heights:{jump:null,page:null,virtual:null,scroll:null,row:null,viewport:null,labelFactor:1},topRowFloat:0,scrollDrawDiff:null,loaderVisible:!1,forceReposition:!1,baseRowTop:0,baseScrollTop:0,mousedown:!1,lastScrollTop:0};this.s=a.extend(this.s,e.oDefaults,d);this.s.heights.row=this.s.rowHeight;this.dom={force:c.createElement("div"),label:a("<div class=\"dts_label\">0</div>"),scroller:null,table:null,loader:null};if(this.s.dt.oScroller){return}this.s.dt.oScroller=this;this.construct()};a.extend(e.prototype,{measure:function measure(b){if(this.s.autoHeight){this._calcRowHeight()}var c=this.s.heights;if(c.row){c.viewport=this._parseHeight(a(this.dom.scroller).css("max-height"));this.s.viewportRows=parseInt(c.viewport/c.row,10)+1;this.s.dt._iDisplayLength=this.s.viewportRows*this.s.displayBuffer}var d=this.dom.label.outerHeight();c.labelFactor=(c.viewport-d)/c.scroll;if(b===void 0||b){this.s.dt.oInstance.fnDraw(!1)}},pageInfo:function pageInfo(){var a=this.s.dt,b=this.dom.scroller.scrollTop,c=a.fnRecordsDisplay(),d=Math.ceil(this.pixelsToRow(b+this.s.heights.viewport,!1,this.s.ani));return{start:Math.floor(this.pixelsToRow(b,!1,this.s.ani)),end:c<d?c-1:d-1}},pixelsToRow:function pixelsToRow(a,b,c){var d=a-this.s.baseScrollTop,e=c?(this._domain("physicalToVirtual",this.s.baseScrollTop)+d)/this.s.heights.row:d/this.s.heights.row+this.s.baseRowTop;return b||b===void 0?parseInt(e,10):e},rowToPixels:function rowToPixels(a,b,c){var d,e=a-this.s.baseRowTop;if(c){d=this._domain("virtualToPhysical",this.s.baseScrollTop);d+=e*this.s.heights.row}else{d=this.s.baseScrollTop;d+=e*this.s.heights.row}return b||b===void 0?parseInt(d,10):d},scrollToRow:function scrollToRow(b,c){var d=this,e=!1,f=this.rowToPixels(b),g=(this.s.displayBuffer-1)/2*this.s.viewportRows,h=b-g;if(0>h){h=0}if((f>this.s.redrawBottom||f<this.s.redrawTop)&&this.s.dt._iDisplayStart!==h){e=!0;f=this._domain("virtualToPhysical",b*this.s.heights.row);if(this.s.redrawTop<f&&f<this.s.redrawBottom){this.s.forceReposition=!0;c=!1}}if(c===void 0||c){this.s.ani=e;a(this.dom.scroller).animate({scrollTop:f},function(){setTimeout(function(){d.s.ani=!1},250)})}else{a(this.dom.scroller).scrollTop(f)}},construct:function construct(){var c=this,d=this.s.dtApi;if(!this.s.dt.oFeatures.bPaginate){this.s.dt.oApi._fnLog(this.s.dt,0,"Pagination must be enabled for Scroller");return}this.dom.force.style.position="relative";this.dom.force.style.top="0px";this.dom.force.style.left="0px";this.dom.force.style.width="1px";this.dom.scroller=a("div."+this.s.dt.oClasses.sScrollBody,this.s.dt.nTableWrapper)[0];this.dom.scroller.appendChild(this.dom.force);this.dom.scroller.style.position="relative";this.dom.table=a(">table",this.dom.scroller)[0];this.dom.table.style.position="absolute";this.dom.table.style.top="0px";this.dom.table.style.left="0px";a(d.table().container()).addClass("dts DTS");if(this.s.loadingIndicator){this.dom.loader=a("<div class=\"dataTables_processing dts_loading\">"+this.s.dt.oLanguage.sLoadingRecords+"</div>").css("display","none");a(this.dom.scroller.parentNode).css("position","relative").append(this.dom.loader)}this.dom.label.appendTo(this.dom.scroller);if(this.s.heights.row&&"auto"!=this.s.heights.row){this.s.autoHeight=!1}this.s.ingnoreScroll=!0;a(this.dom.scroller).on("scroll.dt-scroller",function(){c._scroll.call(c)});a(this.dom.scroller).on("touchstart.dt-scroller",function(){c._scroll.call(c)});a(this.dom.scroller).on("mousedown.dt-scroller",function(){c.s.mousedown=!0}).on("mouseup.dt-scroller",function(){c.s.labelVisible=!1;c.s.mousedown=!1;c.dom.label.css("display","none")});a(b).on("resize.dt-scroller",function(){c.measure(!1);c._info()});var f=!0,g=d.state.loaded();d.on("stateSaveParams.scroller",function(a,b,d){if(f&&g){d.scroller=g.scroller;f=!1}else{d.scroller={topRow:c.s.topRowFloat,baseScrollTop:c.s.baseScrollTop,baseRowTop:c.s.baseRowTop,scrollTop:c.s.lastScrollTop}}});if(g&&g.scroller){this.s.topRowFloat=g.scroller.topRow;this.s.baseScrollTop=g.scroller.baseScrollTop;this.s.baseRowTop=g.scroller.baseRowTop}this.measure(!1);c.s.stateSaveThrottle=c.s.dt.oApi._fnThrottle(function(){c.s.dtApi.state.save()},500);d.on("init.scroller",function(){c.measure(!1);c.s.scrollType="jump";c._draw();d.on("draw.scroller",function(){c._draw()})});d.on("preDraw.dt.scroller",function(){c._scrollForce()});d.on("destroy.scroller",function(){a(b).off("resize.dt-scroller");a(c.dom.scroller).off(".dt-scroller");a(c.s.dt.nTable).off(".scroller");a(c.s.dt.nTableWrapper).removeClass("DTS");a("div.DTS_Loading",c.dom.scroller.parentNode).remove();c.dom.table.style.position="";c.dom.table.style.top="";c.dom.table.style.left=""})},_calcRowHeight:function _calcRowHeight(){var b=this.s.dt,c=b.nTable,d=c.cloneNode(!1),e=a("<tbody/>").appendTo(d),f=a("<div class=\""+b.oClasses.sWrapper+" DTS\"><div class=\""+b.oClasses.sScrollWrapper+"\"><div class=\""+b.oClasses.sScrollBody+"\"></div></div></div>");a("tbody tr:lt(4)",c).clone().appendTo(e);var g=a("tr",e).length;if(1===g){e.prepend("<tr><td>&#160;</td></tr>");e.append("<tr><td>&#160;</td></tr>")}else{for(;3>g;g++){e.append("<tr><td>&#160;</td></tr>")}}a("div."+b.oClasses.sScrollBody,f).append(d);var h=this.s.dt.nHolding||c.parentNode;if(!a(h).is(":visible")){h="body"}f.find("input").removeAttr("name");f.appendTo(h);this.s.heights.row=a("tr",e).eq(1).outerHeight();f.remove()},_draw:function _draw(){var b=this,c=this.s.heights,d=this.dom.scroller.scrollTop,e=a(this.s.dt.nTable).height(),f=this.s.dt._iDisplayStart,g=this.s.dt._iDisplayLength,h=this.s.dt.fnRecordsDisplay();this.s.skip=!0;if((this.s.dt.bSorted||this.s.dt.bFiltered)&&0===f&&!this.s.dt._drawHold){this.s.topRowFloat=0}d="jump"===this.s.scrollType?this._domain("virtualToPhysical",this.s.topRowFloat*c.row):d;this.s.baseScrollTop=d;this.s.baseRowTop=this.s.topRowFloat;var i=d-(this.s.topRowFloat-f)*c.row;if(0===f){i=0}else if(f+g>=h){i=c.scroll-e}this.dom.table.style.top=i+"px";this.s.tableTop=i;this.s.tableBottom=e+this.s.tableTop;var j=(d-this.s.tableTop)*this.s.boundaryScale;this.s.redrawTop=d-j;this.s.redrawBottom=d+j>c.scroll-c.viewport-c.row?c.scroll-c.viewport-c.row:d+j;this.s.skip=!1;if(this.s.dt.oFeatures.bStateSave&&null!==this.s.dt.oLoadedState&&"undefined"!=typeof this.s.dt.oLoadedState.scroller){var k=(this.s.dt.sAjaxSource||b.s.dt.ajax)&&!this.s.dt.oFeatures.bServerSide?!0:!1;if(k&&2==this.s.dt.iDraw||!k&&1==this.s.dt.iDraw){setTimeout(function(){a(b.dom.scroller).scrollTop(b.s.dt.oLoadedState.scroller.scrollTop);setTimeout(function(){b.s.ingnoreScroll=!1},0)},0)}}else{b.s.ingnoreScroll=!1}if(this.s.dt.oFeatures.bInfo){setTimeout(function(){b._info.call(b)},0)}if(this.dom.loader&&this.s.loaderVisible){this.dom.loader.css("display","none");this.s.loaderVisible=!1}},_domain:function _domain(a,b){var d=this.s.heights,e,f=1e4;if(d.virtual===d.scroll){return b}if(b<f){return b}else if("virtualToPhysical"===a&&b>=d.virtual-f){e=d.virtual-b;return d.scroll-e}else if("physicalToVirtual"===a&&b>=d.scroll-f){e=d.scroll-b;return d.virtual-e}var g=(d.virtual-f-f)/(d.scroll-f-f),h=f-g*f;return"virtualToPhysical"===a?(b-h)/g:g*b+h},_info:function _info(){if(!this.s.dt.oFeatures.bInfo){return}var b=this.s.dt,c=b.oLanguage,d=this.dom.scroller.scrollTop,e=Math.floor(this.pixelsToRow(d,!1,this.s.ani)+1),f=b.fnRecordsTotal(),g=b.fnRecordsDisplay(),h=Math.ceil(this.pixelsToRow(d+this.s.heights.viewport,!1,this.s.ani)),j=g<h?g:h,k=b.fnFormatNumber(e),l=b.fnFormatNumber(j),m=b.fnFormatNumber(f),o=b.fnFormatNumber(g),p;if(0===b.fnRecordsDisplay()&&b.fnRecordsDisplay()==b.fnRecordsTotal()){p=c.sInfoEmpty+c.sInfoPostFix}else if(0===b.fnRecordsDisplay()){p=c.sInfoEmpty+" "+c.sInfoFiltered.replace("_MAX_",m)+c.sInfoPostFix}else if(b.fnRecordsDisplay()==b.fnRecordsTotal()){p=c.sInfo.replace("_START_",k).replace("_END_",l).replace("_MAX_",m).replace("_TOTAL_",o)+c.sInfoPostFix}else{p=c.sInfo.replace("_START_",k).replace("_END_",l).replace("_MAX_",m).replace("_TOTAL_",o)+" "+c.sInfoFiltered.replace("_MAX_",b.fnFormatNumber(b.fnRecordsTotal()))+c.sInfoPostFix}var q=c.fnInfoCallback;if(q){p=q.call(b.oInstance,b,e,j,f,g,p)}var r=b.aanFeatures.i;if("undefined"!=typeof r){for(var n=0,s=r.length;n<s;n++){a(r[n]).html(p)}}a(b.nTable).triggerHandler("info.dt")},_parseHeight:function _parseHeight(c){var d,e=/^([+-]?(?:\d+(?:\.\d+)?|\.\d+))(px|em|rem|vh)$/.exec(c);if(null===e){return 0}var f=parseFloat(e[1]),g=e[2];if("px"===g){d=f}else if("vh"===g){d=f/100*a(b).height()}else if("rem"===g){d=f*parseFloat(a(":root").css("font-size"))}else if("em"===g){d=f*parseFloat(a("body").css("font-size"))}return d?d:0},_scroll:function _scroll(){var b=this,c=this.s.heights,d=this.dom.scroller.scrollTop,e;if(this.s.skip){return}if(this.s.ingnoreScroll){return}if(d===this.s.lastScrollTop){return}if(this.s.dt.bFiltered||this.s.dt.bSorted){this.s.lastScrollTop=0;return}this._info();clearTimeout(this.s.stateTO);this.s.stateTO=setTimeout(function(){b.s.dtApi.state.save()},250);this.s.scrollType=Math.abs(d-this.s.lastScrollTop)>c.viewport?"jump":"cont";this.s.topRowFloat="cont"===this.s.scrollType?this.pixelsToRow(d,!1,!1):this._domain("physicalToVirtual",d)/c.row;if(0>this.s.topRowFloat){this.s.topRowFloat=0}if(this.s.forceReposition||d<this.s.redrawTop||d>this.s.redrawBottom){var f=Math.ceil((this.s.displayBuffer-1)/2*this.s.viewportRows);e=parseInt(this.s.topRowFloat,10)-f;this.s.forceReposition=!1;if(0>=e){e=0}else if(e+this.s.dt._iDisplayLength>this.s.dt.fnRecordsDisplay()){e=this.s.dt.fnRecordsDisplay()-this.s.dt._iDisplayLength;if(0>e){e=0}}else if(0!=e%2){e++}this.s.targetTop=e;if(e!=this.s.dt._iDisplayStart){this.s.tableTop=a(this.s.dt.nTable).offset().top;this.s.tableBottom=a(this.s.dt.nTable).height()+this.s.tableTop;var g=function(){b.s.dt._iDisplayStart=b.s.targetTop;b.s.dt.oApi._fnDraw(b.s.dt)};if(this.s.dt.oFeatures.bServerSide){this.s.forceReposition=!0;clearTimeout(this.s.drawTO);this.s.drawTO=setTimeout(g,this.s.serverWait)}else{g()}if(this.dom.loader&&!this.s.loaderVisible){this.dom.loader.css("display","block");this.s.loaderVisible=!0}}}else{this.s.topRowFloat=this.pixelsToRow(d,!1,!0)}this.s.lastScrollTop=d;this.s.stateSaveThrottle();if("jump"===this.s.scrollType&&this.s.mousedown){this.s.labelVisible=!0}if(this.s.labelVisible){this.dom.label.html(this.s.dt.fnFormatNumber(parseInt(this.s.topRowFloat,10)+1)).css("top",d+d*c.labelFactor).css("display","block")}},_scrollForce:function _scrollForce(){var a=this.s.heights,b=1e6;a.virtual=a.row*this.s.dt.fnRecordsDisplay();a.scroll=a.virtual;if(a.scroll>b){a.scroll=b}this.dom.force.style.height=a.scroll>this.s.heights.row?a.scroll+"px":this.s.heights.row+"px"}});e.defaults={boundaryScale:.5,displayBuffer:9,loadingIndicator:!1,rowHeight:"auto",serverWait:200};e.oDefaults=e.defaults;e.version="2.0.3";a(c).on("preInit.dt.dtscroller",function(b,c){if("dt"!==b.namespace){return}var f=c.oInit.scroller,g=d.defaults.scroller;if(f||g){var h=a.extend({},f,g);if(!1!==f){new e(c,h)}}});a.fn.dataTable.Scroller=e;a.fn.DataTable.Scroller=e;var f=a.fn.dataTable.Api;f.register("scroller()",function(){return this});f.register("scroller().rowToPixels()",function(a,b,c){var d=this.context;if(d.length&&d[0].oScroller){return d[0].oScroller.rowToPixels(a,b,c)}});f.register("scroller().pixelsToRow()",function(a,b,c){var d=this.context;if(d.length&&d[0].oScroller){return d[0].oScroller.pixelsToRow(a,b,c)}});f.register(["scroller().scrollToRow()","scroller.toPosition()"],function(a,b){this.iterator("table",function(c){if(c.oScroller){c.oScroller.scrollToRow(a,b)}});return this});f.register("row().scrollTo()",function(a){var b=this;this.iterator("row",function(c,d){if(c.oScroller){var e=b.rows({order:"applied",search:"applied"}).indexes().indexOf(d);c.oScroller.scrollToRow(e,a)}});return this});f.register("scroller.measure()",function(a){this.iterator("table",function(b){if(b.oScroller){b.oScroller.measure(a)}});return this});f.register("scroller.page()",function(){var a=this.context;if(a.length&&a[0].oScroller){return a[0].oScroller.pageInfo()}});return e});
//# sourceMappingURL=dataTables.scroller.min.js.map
