{"version":3,"file":"custombuttons.min.js","sources":["../src/custombuttons.js"],"sourcesContent":["/* eslint-disable no-console */\n// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Javascript controller for the \"Actions\" panel at the bottom of the page.\n *\n * @module     community_sharewith/custombuttons\n * @package\n * @copyright  2018 Devlion <info@devlion.co>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n * @since      3.6\n */\n\ndefine([\n    'jquery',\n    'core/ajax',\n    'core/notification',\n    'core/templates',\n    'community_sharewith/modal',\n    'community_sharewith/storage'\n], function ($, Ajax, Notification, Templates, modal, St) {\n\n    /** @alias module:community_sharewith/sharewithteacher */\n    return {\n\n        resultBlock: '',\n        tagWrapper: '',\n        input: '',\n\n        init: function () {\n\n            var root = modal.modalWrapper;\n            root.addEventListener('click', function (e) {\n                var target = e.target;\n                while (root.contains(target)) {\n                    switch (target.dataset.handler) {\n                        case 'petelMessage':\n                            this.petelMessage();\n                            break;\n                        case 'toWhatsapp':\n                            this.toWhatsapp();\n                            break;\n                        case 'copyToClipboard':\n                            this.copyToClipboard();\n                            break;\n                    }\n                    target = target.parentNode;\n                }\n            }.bind(this));\n\n            $('#modalSharewith').on('hide.bs.modal', function () {\n                if (document.querySelector('.copytoclipboard_alert')) {\n                    $('.copytoclipboard_alert').alert('close');\n                }\n            });\n        },\n\n        petelMessage: function () {\n            let url = M.cfg.wwwroot + '/local/resourcenotif/resourcenotif.php?id=' + St.cmid;\n\n            let win = window.open(url, '_blank');\n            if (win) {\n                // Browser has allowed it to be opened.\n                win.focus();\n            }\n        },\n\n        toWhatsapp: function () {\n            let text = St.cmlink;\n            let url = 'https://api.whatsapp.com/send/?text=' + text + '&type=custom_url&app_absent=0';\n\n            let win = window.open(url, '_blank');\n            if (win) {\n                // Browser has allowed it to be opened.\n                win.focus();\n            }\n        },\n\n        copyToClipboard: function () {\n            let text = St.cmlink;\n            let context = {};\n\n            navigator.clipboard.writeText(text).then(\n                () => {\n                    return Templates.render('community_sharewith/copytoclipboard_alert', context)\n                        .done(function (html, js) {\n                            Templates.appendNodeContents('body', html, js);\n\n                            setTimeout(() => {\n                                $('.copytoclipboard_alert').alert('close');\n                            }, 2000);\n\n\n                        })\n                        .fail(Notification.exception);\n                }, () => {});\n        },\n    };\n});\n"],"names":["define","$","Ajax","Notification","Templates","modal","St","resultBlock","tagWrapper","input","init","root","modalWrapper","addEventListener","e","target","contains","dataset","handler","petelMessage","toWhatsapp","copyToClipboard","parentNode","bind","this","on","document","querySelector","alert","url","M","cfg","wwwroot","cmid","win","window","open","focus","cmlink","text","context","navigator","clipboard","writeText","then","render","done","html","js","appendNodeContents","setTimeout","fail","exception"],"mappings":";;;;;;;;;AA0BAA,2CAAO,CACH,SACA,YACA,oBACA,iBACA,4BACA,gCACD,SAAUC,EAAGC,KAAMC,aAAcC,UAAWC,MAAOC,UAG3C,CAEHC,YAAa,GACbC,WAAY,GACZC,MAAO,GAEPC,KAAM,eAEEC,KAAON,MAAMO,aACjBD,KAAKE,iBAAiB,QAAS,SAAUC,WACjCC,OAASD,EAAEC,OACRJ,KAAKK,SAASD,SAAS,QAClBA,OAAOE,QAAQC,aACd,oBACIC,yBAEJ,kBACIC,uBAEJ,uBACIC,kBAGbN,OAASA,OAAOO,aAEtBC,KAAKC,OAEPvB,EAAE,mBAAmBwB,GAAG,iBAAiB,WACjCC,SAASC,cAAc,2BACvB1B,EAAE,0BAA0B2B,MAAM,aAK9CT,aAAc,eACNU,IAAMC,EAAEC,IAAIC,QAAU,6CAA+C1B,GAAG2B,KAExEC,IAAMC,OAAOC,KAAKP,IAAK,UACvBK,KAEAA,IAAIG,SAIZjB,WAAY,eAEJS,IAAM,uCADCvB,GAAGgC,OAC4C,gCAEtDJ,IAAMC,OAAOC,KAAKP,IAAK,UACvBK,KAEAA,IAAIG,SAIZhB,gBAAiB,eACTkB,KAAOjC,GAAGgC,OACVE,QAAU,GAEdC,UAAUC,UAAUC,UAAUJ,MAAMK,MAChC,IACWxC,UAAUyC,OAAO,4CAA6CL,SAChEM,MAAK,SAAUC,KAAMC,IAClB5C,UAAU6C,mBAAmB,OAAQF,KAAMC,IAE3CE,YAAW,KACPjD,EAAE,0BAA0B2B,MAAM,WACnC,QAINuB,KAAKhD,aAAaiD,aACxB"}