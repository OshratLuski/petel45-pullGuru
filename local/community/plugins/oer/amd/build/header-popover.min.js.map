{"version":3,"file":"header-popover.min.js","sources":["../src/header-popover.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Shows the header menu content in a popover.\n *\n * @module     theme_boost/footer-popover\n * @copyright  2023 Devlion.co\n\n */\n\nimport $ from 'jquery';\nimport Popover from 'theme_boost/popover';\n\nconst SELECTORS = {\n    HEADERCONTAINER: 'nav.navbar .primary-navigation',\n    HEADERCONTENT: '[data-region=\"header-content-popover\"]',\n    HEADERBUTTON: '.oer-popup-btn'\n};\n\nlet footerIsShown = false;\n\nexport const init = () => {\n    const container = document.querySelector(SELECTORS.HEADERCONTAINER);\n    const HEADERBUTTON = document.querySelector(SELECTORS.HEADERBUTTON);\n\n    // All jQuery in this code can be replaced when MDL-71979 is integrated.\n    $(HEADERBUTTON).popover({\n        content: getContent,\n        container: container,\n        html: true,\n        placement: 'bottom',\n        //customClass: 'footer',\n        trigger: 'click'\n    });\n\n    document.addEventListener('click', e => {\n            if (footerIsShown && !e.target.closest(SELECTORS.HEADERCONTAINER)) {\n                $(HEADERBUTTON).popover('hide');\n            }\n        },\n        true);\n\n    document.addEventListener('keydown', e => {\n        if (footerIsShown && e.key === 'Escape') {\n            $(HEADERBUTTON).popover('hide');\n            HEADERBUTTON.focus();\n        }\n    });\n\n    document.addEventListener('focus', e => {\n            if (footerIsShown && !e.target.closest(SELECTORS.HEADERCONTAINER)) {\n                $(HEADERBUTTON).popover('hide');\n            }\n        },\n        true);\n\n    $(HEADERBUTTON).on('shown.bs.popover', () => {\n        footerIsShown = true;\n        let popoverBody = document.querySelector('.popover-body');\n        let listTitleIcons = popoverBody.querySelectorAll('.oer-popup-list-title-icon');\n        let listItemIcons = popoverBody.querySelectorAll('.oer-popup-list-item-icon');\n        listTitleIcons.forEach((el) => {\n            el.style.backgroundImage = `url(${el.title})`;\n            el.removeAttribute('title');\n        });\n        listItemIcons.forEach((el) => {\n            el.style.backgroundImage = `url(${el.title})`;\n            el.removeAttribute('title');\n        });\n    });\n\n    $(HEADERBUTTON).on('hide.bs.popover', () => {\n        footerIsShown = false;\n    });\n};\n\n/**\n * Get the footer content for popover.\n *\n * @returns {String} HTML string\n * @private\n */\nconst getContent = () => {\n    return document.querySelector(SELECTORS.HEADERCONTENT).innerHTML;\n};\n\nexport {\n    Popover\n};\n"],"names":["SELECTORS","footerIsShown","container","document","querySelector","HEADERBUTTON","popover","content","getContent","html","placement","trigger","addEventListener","e","target","closest","key","focus","on","popoverBody","listTitleIcons","querySelectorAll","listItemIcons","forEach","el","style","backgroundImage","title","removeAttribute","innerHTML"],"mappings":"+cA0BMA,0BACe,iCADfA,wBAEa,yCAFbA,uBAGY,qBAGdC,eAAgB,gBAEA,WACVC,UAAYC,SAASC,cAAcJ,2BACnCK,aAAeF,SAASC,cAAcJ,4CAG1CK,cAAcC,QAAQ,CACpBC,QAASC,WACTN,UAAWA,UACXO,MAAM,EACNC,UAAW,SAEXC,QAAS,UAGbR,SAASS,iBAAiB,SAASC,IACvBZ,gBAAkBY,EAAEC,OAAOC,QAAQf,gDACjCK,cAAcC,QAAQ,WAGhC,GAEJH,SAASS,iBAAiB,WAAWC,IAC7BZ,eAA2B,WAAVY,EAAEG,0BACjBX,cAAcC,QAAQ,QACxBD,aAAaY,YAIrBd,SAASS,iBAAiB,SAASC,IACvBZ,gBAAkBY,EAAEC,OAAOC,QAAQf,gDACjCK,cAAcC,QAAQ,WAGhC,uBAEFD,cAAca,GAAG,oBAAoB,KACnCjB,eAAgB,MACZkB,YAAchB,SAASC,cAAc,iBACrCgB,eAAiBD,YAAYE,iBAAiB,8BAC9CC,cAAgBH,YAAYE,iBAAiB,6BACjDD,eAAeG,SAASC,KACpBA,GAAGC,MAAMC,8BAAyBF,GAAGG,WACrCH,GAAGI,gBAAgB,YAEvBN,cAAcC,SAASC,KACnBA,GAAGC,MAAMC,8BAAyBF,GAAGG,WACrCH,GAAGI,gBAAgB,mCAIzBvB,cAAca,GAAG,mBAAmB,KAClCjB,eAAgB,YAUlBO,WAAa,IACRL,SAASC,cAAcJ,yBAAyB6B"}