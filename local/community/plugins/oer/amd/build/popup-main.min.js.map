{"version":3,"file":"popup-main.min.js","sources":["../src/popup-main.js"],"sourcesContent":["define([\n    'jquery',\n    'core/str',\n    'core/notification',\n    'community_oer/activity',\n    'community_oer/popup-question',\n    'community_oer/sequence',\n    'community_oer/course'\n\n], function ($, Str, Notification, Activity, Question, Sequence, Course) {\n    `use strict`;\n\n    let instance_data = {};\n    let preset_data = {};\n    let current_dashboard = null;\n    let current_aside = {};\n    let prev_search = [];\n    let url_params = {};\n\n    return {\n        init: function (dashboard, type, value) {\n            let self = this;\n\n            // Get url params.\n            let res = window.location.href.split(\"?\");\n            if(res[1] !== undefined){\n                let str = '&' + res[1];\n                str.replace(/[?&]+([^=&]+)=([^&]*)/gi,\n                    function(m,key,value) {\n                        url_params[key] = value;\n                    });\n            }\n\n            current_aside.render_aside = true;\n            current_aside.type = type;\n            current_aside.value = value;\n            current_aside.url_params = url_params;\n\n            // Hide header block.\n            $('#page-header').addClass('d-none');\n\n            // Default dashboard start.\n            this.buildDasboard(dashboard);\n\n            // Enter on search input.\n            $('#search_form').find('input').val('');\n            $('#search_form').submit(function(e){\n                e.preventDefault();\n\n                let target = $('#search_form').find('input');\n\n                if(target.val().trim().length > 0){\n\n                    $(target).data(\"value\", target.val().trim());\n                    $('#search_form').find('input').val('');\n\n                    switch (current_dashboard) {\n                        case 'activity':\n                            Activity.actionOnClick(target);\n                            preset_data.activity = Activity.returnPreset();\n                            break;\n\n                        case 'question':\n                            Question.actionOnClick(target);\n                            preset_data.question = Question.returnPreset();\n                            break;\n\n                        case 'sequence':\n                            Sequence.actionOnClick(target);\n                            preset_data.sequence = Sequence.returnPreset();\n                            break;\n\n                        case 'course':\n                            Course.actionOnClick(target);\n                            preset_data.course = Course.returnPreset();\n                            break;\n                    }\n                }\n            });\n\n            // Click on main-area.\n            $( \".main-area\" ).on( \"click\", function(e) {\n                let target = $(e.target).data();\n\n                // Side menu.\n                switch (target.area) {\n                    case 'sidemenu':\n                        current_aside.render_aside = true;\n                        current_aside.type = target.action;\n                        current_aside.value = target.value;\n                        current_aside.url_params = url_params;\n                        break;\n                }\n\n                switch (target.plugin) {\n                    case 'main':\n                        self.actionOnClick(e.target);\n                        preset_data.main = self.returnPreset();\n                        break;\n\n                    case 'activity':\n                        Activity.actionOnClick(e.target);\n                        preset_data.activity = Activity.returnPreset();\n                        break;\n\n                    case 'question':\n                        Question.actionOnClick(e.target);\n                        preset_data.question = Question.returnPreset();\n                        break;\n\n                    case 'sequence':\n                        Sequence.actionOnClick(e.target);\n                        preset_data.sequence = Sequence.returnPreset();\n                        break;\n\n                    case 'course':\n                        Course.actionOnClick(e.target);\n                        preset_data.course = Course.returnPreset();\n                        break;\n                }\n            });\n\n        },\n\n        buildDasboard: function (dashboard) {\n            let self = this;\n\n            // Dashboard start.\n            switch (dashboard) {\n                case 'activity':\n                    current_dashboard = 'activity';\n                    Activity.init(function(res){\n                        instance_data.activity = JSON.parse(res);\n\n                        // Render instance.\n                        Activity.renderInstance(instance_data.activity, current_aside, prev_search, preset_data.activity, function (){\n                            preset_data.activity = Activity.returnPreset();\n                        });\n                    });\n                    break;\n\n                case 'question':\n                    current_dashboard = 'question';\n                    Question.init(function(res){\n                        instance_data.question = JSON.parse(res);\n\n                        // Render instance.\n                        Question.renderInstance(instance_data.question, current_aside, prev_search, preset_data.question, function (){\n                            preset_data.question = Question.returnPreset();\n                        });\n                    });\n                    break;\n\n                case 'sequence':\n                    current_dashboard = 'sequence';\n                    Sequence.init(function(res){\n                        instance_data.sequence = JSON.parse(res);\n\n                        // Render instance.\n                        Sequence.renderInstance(instance_data.sequence, current_aside, prev_search, preset_data.sequence, function (){\n                            preset_data.sequence = Sequence.returnPreset();\n                        });\n                    });\n                    break;\n\n                case 'course':\n                    current_dashboard = 'course';\n                    Course.init(function(res){\n                        instance_data.course = JSON.parse(res);\n\n                        // Render instance.\n                        Course.renderInstance(instance_data.course, current_aside, prev_search, preset_data.course, function (){\n                            preset_data.course = Course.returnPreset();\n                        });\n                    });\n                    break;\n            }\n        },\n\n        actionOnClick: function (object) {\n            let data = $(object).data();\n\n            if(current_dashboard !== data.value) {\n\n                if (data.area !== 'mainsearch') {\n                    $('.main-filter-nav').find('a').removeClass('active');\n\n                    if($(object).hasClass('main-total-elements-question') || $(object).hasClass('main-total-elements-activity') || $(object).hasClass('main-total-elements-sequence') || $(object).hasClass('main-total-elements-course')){\n                        $(object).parent().addClass('active');\n                    }else{\n                        $(object).addClass('active');\n                    }\n                }\n\n                // Get current search data.\n                prev_search = [];\n                let elementssearch = $(\"*\").filter(function () {\n                    return ($(this).data(\"area\") === 'pillsearch');\n                });\n\n                $(elementssearch).each(function () {\n                    prev_search.push($(this).data(\"value\"));\n                });\n\n                this.buildDasboard(data.value);\n            }\n        },\n\n        returnPreset: function () {\n            return {};\n        },\n\n        changeTitleBreadcrumbs: function (title) {\n            $('.main-title').html(title);\n        },\n\n        reRerenderMain: function () {\n\n            let obj = $('.main-filter-nav').find('.active');\n\n            switch (obj.data(\"value\")) {\n                case 'activity':\n                    Activity.renderBlocks();\n                    break;\n\n                case 'question':\n                    Question.renderBlocks();\n                    break;\n\n                case 'sequence':\n                    Sequence.renderBlocks();\n                    break;\n\n                case 'course':\n                    Course.renderBlocks();\n                    break;\n            }\n\n            return true;\n        },\n\n    }\n});\n"],"names":["define","$","Str","Notification","Activity","Question","Sequence","Course","instance_data","preset_data","current_dashboard","current_aside","prev_search","url_params","init","dashboard","type","value","self","this","res","window","location","href","split","undefined","replace","m","key","render_aside","addClass","buildDasboard","find","val","submit","e","preventDefault","target","trim","length","data","actionOnClick","activity","returnPreset","question","sequence","course","on","area","action","plugin","main","JSON","parse","renderInstance","object","removeClass","hasClass","parent","elementssearch","filter","each","push","changeTitleBreadcrumbs","title","html","reRerenderMain","renderBlocks"],"mappings":"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"}