{"version":3,"file":"sequence.min.js","sources":["../src/sequence.js"],"sourcesContent":["define([\r\n    'jquery',\r\n    'core/yui',\r\n    'core/str',\r\n    'core/modal_factory',\r\n    'core/modal_events',\r\n    'core/ajax',\r\n    'core/templates',\r\n    'core/notification',\r\n\r\n], function ($, Y, Str, ModalFactory, ModalEvents, Ajax, Templates, Notification) {\r\n    `use strict`;\r\n\r\n    let SELECTORS = {\r\n        mainAside: '.main-aside',\r\n        mainDashboard: '.main-dashboard',\r\n        mainTitle: '.main-title',\r\n        filterPills: '.checked-option-pills',\r\n        filterButtonArea: '.activity-filters',\r\n        totalItems: '.total-sequences-block',\r\n        blockContent: '.sequence-blocks-content',\r\n        mainTotalElementsActivity: '.main-total-elements-activity',\r\n        mainTotalElementsQuestion: '.main-total-elements-question',\r\n        mainTotalElementsSequence: '.main-total-elements-sequence',\r\n        mainTotalElementsCourse: '.main-total-elements-course',\r\n    };\r\n\r\n    let current_aside_sequence = {};\r\n    let prev_search_sequence = {};\r\n    let default_filters_sequence = {};\r\n    let if_iframe = false;\r\n    let if_scroll_up = false;\r\n\r\n    return {\r\n        init: function (callback) {\r\n\r\n            // Get status of iframe.\r\n            if_iframe = $('#main-page-iframe').val();\r\n\r\n            // Get instance activity.\r\n            Ajax.call([{\r\n                methodname: 'community_oer_get_sequence_instance',\r\n                args: {},\r\n                done: function (response) {\r\n                    callback(response);\r\n                },\r\n                fail: Notification.exception\r\n            }]);\r\n        },\r\n\r\n        mergeInstanceWithPreset: function (instance_data, preset_data, callback) {\r\n            callback(instance_data);\r\n        },\r\n\r\n        renderInstance: function (instance_data, current_aside, prev_search, preset_data, callback) {\r\n            let self = this;\r\n\r\n            default_filters_sequence = instance_data.default_filters;\r\n            current_aside_sequence = current_aside;\r\n            prev_search_sequence = prev_search;\r\n\r\n            this.mergeInstanceWithPreset(instance_data, preset_data, function (data) {\r\n\r\n                // Render aside.\r\n                Templates.render('community_oer/sequence/aside', data)\r\n                    .done(function (html, js) {\r\n\r\n                        if (current_aside_sequence.render_aside) {\r\n                            Templates.replaceNodeContents(SELECTORS.mainAside, html, js);\r\n                        }\r\n\r\n                        // Render dashboard.\r\n                        Templates.render('community_oer/sequence/dashboard', data)\r\n                            .done(function (html, js) {\r\n                                Templates.replaceNodeContents(SELECTORS.mainDashboard, html, js);\r\n\r\n                                if (prev_search_sequence.length > 0) {\r\n                                    $.each(prev_search_sequence, function (index, value) {\r\n\r\n                                        // Set without split.\r\n                                        value = '\"' + value + '\"';\r\n\r\n                                        let param = value;\r\n                                        self.createPillSearch(param, value, function () {\r\n                                            self.defaultRenderBlocks();\r\n                                            callback();\r\n                                        });\r\n                                    });\r\n                                } else {\r\n                                    self.defaultRenderBlocks();\r\n                                    callback();\r\n                                }\r\n                            })\r\n                            .fail(Notification.exception);\r\n                    })\r\n                    .fail(Notification.exception);\r\n            });\r\n        },\r\n\r\n        defaultRenderBlocks: function () {\r\n            let self = this;\r\n\r\n            // Default filters\r\n            let filters = $(\"*\").filter(function () {\r\n                return ($(this).data(\"plugin\") === 'sequence' && $(this).data(\"area\") === 'filters');\r\n            });\r\n\r\n            $.each(default_filters_sequence , function(key, value) {\r\n                $(filters).each(function () {\r\n                    if($(this).data(\"action\") === value.filter && $(this).data(\"value\") === value.value){\r\n                        $(this).data(\"selected\", \"1\");\r\n                        $(this).prop('checked', true);\r\n                        let text = $(this).parent().find('label').html().trim();\r\n                        self.createPill($(this).attr(\"id\"), text);\r\n                    }\r\n                });\r\n            });\r\n\r\n            // Default render blocks.\r\n            let elements = $(\"*\").filter(function () {\r\n                return ($(this).data(\"plugin\") === 'sequence' && $(this).data(\"area\") === 'sidemenu');\r\n            });\r\n\r\n            $(elements).each(function () {\r\n                if ($(this).data(\"action\") === current_aside_sequence.type && $(this).data(\"value\") === current_aside_sequence.value) {\r\n                    $(this).click();\r\n                }\r\n            });\r\n        },\r\n\r\n        actionOnClick: function (object) {\r\n            let data = $(object).data();\r\n            let self = this;\r\n\r\n            if (data.area === 'sidemenu') {\r\n                let elements = $(\"*\").filter(function () {\r\n                    return ($(this).data(\"plugin\") === 'sequence' && $(this).data(\"area\") === 'sidemenu');\r\n                });\r\n\r\n                $(elements).each(function () {\r\n                    $(this).removeData(\"selected\");\r\n                });\r\n\r\n                $(object).data(\"selected\", \"1\");\r\n            }\r\n\r\n            if (data.area === 'filters') {\r\n                if ($(object).data(\"selected\") !== undefined) {\r\n                    $(object).removeData(\"selected\");\r\n                    this.removePill($(object).attr(\"id\"));\r\n                } else {\r\n                    $(object).data(\"selected\", \"1\");\r\n                    let text = $(object).parent().find('label').html().trim();\r\n                    this.createPill($(object).attr(\"id\"), text);\r\n                }\r\n            }\r\n\r\n            // Paging.\r\n            if (data.area === 'paging') {\r\n                let elements = $(\"*\").filter(function () {\r\n                    return ($(this).data(\"plugin\") === 'sequence' && $(this).data(\"area\") === 'paging');\r\n                });\r\n\r\n                $(elements).each(function () {\r\n                    $(this).data(\"selected\", 0);\r\n                });\r\n\r\n                $(object).data(\"selected\", \"1\");\r\n\r\n                if_scroll_up = true;\r\n            }\r\n\r\n            if (data.area !== 'paging') {\r\n                let elements = $(\"*\").filter(function () {\r\n                    return ($(this).data(\"plugin\") === 'sequence' && $(this).data(\"area\") === 'paging');\r\n                });\r\n\r\n                $(elements).each(function () {\r\n                    $(this).data(\"selected\", 0);\r\n                });\r\n            }\r\n\r\n            // Remove pill.\r\n            if (data.area === 'pill') {\r\n                let id = data.value;\r\n                $(SELECTORS.filterButtonArea).find(\"#\" + id).trigger('click');\r\n\r\n                // Remove button remove all pills.\r\n                let buttons = $(SELECTORS.filterPills).find('button');\r\n                if (buttons.length === 1) {\r\n                    buttons.remove();\r\n                }\r\n            }\r\n\r\n            // Remove pill search.\r\n            if (data.area === 'pillsearch') {\r\n                self.removePillSearch(object);\r\n            }\r\n\r\n            // Remove all pills.\r\n            if (data.area === 'removeallpills') {\r\n                let elements = $(\"*\").filter(function () {\r\n                    return ($(this).data(\"area\") === 'filters');\r\n                });\r\n\r\n                $(elements).each(function () {\r\n                    $(this).removeData(\"selected\");\r\n                    $(this).prop('checked', false);\r\n                    self.removePill($(this).attr(\"id\"));\r\n                });\r\n\r\n                let elementssearch = $(\"*\").filter(function () {\r\n                    return ($(this).data(\"area\") === 'pillsearch');\r\n                });\r\n\r\n                $(elementssearch).each(function () {\r\n                    self.removePillSearch(this);\r\n                });\r\n\r\n            }\r\n\r\n            if (data.area === 'sorting') {\r\n\r\n                let flag = true;\r\n                if (parseInt($(object).data(\"selected\")) === 1) {\r\n                    flag = false;\r\n                }\r\n\r\n                let elements = $(\"*\").filter(function () {\r\n                    return ($(this).data(\"plugin\") === 'sequence' && $(this).data(\"area\") === 'sorting');\r\n                });\r\n\r\n                $(elements).each(function () {\r\n                    $(this).data(\"selected\", '0');\r\n                });\r\n\r\n                if (flag) {\r\n                    $(object).data(\"selected\", '1');\r\n                }\r\n            }\r\n\r\n            if (data.area === 'mainsearch') {\r\n                let param = data.value;\r\n                this.createPillSearch(param, data.value, function () {\r\n                    self.renderBlocks();\r\n                });\r\n            } else {\r\n                this.renderBlocks();\r\n            }\r\n\r\n            // Change title breadcrumbs.\r\n            this.changeTitleBreadcrumbs(object);\r\n        },\r\n\r\n        returnPreset: function () {\r\n\r\n            // Get selected.\r\n            let selected = $(\"*\").filter(function () {\r\n                return ($(this).data(\"plugin\") === 'sequence' && ($(this).data(\"selected\") === '1' || $(this).data(\"selected\") === 1));\r\n            });\r\n\r\n            let dataselected = {};\r\n            $(selected).each(function (index) {\r\n                dataselected[index] = $(this).data();\r\n            });\r\n\r\n            return dataselected;\r\n        },\r\n\r\n        renderBlocks: function () {\r\n\r\n            let returnpreset = this.returnPreset();\r\n\r\n            // Remove block items.\r\n            $(SELECTORS.blockContent).find('.sequence-item').remove();\r\n            $(SELECTORS.blockContent).find('.pagination').remove();\r\n\r\n            // Render loading icon.\r\n            Templates.render('community_oer/loading', {})\r\n                .done(function (html, js) {\r\n                    Templates.replaceNodeContents(SELECTORS.blockContent, html, js);\r\n                })\r\n                .fail(Notification.exception);\r\n\r\n            Ajax.call([{\r\n                methodname: 'community_oer_get_sequence_blocks',\r\n                args: {\r\n                    presets: JSON.stringify(returnpreset)\r\n                },\r\n                done: function (response) {\r\n                    let result = JSON.parse(response);\r\n\r\n                    // Check if run in iframe.\r\n                    result.iframe = (parseInt(if_iframe) === 1);\r\n\r\n                    Str.get_strings([\r\n                        { key: 'resultsearch', component: 'community_oer' },\r\n                        { key: 'items', component: 'community_oer' },\r\n                    ]).done(function (strings) {\r\n\r\n                        // Update total activities.\r\n                        let str = strings[0] + ': ' + result.total_blocks + ' ' + strings[1];\r\n                        $(SELECTORS.totalItems).html(str);\r\n\r\n                        // Update total menu block.\r\n                        $(SELECTORS.mainTotalElementsActivity).html('(' + result.activity_total_all_blocks + ')');\r\n                        $(SELECTORS.mainTotalElementsQuestion).html('(' + result.question_total_all_blocks + ')');\r\n                        $(SELECTORS.mainTotalElementsSequence).html('(' + result.sequence_total_all_blocks + ')');\r\n                        $(SELECTORS.mainTotalElementsCourse).html('(' + result.course_total_all_blocks + ')');\r\n\r\n                        // Render blocks.\r\n                        Templates.render('community_oer/sequence/block', result)\r\n                            .done(function (html, js) {\r\n                                Templates.replaceNodeContents(SELECTORS.blockContent, html, js);\r\n\r\n                                if (if_scroll_up) {\r\n                                    const element = document.querySelector('.activity-block-header');\r\n                                    element.scrollIntoView({behavior: \"smooth\", block: \"end\", inline: \"nearest\"});\r\n                                    if_scroll_up = false;\r\n                                }\r\n\r\n                                callback();\r\n                            })\r\n                            .fail(Notification.exception);\r\n                    });\r\n                },\r\n                fail: Notification.exception\r\n            }]);\r\n        },\r\n\r\n        changeTitleBreadcrumbs: function (object) {\r\n            let title = $(object).data('breadcrumbs');\r\n            $(SELECTORS.mainTitle).html(title);\r\n        },\r\n\r\n        createPill: function (id, text) {\r\n\r\n            Str.get_strings([\r\n                { key: 'removeallpills', component: 'community_oer' },\r\n            ]).done(function (strings) {\r\n\r\n                let pillTarget = $(SELECTORS.filterPills);\r\n\r\n                // Add remove all.\r\n                if (!pillTarget.find('button').length) {\r\n                    let pillremoveall = $(`\r\n                    <button type=\"button\" data-plugin=\"sequence\" data-area=\"removeallpills\" class=\"removeallpills btn btn-secondary mr-3 py-1 px-3 mb-2\">\r\n                        ${strings[0]}                       \r\n                    </button>`);\r\n\r\n                    pillTarget.append(pillremoveall);\r\n                }\r\n\r\n                let pill = $(`\r\n                <div class=\"checked-option-pill rounded-pill bg-light text-primary border border-primary mr-3 py-1 px-3 mb-2\" data-id=\"${id}\">\r\n                    <span class=\"checked-option-pill-name\">${text}</span>\r\n                    <button type=\"button\" class=\"close ml-3\" aria-label=\"Close\">\r\n                        <span aria-hidden=\"true\" data-plugin=\"sequence\" data-area=\"pill\" data-value=\"${id}\">&times;</span>\r\n                    </button>\r\n                </div>`);\r\n\r\n                pillTarget.append(pill);\r\n            });\r\n        },\r\n\r\n        removePill: function (id) {\r\n            $(SELECTORS.filterPills).find(`[data-id=\"${id}\"]`).remove();\r\n\r\n            // Remove button remove all pills.\r\n            let buttons = $(SELECTORS.filterPills).find('button');\r\n            if (buttons.length === 1) {\r\n                buttons.remove();\r\n            }\r\n        },\r\n\r\n        createPillSearch: function (query, text, callback) {\r\n\r\n            Str.get_strings([\r\n                { key: 'removeallpills', component: 'community_oer' },\r\n            ]).done(function (strings) {\r\n\r\n                let pillTarget = $(SELECTORS.filterPills);\r\n\r\n                // Add remove all.\r\n                if (!pillTarget.find('button').length) {\r\n                    let pillremoveall = $(`\r\n                    <button type=\"button\" data-plugin=\"sequence\" data-area=\"removeallpills\" class=\"removeallpills btn btn-secondary mr-3 py-1 px-3 mb-2\">\r\n                        ${strings[0]}                       \r\n                    </button>`);\r\n\r\n                    pillTarget.append(pillremoveall);\r\n                }\r\n\r\n                let simpleword = false;\r\n                if (query.length > 0 && query[0] === '\"' && query[query.length - 1] === '\"') {\r\n                    simpleword = true;\r\n                    query = query.substring(1, query.length - 1);\r\n                }\r\n\r\n                if (simpleword) {\r\n                    let pill = $(`\r\n                        <div class=\"checked-option-pill search-pill rounded-pill bg-light text-primary border border-primary mr-3 py-1 px-3 mb-2\" data-id=\"${query}\">\r\n                            <span class=\"checked-option-pill-name\">${query}</span>\r\n                            <button type=\"button\" class=\"close ml-3\" aria-label=\"Close\">\r\n                                <span aria-hidden=\"true\" data-plugin=\"sequence\" data-area=\"pillsearch\" data-value=\"${query}\" data-selected=\"1\">&times;</span>\r\n                            </button>\r\n                        </div>`);\r\n\r\n                    pillTarget.append(pill);\r\n                } else {\r\n                    query.split(' ').forEach(function(value) {\r\n                        if (value.length > 0) {\r\n                            let pill = $(`\r\n                                <div class=\"checked-option-pill search-pill rounded-pill bg-light text-primary border border-primary mr-3 py-1 px-3 mb-2\" data-id=\"${value}\">\r\n                                    <span class=\"checked-option-pill-name\">${value}</span>\r\n                                    <button type=\"button\" class=\"close ml-3\" aria-label=\"Close\">\r\n                                        <span aria-hidden=\"true\" data-plugin=\"sequence\" data-area=\"pillsearch\" data-value=\"${value}\" data-selected=\"1\">&times;</span>\r\n                                    </button>\r\n                                </div>`);\r\n\r\n                            pillTarget.append(pill);\r\n                        }\r\n                    });\r\n                }\r\n\r\n                callback();\r\n            });\r\n        },\r\n\r\n        removePillSearch: function (object) {\r\n            $(object).parent().parent().remove();\r\n\r\n            // Remove button remove all pills.\r\n            let buttons = $(SELECTORS.filterPills).find('button');\r\n            if (buttons.length === 1) {\r\n                buttons.remove();\r\n            }\r\n        },\r\n\r\n\r\n        openDropdownMenuForBlock: function () {\r\n\r\n            let DROPDOWN_MENU = {};\r\n\r\n            $('.dropdown.copy-sequence-dropdown-wrapper').on('show.bs.dropdown', function () {\r\n                const target = $(this).parent();\r\n                renderDropdown(target.parent());\r\n            });\r\n\r\n            $('.dropdown.copy-sequence-dropdown-wrapper').on('hide.bs.dropdown', function () {\r\n                DROPDOWN_MENU = {};\r\n                const target = $(this).parent();\r\n                target.find('.copy-sequence-dropdown').html('');\r\n            });\r\n\r\n            $('.dropdown.copy-sequence-dropdown-wrapper .dropdown-menu').on('click', function (e) {\r\n                e.stopPropagation();\r\n            });\r\n\r\n            function renderDropdown(target) {\r\n\r\n                // Render loading icon.\r\n                Templates.render('community_oer/loading', {})\r\n                    .done(function (html, js) {\r\n                        Templates.replaceNodeContents(target.find('.copy-sequence-dropdown'), html, js);\r\n                    })\r\n                    .fail(Notification.exception);\r\n\r\n                Ajax.call([{\r\n                    methodname: 'community_oer_get_my_courses_and_sections',\r\n                    args: {},\r\n                    done: function (response) {\r\n                        renderCourses(JSON.parse(response), target);\r\n                    },\r\n                    fail: Notification.exception\r\n                }]);\r\n            }\r\n\r\n            function renderCourses(resp, target) {\r\n                Templates.render('community_oer/sequence/copy-sequence-dropdown', resp)\r\n                    .then(function (html, js) {\r\n                        Templates.replaceNodeContents(target.find('.copy-sequence-dropdown'), html, js);\r\n                        target.find('.preloading-wrapper').hide();\r\n                        target.find('.dropdown-courses').show();\r\n                        DROPDOWN_MENU.targetDropdown = target.find('.dropdown');\r\n                        DROPDOWN_MENU.courses = target.find('.dropdown-item.course-item');\r\n                        DROPDOWN_MENU.sections = target.find('.dropdown-item.section-item');\r\n                        DROPDOWN_MENU.closeBtn = target.find('button.close');\r\n                        DROPDOWN_MENU.backBtn = target.find('button.back');\r\n                        DROPDOWN_MENU.submitBtn = target.find('button.submit-btn');\r\n                        DROPDOWN_MENU.topArea = target.find('.drodpdown-menu-top');\r\n                        DROPDOWN_MENU.width = DROPDOWN_MENU.targetDropdown.outerWidth();\r\n                        DROPDOWN_MENU.strWidth = 1;\r\n                        dropdownActions(DROPDOWN_MENU);\r\n                        checkCourseWidth(DROPDOWN_MENU.courses);\r\n                    }).fail(function (ex) {\r\n                        console.log('ERROR');\r\n                    });\r\n            }\r\n\r\n            function checkCourseWidth(courses) {\r\n                DROPDOWN_MENU.strWidth = 1;\r\n                courses.each(function () {\r\n                    var width = $(this).find('span').outerWidth();\r\n                    if (width > DROPDOWN_MENU.strWidth) {\r\n                        DROPDOWN_MENU.strWidth = width + 30;\r\n                    }\r\n                });\r\n                if (DROPDOWN_MENU.strWidth > DROPDOWN_MENU.width) {\r\n                    DROPDOWN_MENU.targetDropdown.find('.copy-sequence-dropdown-inner').css('width', +DROPDOWN_MENU.strWidth + \"px\");\r\n                } else {\r\n                    DROPDOWN_MENU.targetDropdown.find('.copy-sequence-dropdown-inner').css('width', +DROPDOWN_MENU.width + \"px\");\r\n                }\r\n            }\r\n\r\n            function checkSectionWidth(sections) {\r\n                DROPDOWN_MENU.strWidth = 1;\r\n                var topAreaBtns = DROPDOWN_MENU.topArea.find('button');\r\n                var btnsWidth = 0;\r\n                topAreaBtns.each(function () {\r\n                    btnsWidth += Math.floor($(this).outerWidth());\r\n                });\r\n                var topAreaWidth = Math.floor(DROPDOWN_MENU.topArea.find('span').outerWidth()) + btnsWidth;\r\n                sections.each(function () {\r\n                    if ($(this).attr('style') != \"display: none;\") {\r\n                        var width = $(this).find('.section-item-name').outerWidth();\r\n                        if (width > DROPDOWN_MENU.strWidth) {\r\n                            DROPDOWN_MENU.strWidth = width + 60; // 60px it is paddings and icon width\r\n                        }\r\n                    }\r\n                });\r\n                if (+DROPDOWN_MENU.strWidth <= topAreaWidth) {\r\n                    DROPDOWN_MENU.targetDropdown.find('.copy-sequence-dropdown-inner').css('width', \"100%\");\r\n                } else if (+DROPDOWN_MENU.strWidth > +DROPDOWN_MENU.width) {\r\n                    DROPDOWN_MENU.targetDropdown.find('.copy-sequence-dropdown-inner').css('width', +DROPDOWN_MENU.strWidth + \"px\");\r\n                } else {\r\n                    DROPDOWN_MENU.targetDropdown.find('.copy-sequence-dropdown-inner').css('width', +DROPDOWN_MENU.width + \"px\");\r\n                }\r\n            }\r\n\r\n            function dropdownActions(target) {\r\n\r\n                /*                 target.courses.on('click', function () {\r\n                                    const courseid = $(this).data('id');\r\n                                    const course_name = $(this).text();\r\n                                    DROPDOWN_MENU.topArea.find('.drodpdown-menu-top-text').text(course_name);\r\n                                    if (courseid) {\r\n                                        target.courses.hide();\r\n                                        target.sections.each(function () {\r\n                                            if (+$(this).data('courseid') === +courseid) {\r\n                                                $(this).show();\r\n                                            }\r\n                                        });\r\n                                    }\r\n                                    target.backBtn.show();\r\n                                    checkSectionWidth(DROPDOWN_MENU.sections);\r\n\r\n                                }); */\r\n\r\n                /*                 target.sections.on('click', function () {\r\n                                    if (!$(this).hasClass('active')) {\r\n                                        target.sections.removeClass('active');\r\n                                        $(this).addClass('active');\r\n                                        target.submitBtn.show();\r\n                                    }\r\n                                    target.submitBtn.parent().show();\r\n                                }); */\r\n                target.courses.on('click', function () {\r\n                    if (!$(this).hasClass('active')) {\r\n                        target.courses.removeClass('active');\r\n                        $(this).addClass('active');\r\n                        target.submitBtn.show();\r\n                    }\r\n                    target.submitBtn.parent().show();\r\n                });\r\n\r\n                /*        target.backBtn.on('click', function (e) {\r\n                           var back = $(e.target);\r\n                           target.sections.removeClass('active');\r\n                           DROPDOWN_MENU.submitBtn.hide();\r\n                           DROPDOWN_MENU.topArea.find('.drodpdown-menu-top-text').text(DROPDOWN_MENU.topArea.data('text'));\r\n                           target.sections.hide();\r\n                           target.courses.show();\r\n                           back.hide();\r\n                           checkCourseWidth(DROPDOWN_MENU.courses);\r\n                       }); */\r\n\r\n                target.closeBtn.on('click', function (e) {\r\n                    target.sections.removeClass('active');\r\n                    DROPDOWN_MENU.targetDropdown.trigger('click');\r\n                });\r\n\r\n                target.submitBtn.on('click', function () {\r\n\r\n                    let button = $(this).parent().parent().parent().find('.copy-sequence-btn');\r\n                    let seqid = $(button).data('seqid');\r\n                    let courseid = $('.dropdown-item.course-item.active').data('id');\r\n\r\n                    Ajax.call([{\r\n                        methodname: 'community_oer_copy_sequence_to_course',\r\n                        args: {\r\n                            seqid: seqid,\r\n                            courseid: courseid,\r\n                        },\r\n                        done: function (response) {\r\n                            DROPDOWN_MENU.targetDropdown.dropdown('hide');\r\n\r\n                            $(button).removeClass('btn-primary');\r\n                            $(button).addClass('btn--white');\r\n                            $(button).find('span').text('הועתק לסביבה');\r\n\r\n                            Str.get_strings([\r\n                                { key: 'sequencecopy', component: 'community_oer' },\r\n                                { key: 'successcopybody', component: 'community_oer' },\r\n                                { key: 'approve', component: 'community_oer' },\r\n                            ]).done(function (strings) {\r\n                                ModalFactory.create({\r\n                                    type: ModalFactory.types.CANCEL,\r\n                                    title: strings[0],\r\n                                    body: strings[1]\r\n                                }).done(function (modal) {\r\n                                    modal.setButtonText('cancel', strings[2]);\r\n                                    modal.show();\r\n                                });\r\n                            });\r\n                        },\r\n                        fail: Notification.exception\r\n                    }]);\r\n                });\r\n\r\n            }\r\n\r\n        },\r\n\r\n        checkPosition: function (el) {\r\n            if ($(el).next().length == 0) {\r\n                $(el).closest('.nav.nav-tabs').find('.nav-control.next').addClass('disabled');\r\n\r\n            } else if ($(el).prev().length == 0) {\r\n                $(el).closest('.nav.nav-tabs').find('.nav-control.prev').addClass('disabled');\r\n            }\r\n            if ($(el).prev().length > 0) {\r\n                $(el).closest('.nav.nav-tabs').find('.nav-control.prev').removeClass('disabled');\r\n            }\r\n            if ($(el).next().length > 0) {\r\n                $(el).closest('.nav.nav-tabs').find('.nav-control.next').removeClass('disabled');\r\n            }\r\n\r\n\r\n        },\r\n\r\n        moveRight: function (el, dir) {\r\n            let parent = $(el).closest('.nav.nav-tabs .nav-tabs-wrapper');\r\n            let btnsLine = parent.find('.nav-tabs-inner');\r\n            let parentOffset = parent.offset();\r\n            let parentOffsetLeft = parentOffset.left;\r\n            let elOffset = $(el).offset();\r\n            let elOffsetLeft = +elOffset.left;\r\n            let elWidth = +$(el).width() + 4;\r\n            let parentWidth = parent.width();\r\n\r\n            if (dir == 'rtl' && parentOffsetLeft > elOffsetLeft) {\r\n                let num = parentOffsetLeft - elOffsetLeft;\r\n                let left = +btnsLine.css('left').replace(\"px\", \"\");\r\n                let newOffset = +left + num;\r\n                btnsLine.css('left', `${newOffset}` + 'px');\r\n                     btnsLine.css('right', 'unset');\r\n\r\n            } else if (dir == 'ltr' && parentWidth + parentOffsetLeft < elOffsetLeft + elWidth) {\r\n                let left = +btnsLine.css('left').replace(\"px\", \"\");\r\n                let num = (elOffsetLeft + elWidth) - (parentWidth + parentOffsetLeft);\r\n                let newOffset = +left - num;\r\n                btnsLine.css('left', `${newOffset}` + 'px');\r\n                btnsLine.css('right', 'unset');\r\n            }\r\n\r\n        },\r\n\r\n        moveLeft: function (el, dir) {\r\n            let parent = $(el).closest('.nav.nav-tabs .nav-tabs-wrapper');\r\n            let btnsLine = parent.find('.nav-tabs-inner');\r\n            let parentOffset = parent.offset();\r\n            let parentOffsetLeft = parentOffset.left;\r\n            let elOffset = $(el).offset();\r\n            let elOffsetLeft = elOffset.left;\r\n            let elWidth = +$(el).width() + 4;\r\n            let parentWidth = parent.width();\r\n\r\n            if (dir == 'rtl' && parentWidth + parentOffsetLeft < elOffsetLeft + elWidth) {\r\n                let left = +btnsLine.css('left').replace(\"px\", \"\");\r\n               let num = (elOffsetLeft + elWidth) - (parentWidth + parentOffsetLeft);\r\n                let newOffset = left - num;\r\n                btnsLine.css('left', `${newOffset}` + 'px');\r\n            } else if (dir == 'ltr' && parentOffsetLeft > elOffsetLeft) {\r\n                let left = +btnsLine.css('left').replace(\"px\", \"\");\r\n                let num = parentOffsetLeft - elOffsetLeft;\r\n                let newOffset = +left + num;\r\n                btnsLine.css('left', `${newOffset}` + 'px');\r\n\r\n            }\r\n        },\r\n\r\n        setActiveActivity: function (el) {\r\n            const dir = $('html').attr('dir');\r\n            $(el).siblings('.nav-link').not($(el)).removeClass('active');\r\n            this.checkPosition($(el));\r\n\r\n      /*       this.moveRight(el, dir);\r\n            this.moveLeft(el, dir); */\r\n        },\r\n\r\n        changeActivity: function (el) {\r\n\r\n            let direction = $(el).data('direction');\r\n            const dir = $('html').attr('dir');\r\n\r\n            let currentItem = $(el).closest('.nav.nav-tabs').find('.nav-tabs-inner .nav-link.active');\r\n            let prevItem = currentItem.prev();\r\n            let nextItem = currentItem.next();\r\n\r\n            if (direction == 'next' && nextItem.length > 0) {\r\n                nextItem.siblings('.nav-link')/* .not(currentItem) */.removeClass('active');\r\n                nextItem.tab('show');\r\n                this.checkPosition(nextItem);\r\n                this.moveRight(nextItem, dir);\r\n\r\n            } else if (direction == 'prev' && prevItem.length > 0) {\r\n                prevItem.siblings('.nav-link')/* .not(currentItem) */.removeClass('active');\r\n                prevItem.tab('show');\r\n                this.checkPosition(prevItem);\r\n                this.moveLeft(prevItem, dir);\r\n            }\r\n\r\n        },\r\n\r\n        singlePage: function (cmid) {\r\n\r\n            Ajax.call([{\r\n                methodname: 'community_oer_sequence_get_single_page',\r\n                args: {\r\n                    cmid: cmid\r\n                },\r\n                done: function (response) {\r\n                    let data = JSON.parse(response);\r\n\r\n                    if(Object.keys(data).length) {\r\n                        Templates.render('community_oer/sequence/single-cm', data)\r\n                            .done(function (html, js) {\r\n                                Templates.prependNodeContents('#page-content', html, js);\r\n\r\n                                $('#page-header div').html('');\r\n                                $('.header.backto').hide();\r\n                                $('#topofscroll').addClass('wider');\r\n                            })\r\n                            .fail(Notification.exception);\r\n                    }\r\n                },\r\n                fail: Notification.exception\r\n            }]);\r\n\r\n        }\r\n    };\r\n});\r\n"],"names":["define","$","Y","Str","ModalFactory","ModalEvents","Ajax","Templates","Notification","SELECTORS","current_aside_sequence","prev_search_sequence","default_filters_sequence","if_iframe","if_scroll_up","init","callback","val","call","methodname","args","done","response","fail","exception","mergeInstanceWithPreset","instance_data","preset_data","renderInstance","current_aside","prev_search","self","this","default_filters","data","render","html","js","render_aside","replaceNodeContents","length","each","index","value","param","createPillSearch","defaultRenderBlocks","filters","filter","key","prop","text","parent","find","trim","createPill","attr","elements","type","click","actionOnClick","object","area","removeData","undefined","removePill","id","trigger","buttons","remove","removePillSearch","elementssearch","flag","parseInt","renderBlocks","changeTitleBreadcrumbs","returnPreset","selected","dataselected","returnpreset","presets","JSON","stringify","result","parse","iframe","get_strings","component","strings","str","total_blocks","activity_total_all_blocks","question_total_all_blocks","sequence_total_all_blocks","course_total_all_blocks","document","querySelector","scrollIntoView","behavior","block","inline","title","pillTarget","pillremoveall","append","pill","query","simpleword","substring","split","forEach","openDropdownMenuForBlock","DROPDOWN_MENU","on","target","resp","then","courses","hide","show","targetDropdown","sections","closeBtn","backBtn","submitBtn","topArea","width","outerWidth","strWidth","hasClass","removeClass","addClass","e","button","seqid","courseid","dropdown","create","types","CANCEL","body","modal","setButtonText","dropdownActions","css","ex","console","log","renderCourses","renderDropdown","stopPropagation","checkPosition","el","next","closest","prev","moveRight","dir","btnsLine","parentOffsetLeft","offset","left","elOffsetLeft","elWidth","parentWidth","num","newOffset","replace","moveLeft","setActiveActivity","siblings","not","changeActivity","direction","currentItem","prevItem","nextItem","tab","singlePage","cmid","Object","keys","prependNodeContents"],"mappings":"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"}