define("community_oer/popup-copy-questions",["jquery","core/str","core/modal_factory","core/modal_events","core/ajax","core/templates","core/notification","core/fragment"],(function($,Str,ModalFactory,ModalEvents,Ajax,Templates,Notification,Fragment){var uniqueid,SELECTORS_buttonEvent=".addquestionfromoer";return{init:function(currentcourseid,currentcoursecontext){var getBody=function(coursemoduleid){uniqueid=Date.now(),coursemoduleid;var params={cmid:coursemoduleid,uniqueid:uniqueid};return Fragment.loadFragment("community_oer","copy_questions_from_catalog",currentcoursecontext,params)};$(SELECTORS_buttonEvent).on("click",(function(e){e.preventDefault();var cmid=$(this).data("cmid");Str.get_strings([{key:"copyquestionsfromoer",component:"community_oer"},{key:"qshare",component:"community_oer"}]).done((function(strings){var modalPromise=ModalFactory.create({type:ModalFactory.types.SAVE_CANCEL,title:strings[0],body:getBody(cmid)});$.when(modalPromise).then((function(fmodal){fmodal.setSaveButtonText(strings[1]),fmodal.getRoot().on(ModalEvents.save,(function(e){e.preventDefault();var selected=JSON.parse($("#questions_selected").val());selected.length?(fmodal.destroy(),Str.get_strings([{key:"popupmessagesuccesstitle",component:"community_oer"},{key:"popupmessagesuccesscontent",component:"community_oer"},{key:"popupbuttondisabled",component:"community_oer"},{key:"popupbuttonenabled",component:"community_oer"}]).done((function(strings){var modalPromise=ModalFactory.create({type:ModalFactory.types.ALERT,title:strings[0],body:strings[1]});$.when(modalPromise).then((function(fmodal){fmodal.show();var root=fmodal.getRoot();return root.on(ModalEvents.cancel,(function(){location.reload()})),root.on(ModalEvents.shown,(function(){root.find('*[data-action="cancel"]').text(strings[2]),root.find('*[data-action="cancel"]').prop("disabled",!0),Ajax.call([{methodname:"community_sharequestion_save_questions_to_quiz",args:{cmid:cmid,qids:JSON.stringify(selected)},done:function(response){JSON.parse(response);root.find('*[data-action="cancel"]').text(strings[3]),root.find('*[data-action="cancel"]').prop("disabled",!1)},fail:Notification.exception}])})),fmodal})).fail(Notification.exception)}))):Str.get_strings([{key:"popupmessagefailtitle",component:"community_oer"},{key:"popupmessagefailcontent",component:"community_oer"}]).done((function(strings){var modalPromise=ModalFactory.create({type:ModalFactory.types.ALERT,title:strings[0],body:strings[1]});$.when(modalPromise).then((function(fmodal){return fmodal.show(),fmodal})).fail(Notification.exception)}))})),fmodal.getModal().addClass("modal-xlg"),fmodal.getModal().addClass("popup-copy-questions-modal import-questions-modal");var root=fmodal.getRoot();return root.on(ModalEvents.shown,(function(){})),root.on(ModalEvents.hidden,(function(){fmodal.destroy()})),fmodal})).done((function(modal){modal.show()})).fail(Notification.exception)}))}))}}}));

//# sourceMappingURL=popup-copy-questions.min.js.map