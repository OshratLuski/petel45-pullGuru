define("community_social/modal",["jquery","core/str","core/templates","core/modal_factory","core/modal_events","community_social/ajax","community_social/loadingSpinner","community_social/render","community_social/lazyLoad","core/notification"],(function($,Str,Templates,ModalFactory,ModalEvents,ajax,loading,render,lazyLoad,Notification){const initHandler=()=>{$("#search_teachers").focus();var tmpstr=$("#search_teachers").val();$("#search_teachers").val(""),$("#search_teachers").val(tmpstr),$(".tc-coursewrap").each((function(){$(this).children().length>2&&$(this).find(".tc-circlebtn").css({opacity:1})})),$(".course__teachers").each((function(){$(this).prop("scrollHeight")>$(this).prop("offsetHeight")?$(this).find(".tc-circlebtn").css({opacity:1,"pointer-events":"auto"}):$(this).find(".tc-circlebtn").css({opacity:0,"pointer-events":"none"})})),lazyLoad.load()},getSearch=()=>{let arrsearch=[];return $(".checked-option-pill").each((function(index){arrsearch.push($(this).data("id"))})),JSON.stringify(arrsearch)};return{initHandler:function(){return initHandler()},school_settings:function(userid){loading.show(),ajax.data={metod:"community_social_school_settings",userid:userid},ajax.run((function(response){let data=JSON.parse(response.data);Templates.render("community_social/popup/school-settings",data).done((function(html,js){Str.get_strings([{key:"save",component:"community_social"},{key:"cancel",component:"community_social"}]).done((function(strings){ModalFactory.create({type:ModalFactory.types.SAVE_CANCEL,title:response.header,body:html}).done((function(modal){loading.remove(),modal.setSaveButtonText(strings[0]),modal.setButtonText("cancel",strings[1]),modal.getRoot().on(ModalEvents.save,(function(e){e.preventDefault();let value=modal.getRoot().find("#schoolname").val();ajax.data={metod:"community_social_school_save",userid:userid,value:value},ajax.run((function(){render.userData(userid),modal.destroy()}))})),modal.getRoot().on(ModalEvents.hidden,(function(){modal.destroy()})),modal.show()}))}))}))}))},courses_pombim:function(userid){loading.show(),ajax.data={metod:"community_social_popup_public_course",userid:userid},ajax.run((function(response){let data=JSON.parse(response.data);Templates.render("community_social/popup/courses-pombim",data).done((function(html,js){Str.get_strings([{key:"approval",component:"community_social"},{key:"cancel",component:"community_social"}]).done((function(strings){ModalFactory.create({type:ModalFactory.types.SAVE_CANCEL,title:response.header,body:html}).done((function(modal){loading.remove(),modal.setSaveButtonText(strings[0]),modal.setButtonText("cancel",strings[1]),modal.getRoot().on(ModalEvents.save,(function(e){e.preventDefault();let ids=[],ifcopy=!1,form=modal.getRoot().find("#popup_courses_pombip");$(form).find("input:checked").each(((count,obj)=>{"ifcopy"!==$(obj).attr("name")&&ids.push($(obj).val()),"ifcopy"===$(obj).attr("name")&&(ifcopy=!0)}));let search=getSearch();ajax.data={metod:"community_social_save_selected_pombim_courses",userid:userid,ids:JSON.stringify(ids),ifcopy:ifcopy},ajax.run((function(){render.asideCoursesPombim(userid),render.coursesBlock(userid,search,initHandler,(function(){})),render.userData(userid),modal.destroy()}))})),modal.getRoot().on(ModalEvents.hidden,(function(){modal.destroy()})),modal.show()}))}))}))}))},migrate_courses_pombim:function(userid){loading.show(),ajax.data={metod:"community_social_popup_migrate_public_course",userid:userid},ajax.run((function(response){let data=JSON.parse(response.data);Templates.render("community_social/popup/migrate-courses-pombim",data).done((function(html,js){Str.get_strings([{key:"approval",component:"community_social"},{key:"cancel",component:"community_social"}]).done((function(strings){ModalFactory.create({type:ModalFactory.types.SAVE_CANCEL,title:response.header,body:html}).done((function(modal){loading.remove(),modal.setSaveButtonText(strings[0]),modal.setButtonText("cancel",strings[1]),modal.getRoot().on(ModalEvents.save,(function(e){e.preventDefault();let form=modal.getRoot().find("#popup_migrate_courses_pombim"),oldcourseid=$(form).find("#oldcourseid").val(),newcourseid=$(form).find("#newcourseid").val(),ifcopy=!1;$(form).find("#ifcopy").is(":checked")&&(ifcopy=!0);let search=getSearch();ajax.data={metod:"community_social_migrate_public_course",userid:userid,oldcourseid:oldcourseid,newcourseid:newcourseid,ifcopy:ifcopy},ajax.run((function(){render.asideCoursesPombim(userid),render.coursesBlock(userid,search,initHandler),render.userData(userid),modal.destroy()}))})),modal.getRoot().on(ModalEvents.hidden,(function(){modal.destroy()})),modal.show()}))}))}))}))},social_disable:function(){loading.show(),ajax.data={metod:"community_social_social_disable"},ajax.run((function(response){let data=JSON.parse(response.data);Templates.render("community_social/popup/social-disable",data).done((function(html,js){Str.get_strings([{key:"disable",component:"community_social"},{key:"cancel",component:"community_social"}]).done((function(strings){ModalFactory.create({type:ModalFactory.types.SAVE_CANCEL,title:response.header,body:html}).done((function(modal){loading.remove(),modal.setSaveButtonText(strings[0]),modal.setButtonText("cancel",strings[1]),modal.getRoot().on(ModalEvents.save,(function(e){e.preventDefault(),window.location.href=modal.getRoot().find("#social_disable").val(),modal.destroy()})),modal.getRoot().on(ModalEvents.hidden,(function(){modal.destroy()})),modal.show()}))}))}))}))},user_collegues_list:function(page_userid,current_userid){loading.show(),ajax.data={metod:"community_social_user_collegues_list",page_userid:page_userid,current_userid:current_userid},ajax.run((function(response){let data=JSON.parse(response.data);Templates.render("community_social/popup/request-collegues-list",data).done((function(html,js){Str.get_strings([{key:"close",component:"community_social"}]).done((function(strings){ModalFactory.create({type:ModalFactory.types.CANCEL,title:response.header,body:html}).done((function(modal){loading.remove(),modal.setButtonText("cancel",strings[0]),modal.getRoot().on(ModalEvents.hidden,(function(){modal.destroy()})),modal.show()}))}))}))}))},user_follower_list:function(page_userid,current_userid){loading.show(),ajax.data={metod:"community_social_user_follower_list",page_userid:page_userid,current_userid:current_userid},ajax.run((function(response){let data=JSON.parse(response.data);Templates.render("community_social/popup/request-follower-list",data).done((function(html,js){Str.get_strings([{key:"close",component:"community_social"}]).done((function(strings){ModalFactory.create({type:ModalFactory.types.CANCEL,title:response.header,body:html}).done((function(modal){loading.remove(),modal.setButtonText("cancel",strings[0]),modal.getRoot().on(ModalEvents.hidden,(function(){modal.destroy()})),modal.show()}))}))}))}))},request_followed_courses:function(page_userid,current_userid){loading.show(),ajax.data={metod:"community_social_request_followed_courses",page_userid:page_userid,current_userid:current_userid},ajax.run((function(response){let data=JSON.parse(response.data);Templates.render("community_social/popup/request-followed-courses",data).done((function(html,js){Str.get_strings([{key:"save",component:"community_social"},{key:"cancel",component:"community_social"}]).done((function(strings){ModalFactory.create({type:ModalFactory.types.SAVE_CANCEL,title:response.header,body:html}).done((function(modal){loading.remove(),modal.setSaveButtonText(strings[0]),modal.setButtonText("cancel",strings[1]),modal.getRoot().on(ModalEvents.save,(function(e){e.preventDefault();let ids=[],form=modal.getRoot().find("#request_followed_courses");$(form).find("input:checked").each(((count,obj)=>{ids.push($(obj).val())})),ajax.data={metod:"community_social_send_followed_courses",page_userid:page_userid,current_userid:current_userid,ids:JSON.stringify(ids)},ajax.run((function(){render.userData(page_userid),modal.destroy()}))})),modal.getRoot().on(ModalEvents.hidden,(function(){modal.destroy()})),modal.show()}))}))}))}))},remove_teacher_request:function(userid,courseid){loading.show(),ajax.data={metod:"community_social_remove_teacher_request",courseid:courseid,userid:userid},ajax.run((function(response){let data=JSON.parse(response.data);Templates.render("community_social/popup/request-remove-teacher",data).done((function(html,js){Str.get_strings([{key:"removeaccess",component:"community_social"},{key:"cancel",component:"community_social"}]).done((function(strings){ModalFactory.create({type:ModalFactory.types.SAVE_CANCEL,title:response.header,body:html}).done((function(modal){loading.remove(),modal.setSaveButtonText(strings[0]),modal.setButtonText("cancel",strings[1]),modal.getRoot().on(ModalEvents.save,(function(e){e.preventDefault();let search=getSearch();ajax.data={metod:"community_social_remove_teacher_from_course",userid:userid,courseid:courseid},ajax.run((function(){render.coursesBlock(userid,search,initHandler),render.userData(userid),modal.destroy()}))})),modal.getRoot().on(ModalEvents.hidden,(function(){modal.destroy()})),modal.show()}))}))}))}))}}}));

//# sourceMappingURL=modal.min.js.map