define("community_social/init",["jquery","core/str","community_social/ajax","community_social/render","community_social/loadingSpinner","community_social/inview","community_social/modal","community_social/lazyLoad"],(function($,str,ajax,render,loading,inView,SocialModal,lazyLoad){str.get_strings([{key:"disablingsocialarea",component:"community_social"},{key:"choosingpubliccourses",component:"community_social"},{key:"editingtheschool",component:"community_social"},{key:"close",component:"community_social"},{key:"errormessage",component:"community_social"},{key:"cancel",component:"community_social"},{key:"excludeteacher",component:"community_social"},{key:"warning",component:"community_social"},{key:"removepeerteacher",component:"community_social"},{key:"ok",component:"community_social"}]).done((function(){}));const mainBlock=document.querySelector("#region-main .social"),follow_teacher=(page_userid,current_userid,follow_enable,callback)=>{loading.show(),ajax.data={metod:"community_social_follow_teacher",page_userid:page_userid,current_userid:current_userid,follow_enable:follow_enable},ajax.run((function(){callback()}))},follow_teacher_by_userid=(custom_userid,page_userid,current_userid,callback)=>{ajax.data={metod:"community_social_change_follow_teacher_by_user",page_userid:page_userid,current_userid:current_userid,custom_userid:custom_userid},ajax.run((function(){callback()}))},teacher_tab=(teacher_tab,search)=>{ajax.data={metod:"community_social_render_teacher_block",teacher_tab:teacher_tab,target_block:"#teachers_card_block",search:search},ajax.setHTML(SocialModal.initHandler)},createPill=(query,callback)=>{0!==(query=query.trim()).length&&str.get_strings([{key:"removeallpills",component:"community_oer"}]).done((function(strings){$("#profile_search").val("");let pillTarget=$(".checked-option-pills");if(!pillTarget.find("button").length){let pillremoveall=$('\n                    <button type="button" data-handler="removeallpills" class="removeallpills btn btn-secondary mr-3 py-1 px-3 mb-2">\n                        '.concat(strings[0],"                       \n                    </button>"));pillTarget.append(pillremoveall)}let simpleword=!1;if(query.length>0&&'"'===query[0]&&'"'===query[query.length-1]&&(simpleword=!0,query=query.substring(1,query.length-1)),simpleword){let pill=$('\n                <div class="checked-option-pill rounded-pill bg-light text-primary border border-primary mr-3 py-1 px-3 mb-2" data-id="'.concat(query,'">\n                    <span class="checked-option-pill-name">').concat(query,'</span>\n                    <button type="button" class="close ml-3" aria-label="Close"  data-handler="removepill">\n                        <span aria-hidden="true" data-area="pillsearch" data-value="').concat(query,'">&times;</span>\n                    </button>\n                </div>'));pillTarget.append(pill)}else query.split(" ").forEach((function(value){if(value.length>0){let pill=$('\n                                <div class="checked-option-pill rounded-pill bg-light text-primary border border-primary mr-3 py-1 px-3 mb-2" data-id="'.concat(value,'">\n                                    <span class="checked-option-pill-name">').concat(value,'</span>\n                                    <button type="button" class="close ml-3" aria-label="Close"  data-handler="removepill">\n                                        <span aria-hidden="true" data-area="pillsearch" data-value="').concat(value,'">&times;</span>\n                                    </button>\n                                </div>'));pillTarget.append(pill)}}));callback()}))},removePillSearch=(object,callback)=>{$(object).parent().remove();let buttons=$(".checked-option-pills").find("button");1===buttons.length&&buttons.remove(),callback()},removeAllPillSearch=(object,callback)=>{let elementssearch=$("*").filter((function(){return"pillsearch"===$(this).data("area")}));$(elementssearch).each((function(){removePillSearch($(this).parent(),(function(){}))})),callback()};return{init:function(page_userid,current_userid){mainBlock.addEventListener("click",(function(event){let target=event.target;for(;target!==mainBlock;){if("school-settings"===target.dataset.handler)return void SocialModal.school_settings(page_userid);if("courses_pombim"===target.dataset.handler)return void SocialModal.courses_pombim(page_userid);if("migrate_courses_pombim"===target.dataset.handler)return void SocialModal.migrate_courses_pombim(page_userid);if("social_disable"===target.dataset.handler)return void SocialModal.social_disable();if("user-collegues-list"===target.dataset.handler)return void SocialModal.user_collegues_list(page_userid,current_userid);if("user-follower-list"===target.dataset.handler)return void SocialModal.user_follower_list(page_userid,current_userid);if("request-followed-courses"===target.dataset.handler)return void SocialModal.request_followed_courses(page_userid,current_userid);if("remove-teacher-request"===target.dataset.handler){let courseid=target.dataset.courseid,userid=target.dataset.userid;return void SocialModal.remove_teacher_request(userid,courseid)}if("follow"===target.dataset.handler){let follow_enable=target.dataset.follow_enable;return void follow_teacher(page_userid,current_userid,follow_enable,(function(){render.userData(page_userid)}))}if("follow-user"===target.dataset.handler){let custom_userid=target.dataset.custom_userid;return void follow_teacher_by_userid(custom_userid,page_userid,current_userid,(function(){render.userData(page_userid),SocialModal.user_follower_list(page_userid,current_userid)}))}if("teacher_tab"===target.dataset.handler||"search_teacher"===target.dataset.handler){let tab_id=target.dataset.tab_id,search=$("#search_teachers").val();return void teacher_tab(tab_id,search)}if("search_profile"===target.dataset.handler){let search=$("#profile_search").val();return void createPill(search,(function(){let arrsearch=[];$(".checked-option-pill").each((function(index){arrsearch.push($(this).data("id"))})),render.searchInProfile(page_userid,arrsearch)}))}if("removepill"===target.dataset.handler)return void removePillSearch(target,(function(){let arrsearch=[];$(".checked-option-pill").each((function(index){arrsearch.push($(this).data("id"))})),render.searchInProfile(page_userid,arrsearch)}));if("removeallpills"===target.dataset.handler)return void removeAllPillSearch(0,(function(){render.searchInProfile(page_userid,[])}));if("slideCourseCard"===target.dataset.handler){$(target).toggleClass("tc-rotate");let scrollHeight=$(target).hasClass("tc-rotate")?$(target).parents(".course").prop("scrollHeight"):195;return void $(target).parents(".course").css({height:scrollHeight+"px"})}if("slideTeacherCard"===target.dataset.handler){$(target).toggleClass("tc-rotate");let scrollHeight=$(target).hasClass("tc-rotate")?$(target).parents(".tc").prop("scrollHeight"):140;return void $(target).parents(".tc").css({height:scrollHeight+"px"})}target=target.parentNode}})),window.onresize=function(event){SocialModal.initHandler()},mainBlock.addEventListener("keydown",(function(event){if(13===event.keyCode&&"search_teachers"===event.target.id){let tab_id=event.target.nextElementSibling.dataset.tab_id,search=event.target.value;teacher_tab(tab_id,search)}if(13===event.keyCode&&"profile_search"===event.target.id){let search=event.target.value;createPill(search,(function(){let arrsearch=[];$(".checked-option-pill").each((function(index){arrsearch.push($(this).data("id"))})),render.searchInProfile(page_userid,arrsearch)}))}}))}}}));

//# sourceMappingURL=init.min.js.map