/**
 * Javascript main event handler.
 *
 * @module     community_comments/init
 * @package    community_comments
 * @copyright  2019 Devlionco <info@devlion.co>
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 * @since      3.6
 */
define("community_comments/page",["jquery","core/str","core/ajax","core/notification"],(function($,str,Ajax,Notification){return str.get_strings([{key:"opencomment",component:"community_comments"},{key:"closecomment",component:"community_comments"}]).done((function(){})),{init:function(activityid){var pathname=window.location.pathname;-1==pathname.toLowerCase().indexOf("quiz/attempt.php")&&-1==pathname.toLowerCase().indexOf("questionnaire/preview.php")||this.render(activityid,0)},scripts:function(){var self=this;$(".comment__send").bind("click",(function(){var comment=$("#community_textarea_comment").val(),activityid=$("#community_activityid_comment").val(),sort=$("#community_sort_comment").val();self.save_comment(activityid,comment,(function(){self.render(activityid,sort)}))})),$("#community_sort_comment").change((function(){var activityid=$("#community_activityid_comment").val(),sort=$("#community_sort_comment").val();self.render(activityid,sort)})),$(".comment__close").on("click",(function(){$(this).toggleClass("comment__open"),$(this).hasClass("comment__open")?($(this).parent().prev().find(".comment__short").addClass("display__none"),$(this).parent().prev().find(".comment__long").removeClass("display__none"),$(this).parent().prev().removeClass("comment__body--short"),$(this).text(M.util.get_string("closecomment","community_comments")),$(this).addClass("comment__icon-open")):($(this).parent().prev().find(".comment__short").removeClass("display__none"),$(this).parent().prev().find(".comment__long").addClass("display__none"),$(this).parent().prev().addClass("comment__body--short"),$(this).text(M.util.get_string("opencomment","community_comments")),$(this).removeClass("comment__icon-open"))}))},render:function(activityid,sort){var self=this,data={activityid:Number(activityid),sort:Number(sort)};Ajax.call([{methodname:"community_comments_render_block",args:data,done:function(response){$("#insert_community_comments").length&&$("#insert_community_comments").remove(),$.when($(".activity-navigation").first().before(response.content)).then((function(){self.scripts()}))},fail:Notification.exception}])},save_comment:function(activityid,comment,callback){var data={activityid:Number(activityid),comment:comment};Ajax.call([{methodname:"community_comments_save_comment",args:data,done:function(){callback()},fail:Notification.exception}])}}}));

//# sourceMappingURL=page.min.js.map