{"version":3,"file":"preset.min.js","sources":["../src/preset.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Javascript main event handler.\n *\n * @module     local_quizpreset/preset\n * @package\n * @copyright  2019 Devlionco <info@devlion.co>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n * @since      3.6\n */\n\ndefine([\n  'jquery',\n  'core/templates',\n  'core/ajax',\n  'core/str',\n  'core/notification',\n  'core/modal_factory',\n  'core/modal_events',\n  'core/fragment',\n  'local_quizpreset/userexposure',\n  'local_quizpreset/loading'\n], function($, Templates, Ajax, Str, Notification, ModalFactory, ModalEvents, Fragment, Userexposure, loadingIcon) {\n\n    var cmid = '';\n    var pageState = '';\n\n    var Selector = {\n        TOP_PAGE_ELEMENT: 'body',\n        MODULE_NAME: '#region-main .mform input[name=\"modulename\"]',\n        ADD_INPUT: '#region-main .mform input[name=\"add\"]',\n        UPDATE_INPUT: '#region-main .mform input[name=\"update\"]',\n        TYPE_SELECTOR_ANCOR1: '#region-main .mform .collapsible-actions',\n        TYPE_SELECTOR_ANCOR2: '#region-main .quizinfo',\n        FORM: '#region-main .mform',\n        SECTIONS_ALL: '#region-main .mform fieldset',\n        SECTIONS_HIDDEN: '#region-main .mform fieldset.hidden',\n        SECTIONS_VISIBLE: '#region-main .mform fieldset:not(.hidden)',\n        SECTIONS_COLLAPSED: '#region-main .mform fieldset.collapsed',\n        SECTIONS_EXPANDED: '#region-main .mform fieldset:not(.collapsed)',\n        SECTIONS_DEFAULT_VISIBLE: '#region-main .mform fieldset.default-visible',\n        SECTIONS_DEFAULT_HIDDEN: '#region-main .mform fieldset.default-hidden',\n        SECTIONS_DEFAULT_NOT_HIDDEN: '#region-main .mform fieldset:not(.default-hidden)',\n        BUTTON_EXPAND: '.collapsible-actions',\n        BUTTON_SHOW_MORE: '#region-main .mform .moreless-toggler:not(.moreless-less)',\n        BUTTON_VIEWALL: '.quiz-view-all',\n        BUTTON_VIEWALL_ANCOR: '#fgroup_id_buttonar',\n        BUTTON_SUBMIT: '#fgroup_id_buttonar #id_submitbutton',\n        BUTTON_SUBMIT2: '#fgroup_id_buttonar #id_submitbutton2',\n        BUTTON_NEWSUBMIT: '#fgroup_id_buttonar #new_id_submitbutton',\n        BUTTON_NEWSUBMIT2: '#fgroup_id_buttonar #new_id_submitbutton2',\n        QUIZ_TYPE_SELECTOR: '.quiz-type-selector',\n        QUIZ_TYPE_SELECTOR_N: '#quiz-type-selector-',\n        QUIZ_TYPE_DESCRIPTION: '.selector-type-description',\n        QUIZ_INFO: '.quizstartbuttondiv',\n        QUIZ_CMID: 'input[name=\"cmid\"]',\n        QUIZ_CMID2: '#local-quizpreset-cmid',\n        QUIZ_CMID3: 'input[name=\"coursemodule\"]',\n        QUIZ_CUSTOM_CMID: '#id_cmidnumber',\n        DATA_QUIZTYPE: 'quiztype',\n        INVALID: '#region-main .mform .is-invalid',\n        DATA_URL: 'url',\n    };\n    var Class = {\n        QUIZ: 'path-mod-quiz',\n        VISIBLE: '',\n        HIDDEN: 'hidden',\n        COLLAPSED: 'collapsed',\n        DEFAULT_VISIBLE: 'default-visible',\n        DEFAULT_HIDDEN: 'default-hidden',\n        NEW_PREFIX: 'new_',\n    };\n\n    // Get cmid.\n    if ($(Selector.QUIZ_CMID).length) {\n        cmid = $(Selector.QUIZ_CMID).val();\n    } else if ($(Selector.QUIZ_CMID2).length) {\n        cmid = $(Selector.QUIZ_CMID2).val();\n    } else if ($(Selector.QUIZ_CMID3).length) {\n        cmid = $(Selector.QUIZ_CMID3).val();\n    }\n\n    var preconfigurePage = function(response) {\n\n        // Hide Expand all.\n        $(Selector.BUTTON_EXPAND).hide();\n        $('.quiz-bottom-bar').remove();\n\n        Templates.render(\"local_quizpreset/view_all_button\", response)\n            .done(function(html) {\n                $(Selector.BUTTON_VIEWALL_ANCOR).before(html);\n            });\n\n        // Hide save buttons and add event for custom save buttons.\n        var newSubmit = $(Selector.BUTTON_SUBMIT).clone().insertAfter(Selector.BUTTON_SUBMIT);\n        newSubmit.attr('id', Class.NEW_PREFIX + newSubmit.attr('id'));\n        newSubmit.attr('name', Class.NEW_PREFIX + newSubmit.attr('name'));\n        newSubmit.attr('type', 'button');\n        $(Selector.BUTTON_SUBMIT).hide();\n\n        var saveData = function(callback) {\n            var defaulttype_for_save = $(\"#defaulttype_for_save\").val();\n            var viewall_for_save = $(\"#viewall_for_save\").val();\n\n            Ajax.call([{\n                methodname: 'local_quizpreset_savedata',\n                args: {\n                    'cmid': Number(cmid),\n                    'pagestate': pageState,\n                    'type': Number(defaulttype_for_save),\n                    'viewall': Number(viewall_for_save),\n                },\n                done: function() {\n                    if (callback) {\n                        callback();\n                    }\n                },\n                fail: Notification.exception\n            }]);\n        };\n\n        var submitQuiz1 = function() {\n            $(Selector.BUTTON_SUBMIT).click();\n        };\n\n        var submitQuiz2 = function() {\n            $(Selector.BUTTON_SUBMIT2).click();\n        };\n\n        var newSubmit2 = $(Selector.BUTTON_SUBMIT2).clone().insertAfter(Selector.BUTTON_SUBMIT2);\n        newSubmit2.attr('id', Class.NEW_PREFIX + newSubmit2.attr('id'));\n        newSubmit2.attr('name', Class.NEW_PREFIX + newSubmit2.attr('name'));\n        newSubmit2.attr('type', 'button');\n        $(Selector.BUTTON_SUBMIT2).hide();\n\n        $(document).on('click', Selector.BUTTON_NEWSUBMIT, function() {\n            saveData(submitQuiz1);\n        });\n\n        $(document).on('click', Selector.BUTTON_NEWSUBMIT2, function() {\n            saveData(submitQuiz2);\n        });\n\n    };\n\n    var expandedFieldset = function(response) {\n\n        if (response.details.pagestate === 'view') {\n return;\n}\n\n        $.each(response.expanded, function(key, value) {\n            if (!value) {\n                $('#' + key).hide();\n            }\n        });\n\n        if (response.details.instancename === 'chemistry') {\n            $('#id_teacherremarks').parents('.form-group').hide();\n        }\n\n        if (!response.details.viewdescription) {\n            $('#id_introeditor').parents('.form-group').hide();\n            $('#id_showdescription').parents('.form-group').hide();\n        }\n    };\n\n    var fillByType = function(name, val) {\n        var type = $(\"#id_\" + name).prop('type');\n\n        if (type === 'text' || type === 'select-one') {\n            $(\"#id_\" + name).val(val);\n        }\n\n        if (type === 'checkbox') {\n            if (val === 1 || val === true) {\n                $(\"#id_\" + name).prop('checked', true);\n            } else {\n                $(\"#id_\" + name).prop('checked', false);\n            }\n        }\n\n        return;\n    };\n\n    var fillValues = function(response) {\n\n        // Fixed problem with disabled checkboxes.\n        $(\"form\").submit(function(e) {\n\n            // Block duringoptions.\n            $(\"div\").find(\"[data-groupname='duringoptionsgrp']\").find('input').each(function(index) {\n                if ($(this).is(':disabled') && $(this).is(':checked')) {\n                    $(this).prop('disabled', false);\n                }\n            });\n\n            // Block immediatelyoptions.\n            $(\"div\").find(\"[data-groupname='immediatelyoptionsgrp']\").find('input').each(function(index) {\n                if ($(this).is(':disabled') && $(this).is(':checked')) {\n                    $(this).prop('disabled', false);\n                }\n            });\n\n            // Block openoptions.\n            $(\"div\").find(\"[data-groupname='openoptionsgrp']\").find('input').each(function(index) {\n                if ($(this).is(':disabled') && $(this).is(':checked')) {\n                    $(this).prop('disabled', false);\n                }\n            });\n\n            // Block closedoptions.\n            $(\"div\").find(\"[data-groupname='closedoptionsgrp']\").find('input').each(function(index) {\n                if ($(this).is(':disabled') && $(this).is(':checked')) {\n                    $(this).prop('disabled', false);\n                }\n            });\n\n        });\n\n        if (response.details.pagestate === 'view') {\n return;\n}\n        if (response.details.ifchangestate !== true && response.details.pagestate !== 'new') {\n return;\n}\n\n        $.each(response.values, function(key, value) {\n\n            if (key !== 'area_checkboxes') {\n                fillByType(key, value);\n            } else {\n                $.each(response.values.area_checkboxes, function(key2, value2) {\n                    fillByType(key2, value2);\n                });\n            }\n        });\n    };\n\n    var fillGlobal = function(response) {\n\n        if (response.details.pagestate === 'view' || response.details.pagestate === 'update') {\n return;\n}\n        // If(response.details.ifchangestate != 1 && response.details.pagestate != 'new'){ return;}\n\n        fillByType('name', response.global.name);\n\n        // Fill texteares id_teacherremarks.\n        $('#id_teacherremarkseditable').html(response.global.intro);\n    };\n\n    var addTypeSelector = function() {\n\n        loadingIcon.show();\n\n        // Get url params.\n        var urlparams = {};\n        window.location.search\n            .replace(/[?&]+([^=&]+)=([^&]*)/gi, function(str, key, value) {\n                urlparams[key] = value;\n                }\n            );\n\n        var url = new URL(window.location.href);\n        var defaulttype = url.searchParams.get(\"defaulttype\");\n        var viewall = url.searchParams.get(\"viewall\");\n\n        // If not set viewall in url.\n        if (viewall === null) {\n            viewall = 100;\n        }\n\n        Ajax.call([{\n            methodname: 'local_quizpreset_get_pagedata',\n            args: {\n                'cmid': Number(cmid),\n                'defaulttype': Number(defaulttype),\n                'viewall': Number(viewall),\n                'pagestate': pageState,\n                'urlparams': JSON.stringify(urlparams),\n            },\n            done: function(res) {\n\n                var response = JSON.parse(res);\n\n                if (response.selector.items.length > 0) {\n                    response.selector.items_enable = true;\n                }\n\n                Templates.render(\"local_quizpreset/selector\", response)\n                .done(function(html, js) {\n\n                    // Insert to page.\n                    let block = `<div id=\"block-quizpreset-selector\"></div>`;\n                    if ($(Selector.TYPE_SELECTOR_ANCOR1).length) {\n                        $(Selector.TYPE_SELECTOR_ANCOR1).before(block);\n                    } else if ($(Selector.TYPE_SELECTOR_ANCOR2).length) {\n                        $(Selector.TYPE_SELECTOR_ANCOR2).before(block);\n                    }\n\n                    Templates.replaceNodeContents('#block-quizpreset-selector', html, js);\n\n                    // Fill global.\n                    fillGlobal(response);\n\n                    // Fill values.\n                    fillValues(response);\n\n                    // Add button and change submit buttons.\n                    preconfigurePage(response);\n\n                    // Expanded fieldsets.\n                    expandedFieldset(response);\n\n                    // Run button userexposure.\n                    Userexposure.init();\n\n                    // Collapse fieldset.\n                    if (response.details.viewall === 1) {\n                        $('.collapsible-actions').show();\n                    }\n\n                    // Tooltip.\n                    $(function() {\n                        $('[data-toggle=\"tooltip\"]').tooltip({\n                            delay: {show: 700, hide: 500}\n                        });\n                    });\n\n                    loadingIcon.remove();\n                });\n            },\n            fail: Notification.exception\n        }]);\n\n    };\n\n    var addTypeSelectorViewQuizPage = function() {\n\n        loadingIcon.show();\n\n        // Get url params.\n        var urlparams = {};\n        window.location.search\n            .replace(/[?&]+([^=&]+)=([^&]*)/gi, function(str, key, value) {\n                    urlparams[key] = value;\n                }\n            );\n\n        var url = new URL(window.location.href);\n        var defaulttype = url.searchParams.get(\"defaulttype\");\n        var viewall = url.searchParams.get(\"viewall\");\n\n        // If not set viewall in url.\n        if (viewall === null) {\n            viewall = 100;\n        }\n\n        Ajax.call([{\n            methodname: 'local_quizpreset_get_pagedata',\n            args: {\n                'cmid': Number(cmid),\n                'defaulttype': Number(defaulttype),\n                'viewall': Number(viewall),\n                'pagestate': pageState,\n                'urlparams': JSON.stringify(urlparams),\n            },\n            done: function(res) {\n\n                var response = JSON.parse(res);\n\n                // Remove selector.items.\n                if (response.selector.items.length > 0) {\n                    response.selector.items_enable = false;\n                }\n\n                Templates.render(\"local_quizpreset/selector\", response)\n                    .done(function(html, js) {\n\n                        // Insert to page.\n                        let block = `<div id=\"block-quizpreset-selector\"></div>`;\n                        if ($(Selector.TYPE_SELECTOR_ANCOR1).length) {\n                            $(Selector.TYPE_SELECTOR_ANCOR1).before(block);\n                        } else if ($(Selector.TYPE_SELECTOR_ANCOR2).length) {\n                            $(Selector.TYPE_SELECTOR_ANCOR2).before(block);\n                        }\n\n                        Templates.replaceNodeContents('#block-quizpreset-selector', html, js);\n\n                        // Fill global.\n                        fillGlobal(response);\n\n                        // Fill values.\n                        fillValues(response);\n\n                        // Add button and change submit buttons.\n                        preconfigurePage(response);\n\n                        // Expanded fieldsets.\n                        expandedFieldset(response);\n\n                        // Run button userexposure.\n                        Userexposure.init();\n\n                        // Collapse fieldset.\n                        if (response.details.viewall === 1) {\n                            $('.collapsible-actions').show();\n                        }\n\n                        // Tooltip.\n                        $(function() {\n                            $('[data-toggle=\"tooltip\"]').tooltip({\n                                delay: {show: 700, hide: 500}\n                            });\n                        });\n\n                        loadingIcon.remove();\n                    });\n            },\n            fail: Notification.exception\n        }]);\n\n    };\n\n    var getDataPreset = function() {\n        let preset = [\n            'timeopen',\n            'timelimit',\n            'overduehandling',\n            'graceperiod',\n            'gradecat',\n            'gradepass',\n            'attempts',\n            'grademethod',\n            'questionsperpage',\n            'navmethod',\n            'shuffleanswers',\n            'preferredbehaviour',\n            'canredoquestions',\n            'attemptonlast',\n            'showuserpicture',\n            'decimalpoints',\n            'questiondecimalpoints',\n            'showblocks',\n            'quizpassword',\n            'subnet',\n            'delay1',\n            'delay2',\n            'browsersecurity',\n            'allowofflineattempts',\n            'boundary_repeats',\n            'visibleoncoursepage',\n            'cmidnumber',\n            'groupmode',\n            'groupingid',\n            'availabilityconditionsjson',\n            'completionusegrade',\n            'completionexpected'\n        ];\n\n        let checkboxes = [\n            'attemptduring',\n            'correctnessduring',\n            'marksduring',\n            'specificfeedbackduring',\n            'generalfeedbackduring',\n            'rightanswerduring',\n            'overallfeedbackduring',\n            'attemptimmediately',\n            'correctnessimmediately',\n            'marksimmediately',\n            'specificfeedbackimmediately',\n            'generalfeedbackimmediately',\n            'rightanswerimmediately',\n            'overallfeedbackimmediately',\n            'attemptopen',\n            'correctnessopen',\n            'marksopen',\n            'specificfeedbackopen',\n            'generalfeedbackopen',\n            'rightansweropen',\n            'overallfeedbackopen',\n            'attemptclosed',\n            'correctnessclosed',\n            'marksclosed',\n            'specificfeedbackclosed',\n            'generalfeedbackclosed',\n            'rightanswerclosed',\n            'overallfeedbackclosed'\n        ];\n\n        let data = [];\n\n        // Build parameters.\n        for (const x in preset) {\n            let name = preset[x];\n            let value;\n            let obj = $('#id_' + name);\n\n            if (obj.attr('type') === 'checkbox') {\n                value = obj.is(':checked') ? 1 : '';\n            } else {\n                value = obj.val();\n            }\n\n            if (value === undefined) {\n                value = 0;\n            }\n            data[name] = value;\n        }\n\n        // Build checkboxes.\n        let data_checkboxes = [];\n        for (const x in checkboxes) {\n            let name = checkboxes[x];\n            let value;\n            let obj = $('#id_' + name);\n\n            if (obj.attr('type') === 'checkbox') {\n                value = obj.is(':checked') ? 1 : '';\n            } else {\n                value = obj.val();\n            }\n\n            if (value === undefined) {\n                value = 0;\n            }\n            data_checkboxes[name] = value;\n        }\n\n        data.area_checkboxes = Object.assign({}, data_checkboxes);\n\n        return Object.assign({}, data);\n    };\n\n    var addEventSavePreset = function() {\n\n        setTimeout(function() {\n            $('#save-my-preset').click(function() {\n\n                const getBody = function(presetid, cmcontextid) {\n\n                    let params = {presetid: presetid};\n                    return Fragment.loadFragment('local_quizpreset', 'popup_preset', cmcontextid, params);\n                };\n\n                let data = getDataPreset();\n                let presetid = $('#presetId').val();\n                let cmcontextid = $('#cmcontextid').val();\n\n                Str.get_strings([\n                    {key: 'titlepopuppreset', component: 'local_quizpreset'},\n                    {key: 'save', component: 'local_quizpreset'},\n                ]).done(function(strings) {\n                    var modalPromise = ModalFactory.create({\n                        type: ModalFactory.types.SAVE_CANCEL,\n                        title: strings[0],\n                        body: getBody(presetid, cmcontextid)\n                    });\n\n                    $.when(modalPromise).then(function(fmodal) {\n\n                        fmodal.setSaveButtonText(strings[1]);\n\n                        // Handle save event.\n                        fmodal.getRoot().on(ModalEvents.save, function(e) {\n\n                            let presetname = fmodal.getRoot().find('#popup_preset_name').val();\n                            let teacherdescription = fmodal.getRoot().find('#popup_teacher_description').val();\n                            let studentdescription = fmodal.getRoot().find('#popup_student_description').val();\n\n                            Ajax.call([{\n                                methodname: 'local_quizpreset_savepreset',\n                                args: {\n                                    'presetid': Number(presetid),\n                                    'presetname': presetname,\n                                    'teacherdescription': teacherdescription,\n                                    'studentdescription': studentdescription,\n                                    'data': JSON.stringify(data),\n                                },\n                                done: function(res) {\n                                    // Close popup.\n                                    fmodal.destroy();\n\n                                    $('.quizpreset-selector-block').remove();\n                                    addTypeSelector();\n                                },\n                                fail: Notification.exception\n                            }]);\n                        });\n\n                        return fmodal;\n                    }).done(function(modal) {\n                        modal.show();\n                    }).fail(Notification.exception);\n                });\n            });\n        }, 1000);\n    };\n\n    // Add Buttons Bar to view page.\n    var addButtonsBar = function(callback) {\n        Ajax.call([{\n            methodname: 'local_quizpreset_get_buttonsbar',\n            args: {\n                'cmid': Number(cmid)\n            },\n            done: function(res) {\n                var response = JSON.parse(res);\n                Templates.render(\"local_quizpreset/buttons_bar\", response)\n                .done(function(html) {\n                    $(Selector.QUIZ_INFO).after(html);\n                    callback();\n                });\n            },\n            fail: Notification.exception\n        }]);\n    };\n\n    return {\n\n        configureAddQuizPage: function() {\n            pageState = \"new\";\n            addTypeSelector();\n        },\n\n        configureUpdateQuizPage: function() {\n            pageState = \"update\";\n            addTypeSelector();\n        },\n\n        configureViewQuizPage: function() {\n            pageState = \"view\";\n            addTypeSelectorViewQuizPage();\n\n            // AddButtonsBar(function(){\n            //     addTypeSelector();\n            // });\n        },\n\n        configureSaveMyPreset: function() {\n            addEventSavePreset();\n        }\n    };\n});\n"],"names":["define","$","Templates","Ajax","Str","Notification","ModalFactory","ModalEvents","Fragment","Userexposure","loadingIcon","cmid","pageState","Selector","Class","length","val","preconfigurePage","response","hide","remove","render","done","html","before","newSubmit","clone","insertAfter","attr","saveData","callback","defaulttype_for_save","viewall_for_save","call","methodname","args","Number","fail","exception","submitQuiz1","click","submitQuiz2","newSubmit2","document","on","expandedFieldset","details","pagestate","each","expanded","key","value","instancename","parents","viewdescription","fillByType","name","type","prop","fillValues","submit","e","find","index","this","is","ifchangestate","values","area_checkboxes","key2","value2","fillGlobal","global","intro","addTypeSelector","show","urlparams","window","location","search","replace","str","url","URL","href","defaulttype","searchParams","get","viewall","JSON","stringify","res","parse","selector","items","items_enable","js","block","replaceNodeContents","init","tooltip","delay","addEventSavePreset","setTimeout","getBody","presetid","cmcontextid","params","loadFragment","data","preset","checkboxes","x","obj","undefined","data_checkboxes","Object","assign","getDataPreset","get_strings","component","strings","modalPromise","create","types","SAVE_CANCEL","title","body","when","then","fmodal","setSaveButtonText","getRoot","save","presetname","teacherdescription","studentdescription","destroy","modal","configureAddQuizPage","configureUpdateQuizPage","configureViewQuizPage","addTypeSelectorViewQuizPage","configureSaveMyPreset"],"mappings":"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"}