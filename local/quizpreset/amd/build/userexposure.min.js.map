{"version":3,"file":"userexposure.min.js","sources":["../src/userexposure.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Javascript to initialise the myoverview block.\n *\n * @package\n * @copyright  2018 Bas Brands <bas@moodle.com>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine([\n  'jquery',\n  'core/ajax',\n  'core/notification',\n  'core/str'\n],\nfunction($, Ajax, Notification, Str) {\n\n    return {\n        selector: {\n            button: '#quiz-grade-button',\n            hidden: '#quiz-grade',\n        },\n\n        /**\n         * Initialise all of the modules for the overview block.\n         *\n         * @param {object} courseids The root element for the overview block.\n         */\n        init: function() {\n\n            var root = $(this.selector.button),\n                self = this;\n\n            root.on('click', function(e) {\n                self.changeGrades();\n            });\n        },\n\n        changeGrades: function() {\n\n            var self = this;\n            Str.get_strings([\n                {key: 'buttondisablegrades', component: 'local_quizpreset'},\n                {key: 'buttonenablegrades', component: 'local_quizpreset'}\n            ]).done(function(strings) {\n\n                var grade = $(self.selector.hidden).val();\n                if (grade == 0) {\n                    $(self.selector.hidden).val(1);\n                    $(self.selector.button).html(strings[0]);\n                    $(self.selector.button).removeClass(\"btn-primary\").addClass(\"btn-secondary\");\n\n                    $(\"#id_marksduring\").prop(\"checked\", true);\n                    $(\"#id_marksimmediately\").prop(\"checked\", true);\n                    $(\"#id_marksopen\").prop(\"checked\", true);\n                    $(\"#id_marksclosed\").prop(\"checked\", true);\n\n                    $(\"#id_timeclose_day\").prop(\"disabled\", false);\n                    $(\"#id_timeclose_month\").prop(\"disabled\", false);\n                    $(\"#id_timeclose_year\").prop(\"disabled\", false);\n                    $(\"#id_timeclose_hour\").prop(\"disabled\", false);\n                    $(\"#id_timeclose_minute\").prop(\"disabled\", false);\n\n                    if (!$(\"#id_timeclose_enabled\").is(\":checked\")) {\n                        $(\"#id_timeclose_enabled\").click();\n                    }\n\n                    self.setDateTime(\"timeclose\");\n                }\n\n                if (grade == 1) {\n                    $(self.selector.hidden).val(0);\n                    $(self.selector.button).html(strings[1]);\n                    $(self.selector.button).removeClass(\"btn-secondary\").addClass(\"btn-primary\");\n\n                    $(\"#id_marksduring\").prop(\"checked\", false);\n                    $(\"#id_marksimmediately\").prop(\"checked\", false);\n                    $(\"#id_marksopen\").prop(\"checked\", false);\n                    $(\"#id_marksclosed\").prop(\"checked\", false);\n\n                    if ($(\"#id_timeclose_enabled\").is(\":checked\")) {\n                        $(\"#id_timeclose_enabled\").click();\n                    }\n                }\n\n            }).fail(Notification.exception);\n\n        },\n\n        setDateTime: function(name) {\n        var dt = new Date();\n        var month = dt.getMonth() + 1;\n\n            $(\"[name=\\\"\" + name + \"[hour]\\\"] option[value=\" + dt.getHours() + \"]\").prop(\"selected\", \"selected\");\n            $(\"[name=\\\"\" + name + \"[minute]\\\"] option[value=\" + dt.getMinutes() + \"]\").prop(\"selected\", \"selected\");\n            $(\"[name=\\\"\" + name + \"[year]\\\"] option[value=\" + dt.getFullYear() + \"]\").prop(\"selected\", \"selected\");\n            $(\"[name=\\\"\" + name + \"[month]\\\"] option[value=\" + month + \"]\").prop(\"selected\", \"selected\");\n            $(\"[name=\\\"\" + name + \"[day]\\\"] option[value=\" + dt.getDate() + \"]\").prop(\"selected\", \"selected\");\n        }\n\n    };\n});\n"],"names":["define","$","Ajax","Notification","Str","selector","button","hidden","init","root","this","self","on","e","changeGrades","get_strings","key","component","done","strings","grade","val","html","removeClass","addClass","prop","is","click","setDateTime","fail","exception","name","dt","Date","month","getMonth","getHours","getMinutes","getFullYear","getDate"],"mappings":";;;;;;;AAuBAA,uCAAO,CACL,SACA,YACA,oBACA,aAEF,SAASC,EAAGC,KAAMC,aAAcC,WAErB,CACHC,SAAU,CACNC,OAAQ,qBACRC,OAAQ,eAQZC,KAAM,eAEEC,KAAOR,EAAES,KAAKL,SAASC,QACvBK,KAAOD,KAEXD,KAAKG,GAAG,SAAS,SAASC,GACtBF,KAAKG,mBAIbA,aAAc,eAENH,KAAOD,KACXN,IAAIW,YAAY,CACZ,CAACC,IAAK,sBAAuBC,UAAW,oBACxC,CAACD,IAAK,qBAAsBC,UAAW,sBACxCC,MAAK,SAASC,aAETC,MAAQnB,EAAEU,KAAKN,SAASE,QAAQc,MACvB,GAATD,QACAnB,EAAEU,KAAKN,SAASE,QAAQc,IAAI,GAC5BpB,EAAEU,KAAKN,SAASC,QAAQgB,KAAKH,QAAQ,IACrClB,EAAEU,KAAKN,SAASC,QAAQiB,YAAY,eAAeC,SAAS,iBAE5DvB,EAAE,mBAAmBwB,KAAK,WAAW,GACrCxB,EAAE,wBAAwBwB,KAAK,WAAW,GAC1CxB,EAAE,iBAAiBwB,KAAK,WAAW,GACnCxB,EAAE,mBAAmBwB,KAAK,WAAW,GAErCxB,EAAE,qBAAqBwB,KAAK,YAAY,GACxCxB,EAAE,uBAAuBwB,KAAK,YAAY,GAC1CxB,EAAE,sBAAsBwB,KAAK,YAAY,GACzCxB,EAAE,sBAAsBwB,KAAK,YAAY,GACzCxB,EAAE,wBAAwBwB,KAAK,YAAY,GAEtCxB,EAAE,yBAAyByB,GAAG,aAC/BzB,EAAE,yBAAyB0B,QAG/BhB,KAAKiB,YAAY,cAGR,GAATR,QACAnB,EAAEU,KAAKN,SAASE,QAAQc,IAAI,GAC5BpB,EAAEU,KAAKN,SAASC,QAAQgB,KAAKH,QAAQ,IACrClB,EAAEU,KAAKN,SAASC,QAAQiB,YAAY,iBAAiBC,SAAS,eAE9DvB,EAAE,mBAAmBwB,KAAK,WAAW,GACrCxB,EAAE,wBAAwBwB,KAAK,WAAW,GAC1CxB,EAAE,iBAAiBwB,KAAK,WAAW,GACnCxB,EAAE,mBAAmBwB,KAAK,WAAW,GAEjCxB,EAAE,yBAAyByB,GAAG,aAC9BzB,EAAE,yBAAyB0B,YAIpCE,KAAK1B,aAAa2B,YAIzBF,YAAa,SAASG,UAClBC,GAAK,IAAIC,KACTC,MAAQF,GAAGG,WAAa,EAExBlC,EAAE,UAAa8B,KAAO,yBAA4BC,GAAGI,WAAa,KAAKX,KAAK,WAAY,YACxFxB,EAAE,UAAa8B,KAAO,2BAA8BC,GAAGK,aAAe,KAAKZ,KAAK,WAAY,YAC5FxB,EAAE,UAAa8B,KAAO,yBAA4BC,GAAGM,cAAgB,KAAKb,KAAK,WAAY,YAC3FxB,EAAE,UAAa8B,KAAO,0BAA6BG,MAAQ,KAAKT,KAAK,WAAY,YACjFxB,EAAE,UAAa8B,KAAO,wBAA2BC,GAAGO,UAAY,KAAKd,KAAK,WAAY"}